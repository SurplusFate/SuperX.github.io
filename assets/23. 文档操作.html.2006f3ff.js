import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,e}from"./app.e4983f37.js";const i={},t=e(`<h1 id="_23-文档操作" tabindex="-1"><a class="header-anchor" href="#_23-文档操作" aria-hidden="true">#</a> 23. 文档操作</h1><h2 id="_23-1-新增文档" tabindex="-1"><a class="header-anchor" href="#_23-1-新增文档" aria-hidden="true">#</a> 23.1.新增文档</h2><p><strong>语法：</strong></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>POST /索引库名/_doc/文档id
<span class="token punctuation">{</span>
    <span class="token property">&quot;字段1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;值1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;字段2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;值2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;字段3&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;子属性1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;值3&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;子属性2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;值4&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>示例：</strong></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>POST /heima/_doc/<span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;info&quot;</span><span class="token operator">:</span> <span class="token string">&quot;黑马程序员Java讲师&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zy@itcast.cn&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;云&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;赵&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>响应：</strong></p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/image-20210720212933362.png" alt="image-20210720212933362"></p><h2 id="_23-2-查询文档" tabindex="-1"><a class="header-anchor" href="#_23-2-查询文档" aria-hidden="true">#</a> 23.2.查询文档</h2><p>根据 rest 风格，新增是 post，查询应该是 get，不过查询一般都需要条件，这里我们把文档 id 带上。</p><p><strong>语法：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET /<span class="token punctuation">{</span>索引库名称<span class="token punctuation">}</span>/_doc/<span class="token punctuation">{</span>id<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>通过 kibana 查看数据：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET /heima/_doc/1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>查看结果：</strong></p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/image-20210720213345003.png" alt="image-20210720213345003"></p><h2 id="_23-3-删除文档" tabindex="-1"><a class="header-anchor" href="#_23-3-删除文档" aria-hidden="true">#</a> 23.3.删除文档</h2><p>删除使用 DELETE 请求，同样，需要根据 id 进行删除：</p><p><strong>语法：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>DELETE /<span class="token punctuation">{</span>索引库名<span class="token punctuation">}</span>/_doc/id值
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>示例：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 根据id删除数据</span>
DELETE /heima/_doc/1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结果：</strong></p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/image-20210720213634918.png" alt="image-20210720213634918"></p><h2 id="_23-4-修改文档" tabindex="-1"><a class="header-anchor" href="#_23-4-修改文档" aria-hidden="true">#</a> 23.4.修改文档</h2><p>修改有两种方式：</p><ul><li>全量修改：直接覆盖原来的文档</li><li>增量修改：修改文档中的部分字段</li></ul><h3 id="_23-4-1-全量修改" tabindex="-1"><a class="header-anchor" href="#_23-4-1-全量修改" aria-hidden="true">#</a> 23.4.1.全量修改</h3><p>全量修改是覆盖原来的文档，其本质是：</p><ul><li>根据指定的 id 删除文档</li><li>新增一个相同 id 的文档</li></ul><p><strong>注意</strong>：如果根据 id 删除时，id 不存在，第二步的新增也会执行，也就从修改变成了新增操作了。</p><p><strong>语法：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>PUT /<span class="token punctuation">{</span>索引库名<span class="token punctuation">}</span>/_doc/文档id
<span class="token punctuation">{</span>
    <span class="token string">&quot;字段1&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;值1&quot;</span>,
    <span class="token string">&quot;字段2&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;值2&quot;</span>,
    // <span class="token punctuation">..</span>. 略
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>示例：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>PUT /heima/_doc/1
<span class="token punctuation">{</span>
    <span class="token string">&quot;info&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;黑马程序员高级Java讲师&quot;</span>,
    <span class="token string">&quot;email&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zy@itcast.cn&quot;</span>,
    <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;firstName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;云&quot;</span>,
        <span class="token string">&quot;lastName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;赵&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_23-4-2-增量修改" tabindex="-1"><a class="header-anchor" href="#_23-4-2-增量修改" aria-hidden="true">#</a> 23.4.2.增量修改</h3><p>增量修改是只修改指定 id 匹配的文档中的部分字段。</p><p><strong>语法：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>POST /<span class="token punctuation">{</span>索引库名<span class="token punctuation">}</span>/_update/文档id
<span class="token punctuation">{</span>
    <span class="token string">&quot;doc&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
         <span class="token string">&quot;字段名&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;新的值&quot;</span>,
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>示例：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>POST /heima/_update/1
<span class="token punctuation">{</span>
  <span class="token string">&quot;doc&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;email&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ZhaoYun@itcast.cn&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_23-5-总结" tabindex="-1"><a class="header-anchor" href="#_23-5-总结" aria-hidden="true">#</a> 23.5.总结</h2><p>文档操作有哪些？</p><ul><li>创建文档：POST /{索引库名}/_doc/文档 id { json 文档 }</li><li>查询文档：GET /{索引库名}/_doc/文档 id</li><li>删除文档：DELETE /{索引库名}/_doc/文档 id</li><li>修改文档： <ul><li>全量修改：PUT /{索引库名}/_doc/文档 id { json 文档 }</li><li>增量修改：POST /{索引库名}/_update/文档 id { &quot;doc&quot;: {字段}}</li></ul></li></ul>`,44),o=[t];function l(p,c){return s(),a("div",null,o)}const r=n(i,[["render",l],["__file","23. 文档操作.html.vue"]]);export{r as default};
