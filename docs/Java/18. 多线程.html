<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://SurplusFate.github.io/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html"><meta property="og:site_name" content="ç©º~"><meta property="og:title" content="18. å¤šçº¿ç¨‹"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-10-17T03:57:24.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:published_time" content="2022-08-18T00:00:00.000Z"><meta property="article:modified_time" content="2022-10-17T03:57:24.000Z"><link rel="icon" href="/logo.png"><script type="text/javascript" src="/base.js"></script><title>18. å¤šçº¿ç¨‹ | ç©º~</title><meta name="description" content="å­¦ä¹ è®°å½•">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.e3796d55.css">
    <link rel="modulepreload" href="/assets/app.2001591e.js"><link rel="modulepreload" href="/assets/18. å¤šçº¿ç¨‹.html.56eed289.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/18. å¤šçº¿ç¨‹.html.7911edec.js"><link rel="prefetch" href="/assets/index.html.d1d719ad.js"><link rel="prefetch" href="/assets/1. Javaè¯­è¨€æ¦‚è¿°ä¸å¼€å‘ç¯å¢ƒ.html.16a2038d.js"><link rel="prefetch" href="/assets/10. é¢å‘å¯¹è±¡ï¼ˆä¸‹ï¼‰.html.1dfa7329.js"><link rel="prefetch" href="/assets/11. ä¸è¿è¡Œç¯å¢ƒäº¤äº’.html.bc05d690.js"><link rel="prefetch" href="/assets/12. Javaé›†åˆ.html.236c0a6e.js"><link rel="prefetch" href="/assets/13. æ³›å‹.html.d872941c.js"><link rel="prefetch" href="/assets/14. å‡½æ•°å¼ç¼–ç¨‹.html.42278969.js"><link rel="prefetch" href="/assets/15. å¼‚å¸¸å¤„ç†.html.dea146af.js"><link rel="prefetch" href="/assets/16. æ³¨è§£.html.06b16e47.js"><link rel="prefetch" href="/assets/17. IOæµ.html.7c8d4551.js"><link rel="prefetch" href="/assets/19. ç±»åŠ è½½æœºåˆ¶ä¸åå°„.html.b8772d07.js"><link rel="prefetch" href="/assets/2. ç¬¬ä¸€ä¸ªjavaç¨‹åº.html.d6f58fdb.js"><link rel="prefetch" href="/assets/3. Javaç¨‹åºçš„åŸºæœ¬è§„åˆ™.html.3e70b959.js"><link rel="prefetch" href="/assets/4. æ•°æ®ç±»å‹.html.b038438f.js"><link rel="prefetch" href="/assets/5. è¿ç®—ç¬¦.html.689d9fa3.js"><link rel="prefetch" href="/assets/6. æµç¨‹æ§åˆ¶.html.ce807feb.js"><link rel="prefetch" href="/assets/7. é¢å‘å¯¹è±¡ï¼ˆä¸Šï¼‰.html.d5d73ee1.js"><link rel="prefetch" href="/assets/8. æ•°ç»„.html.e3fd13e4.js"><link rel="prefetch" href="/assets/9. æ•°ç»„çš„å¸¸è§ç®—æ³•.html.aeaca4e4.js"><link rel="prefetch" href="/assets/1. VMware.html.275faebe.js"><link rel="prefetch" href="/assets/2. æ–‡ä»¶ç®¡ç†.html.c806c88b.js"><link rel="prefetch" href="/assets/3. ç³»ç»Ÿç®¡ç†.html.c29dade4.js"><link rel="prefetch" href="/assets/4. ç”¨æˆ·å’Œç»„.html.77724975.js"><link rel="prefetch" href="/assets/5. è½¯ä»¶åŒ…ç®¡ç†.html.569b9477.js"><link rel="prefetch" href="/assets/6. JavaEEç¯å¢ƒæ­å»º.html.9770998c.js"><link rel="prefetch" href="/assets/index.html.5f19a7dc.js"><link rel="prefetch" href="/assets/1. åˆ›å»ºä¸ç®¡ç†æ•°æ®åº“.html.cde2f5d0.js"><link rel="prefetch" href="/assets/2. åˆ›å»ºä¸ç®¡ç†æ•°æ®è¡¨.html.245f782d.js"><link rel="prefetch" href="/assets/3. çº¦æŸç®¡ç†.html.66208747.js"><link rel="prefetch" href="/assets/4. æ•°æ®è¡¨çš„åŸºæœ¬æ“ä½œ.html.261846f0.js"><link rel="prefetch" href="/assets/5. è§†å›¾.html.abb7b35f.js"><link rel="prefetch" href="/assets/6. ç´¢å¼•.html.4b3674ec.js"><link rel="prefetch" href="/assets/7. äº‹åŠ¡.html.c44463a2.js"><link rel="prefetch" href="/assets/1. å‡†å¤‡.html.301a4bd8.js"><link rel="prefetch" href="/assets/10. æ³¨è§£.html.2efc626a.js"><link rel="prefetch" href="/assets/11. å¤æ‚æŸ¥è¯¢ç¯å¢ƒæ­å»º.html.03f08f7b.js"><link rel="prefetch" href="/assets/12. åŠ¨æ€ SQL.html.1190f63c.js"><link rel="prefetch" href="/assets/2. ä½¿ç”¨.html.baedad6b.js"><link rel="prefetch" href="/assets/3. ä¸»è¦ç±»ä»‹ç».html.fbfa242d.js"><link rel="prefetch" href="/assets/4. é…ç½®æ–‡ä»¶è¯¦è§£.html.5144c38f.js"><link rel="prefetch" href="/assets/5. CRUD.html.060a1793.js"><link rel="prefetch" href="/assets/6. é…ç½® environments.html.49a2a1b8.js"><link rel="prefetch" href="/assets/7. ResultMap ç»“æœé›†æ˜ å°„.html.b264070b.js"><link rel="prefetch" href="/assets/8. æ—¥å¿—.html.49cce0e2.js"><link rel="prefetch" href="/assets/9. åˆ†é¡µ.html.78475802.js"><link rel="prefetch" href="/assets/index.html.ad22a30f.js"><link rel="prefetch" href="/assets/index.html.ee2368a8.js"><link rel="prefetch" href="/assets/1. Vue æ ¸å¿ƒ.html.ac933159.js"><link rel="prefetch" href="/assets/2. ç»„ä»¶åŒ–ç¼–ç¨‹.html.4b7c9a8e.js"><link rel="prefetch" href="/assets/3. è„šæ‰‹æ¶.html.54dc7d4a.js"><link rel="prefetch" href="/assets/1. Dubbo æ¡†æ¶.html.1d5acdce.js"><link rel="prefetch" href="/assets/2. ç›´è¿æ–¹å¼.html.359ef81d.js"><link rel="prefetch" href="/assets/3. æ”¹é€  Dubbo é¡¹ç›®.html.72824e22.js"><link rel="prefetch" href="/assets/4. å¸¸ç”¨æ ‡ç­¾.html.840815cd.js"><link rel="prefetch" href="/assets/5. æ³¨å†Œä¸­å¿ƒ-Zookeeper.html.b86f30a8.js"><link rel="prefetch" href="/assets/6. ä½¿ç”¨ Zookeeper.html.c3b0bbc8.js"><link rel="prefetch" href="/assets/7. Dubbo çš„é…ç½®.html.6fee71be.js"><link rel="prefetch" href="/assets/8. ç›‘æ§ä¸­å¿ƒ.html.0738b520.js"><link rel="prefetch" href="/assets/index.html.24854532.js"><link rel="prefetch" href="/assets/index.html.2d0bfb5c.js"><link rel="prefetch" href="/assets/0. Maven.html.7e8c3bea.js"><link rel="prefetch" href="/assets/1. HTML.html.7597e63d.js"><link rel="prefetch" href="/assets/10. JavaBean.html.93a4c1a6.js"><link rel="prefetch" href="/assets/11. MVC æ¨¡å¼ä¸ä¸‰å±‚æ¶æ„çš„åŒºåˆ«.html.702fd54d.js"><link rel="prefetch" href="/assets/12. Filter.html.0620a8d2.js"><link rel="prefetch" href="/assets/13. ç›‘å¬å™¨.html.366fe924.js"><link rel="prefetch" href="/assets/14. JDBC.html.a0c2317c.js"><link rel="prefetch" href="/assets/15. Ajax.html.fc5d0393.js"><link rel="prefetch" href="/assets/2. CSS.html.314a0a75.js"><link rel="prefetch" href="/assets/3. JavaScript.html.8353ff27.js"><link rel="prefetch" href="/assets/4. jQuery.html.d1442778.js"><link rel="prefetch" href="/assets/5. xml å’Œ json.html.2e907af9.js"><link rel="prefetch" href="/assets/6. tomcat.html.56b0a242.js"><link rel="prefetch" href="/assets/7. Servlet.html.d415c7d1.js"><link rel="prefetch" href="/assets/8. Cookie å’Œ Session.html.1609f25e.js"><link rel="prefetch" href="/assets/9. JSP.html.e854fe05.js"><link rel="prefetch" href="/assets/Cookie å­˜ JSON.html.e21af224.js"><link rel="prefetch" href="/assets/SSMç¯å¢ƒæ­å»º.html.64ba0bd7.js"><link rel="prefetch" href="/assets/XXmappingæ³¨è§£.html.ae61afed.js"><link rel="prefetch" href="/assets/index.html.e16d41a5.js"><link rel="prefetch" href="/assets/å¤„ç†å™¨æ–¹æ³•çš„è¿”å›å€¼.html.3612ba29.js"><link rel="prefetch" href="/assets/è¯·æ±‚è½¬å‘ä¸è¯·æ±‚é‡å®šå‘.html.db484390.js"><link rel="prefetch" href="/assets/1. IOC.html.b3d97ed2.js"><link rel="prefetch" href="/assets/10. æ•´åˆMybatis.html.bb91a0f0.js"><link rel="prefetch" href="/assets/11. äº‹åŠ¡.html.705aa111.js"><link rel="prefetch" href="/assets/12.  webé¡¹ç›®ä¸­ä½¿ç”¨å®¹å™¨å¯¹è±¡.html.559d856f.js"><link rel="prefetch" href="/assets/2. Springåˆ›å»ºå¯¹è±¡.html.3548feb4.js"><link rel="prefetch" href="/assets/3. DI ä¾èµ–æ³¨å…¥.html.5114db28.js"><link rel="prefetch" href="/assets/4. Springé…ç½®.html.e1c9412d.js"><link rel="prefetch" href="/assets/5. Beanè‡ªåŠ¨è£…é….html.98b74cd6.js"><link rel="prefetch" href="/assets/6. ä½¿ç”¨æ³¨è§£å¼€å‘.html.50e3139d.js"><link rel="prefetch" href="/assets/7. ä½¿ç”¨javaæ–¹å¼é…ç½®Spring.html.5c9621b0.js"><link rel="prefetch" href="/assets/8. ä»£ç†æ¨¡å¼.html.aae61f02.js"><link rel="prefetch" href="/assets/9. Spring AOP.html.ecc861e2.js"><link rel="prefetch" href="/assets/1. SpringBoot.html.50ee5856.js"><link rel="prefetch" href="/assets/2. JavaConfig.html.0fd39f77.js"><link rel="prefetch" href="/assets/3. Webç»„ä»¶.html.ee3acd4d.js"><link rel="prefetch" href="/assets/4. ORM æ“ä½œ MySQL.html.f320833c.js"><link rel="prefetch" href="/assets/5. RESTful.html.4e0ea18e.js"><link rel="prefetch" href="/assets/6. é›†æˆ Redis.html.019e2cdb.js"><link rel="prefetch" href="/assets/index.html.e48a84a8.js"><link rel="prefetch" href="/assets/1. ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº.html.9a21c34a.js"><link rel="prefetch" href="/assets/10. æ‹¦æˆªå™¨.html.c7f6f4c3.js"><link rel="prefetch" href="/assets/2. é…ç½®è§†å›¾è§£æå™¨.html.14badf9a.js"><link rel="prefetch" href="/assets/3. æ§åˆ¶è¯·æ±‚æ–¹å¼.html.6b8c7035.js"><link rel="prefetch" href="/assets/4. å¤„ç†å™¨æ–¹æ³•çš„å‚æ•°.html.e1eb5ef4.js"><link rel="prefetch" href="/assets/5. å¤„ç†å™¨æ–¹æ³•çš„è¿”å›å€¼.html.7d21923e.js"><link rel="prefetch" href="/assets/6. url-pattern.html.92107f19.js"><link rel="prefetch" href="/assets/7. SSMæ•´åˆ.html.176ae25f.js"><link rel="prefetch" href="/assets/8. è¯·æ±‚é‡å®šå‘å’Œè½¬å‘.html.f9d9891e.js"><link rel="prefetch" href="/assets/9. å¼‚å¸¸å¤„ç†.html.a3ed0ef7.js"><link rel="prefetch" href="/assets/index.html.95fff35f.js"><link rel="prefetch" href="/assets/404.html.a240fd26.js"><link rel="prefetch" href="/assets/index.html.959edad6.js"><link rel="prefetch" href="/assets/index.html.a3f0cf1d.js"><link rel="prefetch" href="/assets/index.html.d8d2a309.js"><link rel="prefetch" href="/assets/index.html.c637a48c.js"><link rel="prefetch" href="/assets/index.html.bec2f67e.js"><link rel="prefetch" href="/assets/index.html.1ae9f863.js"><link rel="prefetch" href="/assets/index.html.f6cd30d9.js"><link rel="prefetch" href="/assets/index.html.664b2367.js"><link rel="prefetch" href="/assets/index.html.9fc22188.js"><link rel="prefetch" href="/assets/index.html.87f5ef83.js"><link rel="prefetch" href="/assets/index.html.b6baff10.js"><link rel="prefetch" href="/assets/index.html.df9abfbe.js"><link rel="prefetch" href="/assets/index.html.2a6a22ea.js"><link rel="prefetch" href="/assets/index.html.7a057341.js"><link rel="prefetch" href="/assets/index.html.bd05c30e.js"><link rel="prefetch" href="/assets/index.html.e606c064.js"><link rel="prefetch" href="/assets/index.html.0cf4dcfd.js"><link rel="prefetch" href="/assets/index.html.8c585a06.js"><link rel="prefetch" href="/assets/index.html.b5df2403.js"><link rel="prefetch" href="/assets/index.html.2cdad7a0.js"><link rel="prefetch" href="/assets/1. Javaè¯­è¨€æ¦‚è¿°ä¸å¼€å‘ç¯å¢ƒ.html.dfef6526.js"><link rel="prefetch" href="/assets/10. é¢å‘å¯¹è±¡ï¼ˆä¸‹ï¼‰.html.41245b38.js"><link rel="prefetch" href="/assets/11. ä¸è¿è¡Œç¯å¢ƒäº¤äº’.html.fc14070d.js"><link rel="prefetch" href="/assets/12. Javaé›†åˆ.html.dcff1ac7.js"><link rel="prefetch" href="/assets/13. æ³›å‹.html.c961d270.js"><link rel="prefetch" href="/assets/14. å‡½æ•°å¼ç¼–ç¨‹.html.7ab9b6f6.js"><link rel="prefetch" href="/assets/15. å¼‚å¸¸å¤„ç†.html.9aed25f0.js"><link rel="prefetch" href="/assets/16. æ³¨è§£.html.9d7cc4af.js"><link rel="prefetch" href="/assets/17. IOæµ.html.f7810d16.js"><link rel="prefetch" href="/assets/19. ç±»åŠ è½½æœºåˆ¶ä¸åå°„.html.c1108591.js"><link rel="prefetch" href="/assets/2. ç¬¬ä¸€ä¸ªjavaç¨‹åº.html.b1e6b948.js"><link rel="prefetch" href="/assets/3. Javaç¨‹åºçš„åŸºæœ¬è§„åˆ™.html.f5bb9195.js"><link rel="prefetch" href="/assets/4. æ•°æ®ç±»å‹.html.3d9ac009.js"><link rel="prefetch" href="/assets/5. è¿ç®—ç¬¦.html.861e1805.js"><link rel="prefetch" href="/assets/6. æµç¨‹æ§åˆ¶.html.8b7eaaa2.js"><link rel="prefetch" href="/assets/7. é¢å‘å¯¹è±¡ï¼ˆä¸Šï¼‰.html.eab514e4.js"><link rel="prefetch" href="/assets/8. æ•°ç»„.html.24458522.js"><link rel="prefetch" href="/assets/9. æ•°ç»„çš„å¸¸è§ç®—æ³•.html.bfbf194a.js"><link rel="prefetch" href="/assets/1. VMware.html.8a371c55.js"><link rel="prefetch" href="/assets/2. æ–‡ä»¶ç®¡ç†.html.9067486e.js"><link rel="prefetch" href="/assets/3. ç³»ç»Ÿç®¡ç†.html.3e8ed05a.js"><link rel="prefetch" href="/assets/4. ç”¨æˆ·å’Œç»„.html.04919f68.js"><link rel="prefetch" href="/assets/5. è½¯ä»¶åŒ…ç®¡ç†.html.271cb796.js"><link rel="prefetch" href="/assets/6. JavaEEç¯å¢ƒæ­å»º.html.7b812776.js"><link rel="prefetch" href="/assets/index.html.3c6ab12d.js"><link rel="prefetch" href="/assets/1. åˆ›å»ºä¸ç®¡ç†æ•°æ®åº“.html.dffb81ee.js"><link rel="prefetch" href="/assets/2. åˆ›å»ºä¸ç®¡ç†æ•°æ®è¡¨.html.348a3cbd.js"><link rel="prefetch" href="/assets/3. çº¦æŸç®¡ç†.html.396d3e68.js"><link rel="prefetch" href="/assets/4. æ•°æ®è¡¨çš„åŸºæœ¬æ“ä½œ.html.b555a86f.js"><link rel="prefetch" href="/assets/5. è§†å›¾.html.8f915903.js"><link rel="prefetch" href="/assets/6. ç´¢å¼•.html.311cd377.js"><link rel="prefetch" href="/assets/7. äº‹åŠ¡.html.5a2a21d7.js"><link rel="prefetch" href="/assets/1. å‡†å¤‡.html.09509215.js"><link rel="prefetch" href="/assets/10. æ³¨è§£.html.4dd41840.js"><link rel="prefetch" href="/assets/11. å¤æ‚æŸ¥è¯¢ç¯å¢ƒæ­å»º.html.a32d34da.js"><link rel="prefetch" href="/assets/12. åŠ¨æ€ SQL.html.b9ab3830.js"><link rel="prefetch" href="/assets/2. ä½¿ç”¨.html.94bf6b9d.js"><link rel="prefetch" href="/assets/3. ä¸»è¦ç±»ä»‹ç».html.3794c3f1.js"><link rel="prefetch" href="/assets/4. é…ç½®æ–‡ä»¶è¯¦è§£.html.7669c61b.js"><link rel="prefetch" href="/assets/5. CRUD.html.11026f5c.js"><link rel="prefetch" href="/assets/6. é…ç½® environments.html.8fea6e22.js"><link rel="prefetch" href="/assets/7. ResultMap ç»“æœé›†æ˜ å°„.html.b9249ad0.js"><link rel="prefetch" href="/assets/8. æ—¥å¿—.html.cb173b73.js"><link rel="prefetch" href="/assets/9. åˆ†é¡µ.html.b1d10514.js"><link rel="prefetch" href="/assets/index.html.951aced4.js"><link rel="prefetch" href="/assets/index.html.89acfd2f.js"><link rel="prefetch" href="/assets/1. Vue æ ¸å¿ƒ.html.3e3976f3.js"><link rel="prefetch" href="/assets/2. ç»„ä»¶åŒ–ç¼–ç¨‹.html.a4a31df9.js"><link rel="prefetch" href="/assets/3. è„šæ‰‹æ¶.html.37ed95e1.js"><link rel="prefetch" href="/assets/1. Dubbo æ¡†æ¶.html.ebf01285.js"><link rel="prefetch" href="/assets/2. ç›´è¿æ–¹å¼.html.52bd0c81.js"><link rel="prefetch" href="/assets/3. æ”¹é€  Dubbo é¡¹ç›®.html.e9dd69bd.js"><link rel="prefetch" href="/assets/4. å¸¸ç”¨æ ‡ç­¾.html.855724b1.js"><link rel="prefetch" href="/assets/5. æ³¨å†Œä¸­å¿ƒ-Zookeeper.html.64c30e53.js"><link rel="prefetch" href="/assets/6. ä½¿ç”¨ Zookeeper.html.a9379c15.js"><link rel="prefetch" href="/assets/7. Dubbo çš„é…ç½®.html.5c0b7188.js"><link rel="prefetch" href="/assets/8. ç›‘æ§ä¸­å¿ƒ.html.76e5ddd6.js"><link rel="prefetch" href="/assets/index.html.9be964a7.js"><link rel="prefetch" href="/assets/index.html.b97ef4ab.js"><link rel="prefetch" href="/assets/0. Maven.html.da9b46a4.js"><link rel="prefetch" href="/assets/1. HTML.html.d3bbce51.js"><link rel="prefetch" href="/assets/10. JavaBean.html.56e5e6b6.js"><link rel="prefetch" href="/assets/11. MVC æ¨¡å¼ä¸ä¸‰å±‚æ¶æ„çš„åŒºåˆ«.html.8bddb78a.js"><link rel="prefetch" href="/assets/12. Filter.html.c3d43c6e.js"><link rel="prefetch" href="/assets/13. ç›‘å¬å™¨.html.eb6ae46a.js"><link rel="prefetch" href="/assets/14. JDBC.html.d8a2c281.js"><link rel="prefetch" href="/assets/15. Ajax.html.d78a4a5f.js"><link rel="prefetch" href="/assets/2. CSS.html.56ce9dee.js"><link rel="prefetch" href="/assets/3. JavaScript.html.44bb84ac.js"><link rel="prefetch" href="/assets/4. jQuery.html.eac2cfdf.js"><link rel="prefetch" href="/assets/5. xml å’Œ json.html.8f43fc57.js"><link rel="prefetch" href="/assets/6. tomcat.html.eb22f271.js"><link rel="prefetch" href="/assets/7. Servlet.html.3f0e07c9.js"><link rel="prefetch" href="/assets/8. Cookie å’Œ Session.html.0f2228da.js"><link rel="prefetch" href="/assets/9. JSP.html.ebb6d737.js"><link rel="prefetch" href="/assets/Cookie å­˜ JSON.html.098076a8.js"><link rel="prefetch" href="/assets/SSMç¯å¢ƒæ­å»º.html.fa0adc00.js"><link rel="prefetch" href="/assets/XXmappingæ³¨è§£.html.07d9e7a9.js"><link rel="prefetch" href="/assets/index.html.3cde9202.js"><link rel="prefetch" href="/assets/å¤„ç†å™¨æ–¹æ³•çš„è¿”å›å€¼.html.8d1885e9.js"><link rel="prefetch" href="/assets/è¯·æ±‚è½¬å‘ä¸è¯·æ±‚é‡å®šå‘.html.67ea9a66.js"><link rel="prefetch" href="/assets/1. IOC.html.416725e9.js"><link rel="prefetch" href="/assets/10. æ•´åˆMybatis.html.6fa3e19e.js"><link rel="prefetch" href="/assets/11. äº‹åŠ¡.html.3a5079c3.js"><link rel="prefetch" href="/assets/12.  webé¡¹ç›®ä¸­ä½¿ç”¨å®¹å™¨å¯¹è±¡.html.e6abfa0b.js"><link rel="prefetch" href="/assets/2. Springåˆ›å»ºå¯¹è±¡.html.12c89145.js"><link rel="prefetch" href="/assets/3. DI ä¾èµ–æ³¨å…¥.html.17ad9f69.js"><link rel="prefetch" href="/assets/4. Springé…ç½®.html.6ca1caf6.js"><link rel="prefetch" href="/assets/5. Beanè‡ªåŠ¨è£…é….html.b3a63179.js"><link rel="prefetch" href="/assets/6. ä½¿ç”¨æ³¨è§£å¼€å‘.html.eb2f135a.js"><link rel="prefetch" href="/assets/7. ä½¿ç”¨javaæ–¹å¼é…ç½®Spring.html.547c43a1.js"><link rel="prefetch" href="/assets/8. ä»£ç†æ¨¡å¼.html.d1ec9b80.js"><link rel="prefetch" href="/assets/9. Spring AOP.html.ae06e224.js"><link rel="prefetch" href="/assets/1. SpringBoot.html.5398662d.js"><link rel="prefetch" href="/assets/2. JavaConfig.html.b9ced3e4.js"><link rel="prefetch" href="/assets/3. Webç»„ä»¶.html.35667cb9.js"><link rel="prefetch" href="/assets/4. ORM æ“ä½œ MySQL.html.6ec276a5.js"><link rel="prefetch" href="/assets/5. RESTful.html.47eaa3ea.js"><link rel="prefetch" href="/assets/6. é›†æˆ Redis.html.6821a1f6.js"><link rel="prefetch" href="/assets/index.html.8eeb8230.js"><link rel="prefetch" href="/assets/1. ç¬¬ä¸€ä¸ªSpringMVCç¨‹åº.html.1787cad2.js"><link rel="prefetch" href="/assets/10. æ‹¦æˆªå™¨.html.ea2d324c.js"><link rel="prefetch" href="/assets/2. é…ç½®è§†å›¾è§£æå™¨.html.d2170dbf.js"><link rel="prefetch" href="/assets/3. æ§åˆ¶è¯·æ±‚æ–¹å¼.html.ee404587.js"><link rel="prefetch" href="/assets/4. å¤„ç†å™¨æ–¹æ³•çš„å‚æ•°.html.a3e17651.js"><link rel="prefetch" href="/assets/5. å¤„ç†å™¨æ–¹æ³•çš„è¿”å›å€¼.html.6e1a5f02.js"><link rel="prefetch" href="/assets/6. url-pattern.html.9c71e31d.js"><link rel="prefetch" href="/assets/7. SSMæ•´åˆ.html.ce5e2b1f.js"><link rel="prefetch" href="/assets/8. è¯·æ±‚é‡å®šå‘å’Œè½¬å‘.html.6eaaca32.js"><link rel="prefetch" href="/assets/9. å¼‚å¸¸å¤„ç†.html.3240a7e2.js"><link rel="prefetch" href="/assets/index.html.aa5558fe.js"><link rel="prefetch" href="/assets/404.html.d08efd0d.js"><link rel="prefetch" href="/assets/index.html.8bfd676e.js"><link rel="prefetch" href="/assets/index.html.79622970.js"><link rel="prefetch" href="/assets/index.html.3d6bc681.js"><link rel="prefetch" href="/assets/index.html.f634c4e8.js"><link rel="prefetch" href="/assets/index.html.3aa25da0.js"><link rel="prefetch" href="/assets/index.html.b8a10654.js"><link rel="prefetch" href="/assets/index.html.2816b4cb.js"><link rel="prefetch" href="/assets/index.html.5b3d8dcb.js"><link rel="prefetch" href="/assets/index.html.adba93aa.js"><link rel="prefetch" href="/assets/index.html.0f6ed9fe.js"><link rel="prefetch" href="/assets/index.html.194f97a3.js"><link rel="prefetch" href="/assets/index.html.e74b0c74.js"><link rel="prefetch" href="/assets/index.html.fb982a50.js"><link rel="prefetch" href="/assets/index.html.ef9986d8.js"><link rel="prefetch" href="/assets/index.html.43294f24.js"><link rel="prefetch" href="/assets/index.html.88418c86.js"><link rel="prefetch" href="/assets/index.html.76a45c66.js"><link rel="prefetch" href="/assets/index.html.ba8bd966.js"><link rel="prefetch" href="/assets/index.html.d49ac3e1.js"><link rel="prefetch" href="/assets/photoswipe.esm.f594e77b.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="ç©º~"><!----><span class="site-name hide-in-pad">ç©º~</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home"></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/guide/" class="nav-link" aria-label="å­¦ä¹ æŒ‡å—"><span class="icon iconfont icon-creative"></span>å­¦ä¹ æŒ‡å—<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/Java/1.%20Java%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0%E4%B8%8E%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" class="nav-link" aria-label="JavaSE"><span class="icon iconfont icon-java"></span>JavaSE<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/MySQL/1.%20%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93.html" class="nav-link" aria-label="MySQL"><span class="icon iconfont icon-mysql"></span>MySQL<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/javaWeb/0.%20Maven.html" class="nav-link" aria-label="JavaWeb"><span class="icon iconfont icon-Apache"></span>JavaWeb<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/Mybatis/" class="nav-link" aria-label="Mybatis"><span class="icon iconfont icon-stack"></span>Mybatis<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Springç³»åˆ—"><span class="title"><span class="icon iconfont icon-stack"></span>Springç³»åˆ—</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/Spring%E7%B3%BB%E5%88%97/Spring/1.%20IOC.html" class="nav-link" aria-label="Spring"><span class="icon iconfont icon-module"></span>Spring<!----></a></li><li class="dropdown-item"><a href="/docs/Spring%E7%B3%BB%E5%88%97/SpringMVC/" class="nav-link" aria-label="SpringMVC"><span class="icon iconfont icon-module"></span>SpringMVC<!----></a></li><li class="dropdown-item"><a href="/docs/Spring%E7%B3%BB%E5%88%97/SpringBoot/" class="nav-link" aria-label="SpringBoot"><span class="icon iconfont icon-module"></span>SpringBoot<!----></a></li><li class="dropdown-item"><a href="/docs/Springç³»åˆ—/SpringCloud/" class="nav-link" aria-label="SpringCloud"><span class="icon iconfont icon-module"></span>SpringCloud<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/docs/Vue/1.%20Vue%20%E6%A0%B8%E5%BF%83.html" class="nav-link" aria-label="Vue"><span class="icon iconfont icon-vue"></span>Vue<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/Linux/" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-linux"></span>Linux<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/dubbo/" class="nav-link" aria-label="Dubbo"><span class="icon iconfont icon-tool"></span>Dubbo<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/%E5%B0%8F%E8%AE%B0/" class="nav-link" aria-label="å°è®°"><span class="icon iconfont icon-write"></span>å°è®°<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/SurplusFate/SurplusFate.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/docs/Java/1.%20Java%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0%E4%B8%8E%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" class="nav-link sidebar-link sidebar-page" aria-label="1. Java è¯­è¨€æ¦‚è¿°ä¸å¼€å‘ç¯å¢ƒ"><span class="icon iconfont icon-note"></span>1. Java è¯­è¨€æ¦‚è¿°ä¸å¼€å‘ç¯å¢ƒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/2.%20%E7%AC%AC%E4%B8%80%E4%B8%AAjava%E7%A8%8B%E5%BA%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="2. ç¬¬ä¸€ä¸ª java ç¨‹åº"><span class="icon iconfont icon-note"></span>2. ç¬¬ä¸€ä¸ª java ç¨‹åº<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/3.%20Java%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%A7%84%E5%88%99.html" class="nav-link sidebar-link sidebar-page" aria-label="3. Java ç¨‹åºçš„åŸºæœ¬è§„åˆ™"><span class="icon iconfont icon-note"></span>3. Java ç¨‹åºçš„åŸºæœ¬è§„åˆ™<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/4.%20%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="4. æ•°æ®ç±»å‹"><span class="icon iconfont icon-note"></span>4. æ•°æ®ç±»å‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/5.%20%E8%BF%90%E7%AE%97%E7%AC%A6.html" class="nav-link sidebar-link sidebar-page" aria-label="5. è¿ç®—ç¬¦"><span class="icon iconfont icon-note"></span>5. è¿ç®—ç¬¦<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/6.%20%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6.html" class="nav-link sidebar-link sidebar-page" aria-label="6. æµç¨‹æ§åˆ¶"><span class="icon iconfont icon-note"></span>6. æµç¨‹æ§åˆ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/7.%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%8A%EF%BC%89.html" class="nav-link sidebar-link sidebar-page" aria-label="7. é¢å‘å¯¹è±¡ï¼ˆä¸Šï¼‰"><span class="icon iconfont icon-note"></span>7. é¢å‘å¯¹è±¡ï¼ˆä¸Šï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/8.%20%E6%95%B0%E7%BB%84.html" class="nav-link sidebar-link sidebar-page" aria-label="8. æ•°ç»„"><span class="icon iconfont icon-note"></span>8. æ•°ç»„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/9.%20%E6%95%B0%E7%BB%84%E7%9A%84%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95.html" class="nav-link sidebar-link sidebar-page" aria-label="9. æ•°ç»„çš„å¸¸è§ç®—æ³•"><span class="icon iconfont icon-note"></span>9. æ•°ç»„çš„å¸¸è§ç®—æ³•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/10.%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%8B%EF%BC%89.html" class="nav-link sidebar-link sidebar-page" aria-label="10. é¢å‘å¯¹è±¡ï¼ˆä¸‹ï¼‰"><span class="icon iconfont icon-note"></span>10. é¢å‘å¯¹è±¡ï¼ˆä¸‹ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/11.%20%E4%B8%8E%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E4%BA%A4%E4%BA%92.html" class="nav-link sidebar-link sidebar-page" aria-label="11. ä¸è¿è¡Œç¯å¢ƒäº¤äº’"><span class="icon iconfont icon-note"></span>11. ä¸è¿è¡Œç¯å¢ƒäº¤äº’<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/12.%20Java%E9%9B%86%E5%90%88.html" class="nav-link sidebar-link sidebar-page" aria-label="12. Java é›†åˆ"><span class="icon iconfont icon-note"></span>12. Java é›†åˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/13.%20%E6%B3%9B%E5%9E%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="13. æ³›å‹"><span class="icon iconfont icon-note"></span>13. æ³›å‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/14.%20%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="14. å‡½æ•°å¼ç¼–ç¨‹"><span class="icon iconfont icon-note"></span>14. å‡½æ•°å¼ç¼–ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/15.%20%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86.html" class="nav-link sidebar-link sidebar-page" aria-label="15. å¼‚å¸¸å¤„ç†"><span class="icon iconfont icon-note"></span>15. å¼‚å¸¸å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/16.%20%E6%B3%A8%E8%A7%A3.html" class="nav-link sidebar-link sidebar-page" aria-label="16. æ³¨è§£"><span class="icon iconfont icon-note"></span>16. æ³¨è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/Java/17.%20IO%E6%B5%81.html" class="nav-link sidebar-link sidebar-page" aria-label="17. IO æµ"><span class="icon iconfont icon-note"></span>17. IO æµ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="18. å¤šçº¿ç¨‹"><span class="icon iconfont icon-note"></span>18. å¤šçº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ¦‚è¿°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹æ¦‚è¿°"><!---->çº¿ç¨‹æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹å’Œè¿›ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹å’Œè¿›ç¨‹"><!---->çº¿ç¨‹å’Œè¿›ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åˆ›å»ºå¤šçº¿ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»ºå¤šçº¿ç¨‹"><!---->åˆ›å»ºå¤šçº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#thread-ç±»åˆ›å»ºçº¿ç¨‹ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Thread ç±»åˆ›å»ºçº¿ç¨‹ç±»"><!---->Thread ç±»åˆ›å»ºçº¿ç¨‹ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#å®ç°-runnable-æ¥å£åˆ›å»ºçº¿ç¨‹ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®ç° Runnable æ¥å£åˆ›å»ºçº¿ç¨‹ç±»"><!---->å®ç° Runnable æ¥å£åˆ›å»ºçº¿ç¨‹ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä½¿ç”¨-callable-å’Œ-future-åˆ›å»ºçº¿ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨ Callable å’Œ Future åˆ›å»ºçº¿ç¨‹"><!---->ä½¿ç”¨ Callable å’Œ Future åˆ›å»ºçº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”"><!---->åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"><!---->çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ–°å»ºå’Œå°±ç»ªçŠ¶æ€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–°å»ºå’Œå°±ç»ªçŠ¶æ€"><!---->æ–°å»ºå’Œå°±ç»ªçŠ¶æ€<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#è¿è¡Œå’Œé˜»å¡çŠ¶æ€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿è¡Œå’Œé˜»å¡çŠ¶æ€"><!---->è¿è¡Œå’Œé˜»å¡çŠ¶æ€<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ­»äº¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹æ­»äº¡"><!---->çº¿ç¨‹æ­»äº¡<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ§åˆ¶çº¿ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ§åˆ¶çº¿ç¨‹"><!---->æ§åˆ¶çº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#join-çº¿ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="join çº¿ç¨‹"><!---->join çº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åå°çº¿ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åå°çº¿ç¨‹"><!---->åå°çº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç¡çœ -sleep" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹ç¡çœ ï¼šsleep"><!---->çº¿ç¨‹ç¡çœ ï¼šsleep<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹è®©æ­¥-yield" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹è®©æ­¥ï¼šyield"><!---->çº¿ç¨‹è®©æ­¥ï¼šyield<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§"><!---->æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹åŒæ­¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹åŒæ­¥"><!---->çº¿ç¨‹åŒæ­¥<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹å®‰å…¨é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹å®‰å…¨é—®é¢˜"><!---->çº¿ç¨‹å®‰å…¨é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒæ­¥ä»£ç å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŒæ­¥ä»£ç å—"><!---->åŒæ­¥ä»£ç å—<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒæ­¥æ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŒæ­¥æ–¹æ³•"><!---->åŒæ­¥æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š"><!---->é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒæ­¥é”-lock" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŒæ­¥é”ï¼ˆLockï¼‰"><!---->åŒæ­¥é”ï¼ˆLockï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ­»é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ­»é”"><!---->æ­»é”<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹é€šä¿¡"><!---->çº¿ç¨‹é€šä¿¡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡"><!---->ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä½¿ç”¨-condition-æ§åˆ¶çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨ Condition æ§åˆ¶çº¿ç¨‹é€šä¿¡"><!---->ä½¿ç”¨ Condition æ§åˆ¶çº¿ç¨‹é€šä¿¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä½¿ç”¨é˜»å¡é˜Ÿåˆ—-blockingqueue-æ§åˆ¶çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡"><!---->ä½¿ç”¨é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸"><!---->çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ± " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹æ± "><!---->çº¿ç¨‹æ± <!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#å®ç°çš„çº¿ç¨‹æ± " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®ç°çš„çº¿ç¨‹æ± "><!---->å®ç°çš„çº¿ç¨‹æ± <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#forkjoinpool" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ForkJoinPool"><!---->ForkJoinPool<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç›¸å…³ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹ç›¸å…³ç±»"><!---->çº¿ç¨‹ç›¸å…³ç±»<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#threadlocal" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ThreadLocal"><!---->ThreadLocal<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ"><!---->åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»"><!---->çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/docs/Java/19.%20%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%8F%8D%E5%B0%84.html" class="nav-link sidebar-link sidebar-page" aria-label="19. ç±»åŠ è½½æœºåˆ¶ä¸åå°„"><span class="icon iconfont icon-note"></span>19. ç±»åŠ è½½æœºåˆ¶ä¸åå°„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-note"></span>18. å¤šçº¿ç¨‹</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://SurplusFate.github.io" target="_blank" rel="noopener noreferrer">ç©º~</a></span><span property="author" content="ç©º~"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´8æœˆ18æ—¥</span><meta property="datePublished" content="2022-08-18T00:00:00.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category6 clickable" role="navigation">java</li><meta property="articleSection" content="java"></ul></span><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 66 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT66M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ¦‚è¿°" class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹æ¦‚è¿°</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹å’Œè¿›ç¨‹" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹å’Œè¿›ç¨‹</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åˆ›å»ºå¤šçº¿ç¨‹" class="router-link-active router-link-exact-active toc-link level2">åˆ›å»ºå¤šçº¿ç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#thread-ç±»åˆ›å»ºçº¿ç¨‹ç±»" class="router-link-active router-link-exact-active toc-link level3">Thread ç±»åˆ›å»ºçº¿ç¨‹ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#å®ç°-runnable-æ¥å£åˆ›å»ºçº¿ç¨‹ç±»" class="router-link-active router-link-exact-active toc-link level3">å®ç° Runnable æ¥å£åˆ›å»ºçº¿ç¨‹ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä½¿ç”¨-callable-å’Œ-future-åˆ›å»ºçº¿ç¨‹" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨ Callable å’Œ Future åˆ›å»ºçº¿ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ–°å»ºå’Œå°±ç»ªçŠ¶æ€" class="router-link-active router-link-exact-active toc-link level3">æ–°å»ºå’Œå°±ç»ªçŠ¶æ€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#è¿è¡Œå’Œé˜»å¡çŠ¶æ€" class="router-link-active router-link-exact-active toc-link level3">è¿è¡Œå’Œé˜»å¡çŠ¶æ€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ­»äº¡" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹æ­»äº¡</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ§åˆ¶çº¿ç¨‹" class="router-link-active router-link-exact-active toc-link level2">æ§åˆ¶çº¿ç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#join-çº¿ç¨‹" class="router-link-active router-link-exact-active toc-link level3">join çº¿ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åå°çº¿ç¨‹" class="router-link-active router-link-exact-active toc-link level3">åå°çº¿ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç¡çœ -sleep" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹ç¡çœ ï¼šsleep</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹è®©æ­¥-yield" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹è®©æ­¥ï¼šyield</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§" class="router-link-active router-link-exact-active toc-link level3">æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹åŒæ­¥" class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹åŒæ­¥</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹å®‰å…¨é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹å®‰å…¨é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒæ­¥ä»£ç å—" class="router-link-active router-link-exact-active toc-link level3">åŒæ­¥ä»£ç å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒæ­¥æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">åŒæ­¥æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š" class="router-link-active router-link-exact-active toc-link level3">é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒæ­¥é”-lock" class="router-link-active router-link-exact-active toc-link level3">åŒæ­¥é”ï¼ˆLockï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ­»é”" class="router-link-active router-link-exact-active toc-link level3">æ­»é”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹é€šä¿¡</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active toc-link level3">ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä½¿ç”¨-condition-æ§åˆ¶çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨ Condition æ§åˆ¶çº¿ç¨‹é€šä¿¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#ä½¿ç”¨é˜»å¡é˜Ÿåˆ—-blockingqueue-æ§åˆ¶çº¿ç¨‹é€šä¿¡" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸" class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ± " class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹æ± </a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#å®ç°çš„çº¿ç¨‹æ± " class="router-link-active router-link-exact-active toc-link level3">å®ç°çš„çº¿ç¨‹æ± </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#forkjoinpool" class="router-link-active router-link-exact-active toc-link level3">ForkJoinPool</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç›¸å…³ç±»" class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹ç›¸å…³ç±»</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#threadlocal" class="router-link-active router-link-exact-active toc-link level3">ThreadLocal</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ" class="router-link-active router-link-exact-active toc-link level3">åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/Java/18.%20%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="_18-å¤šçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#_18-å¤šçº¿ç¨‹" aria-hidden="true">#</a> 18. å¤šçº¿ç¨‹</h1><h2 id="çº¿ç¨‹æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹æ¦‚è¿°" aria-hidden="true">#</a> çº¿ç¨‹æ¦‚è¿°</h2><p>å‡ ä¹æ‰€æœ‰çš„æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒåŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œä¸€ä¸ªä»»åŠ¡é€šå¸¸å°±æ˜¯ä¸€ä¸ªç¨‹åºï¼Œæ¯ä¸ªè¿è¡Œä¸­çš„ç¨‹åºå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚å½“ä¸€ä¸ªè¿›ç¨‹è¿è¡Œæ—¶ï¼Œå†…éƒ¨å¯èƒ½åŒ…å«äº†å¤šä¸ªé¡ºåºæ‰§è¡Œæµï¼Œæ¯ä¸ªé¡ºåºæ‰§è¡Œæµå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚</p><h3 id="çº¿ç¨‹å’Œè¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹å’Œè¿›ç¨‹" aria-hidden="true">#</a> çº¿ç¨‹å’Œè¿›ç¨‹</h3><h4 id="çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹" aria-hidden="true">#</a> çº¿ç¨‹</h4><p>ç°ä»£æ“ä½œç³»ç»Ÿï¼ˆWindowsï¼ŒmacOSï¼ŒLinuxï¼‰éƒ½å¯ä»¥æ‰§è¡Œå¤šä»»åŠ¡ã€‚å¤šä»»åŠ¡å°±æ˜¯åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šæµè§ˆå™¨ã€QQã€éŸ³ä¹ã€‚</p><p>CPU æ‰§è¡Œä»£ç éƒ½æ˜¯ä¸€æ¡ä¸€æ¡é¡ºåºæ‰§è¡Œçš„ï¼Œä½†æ˜¯ï¼Œå³ä½¿æ˜¯å•æ ¸ CPUï¼Œä¹Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ã€‚å› ä¸ºæ“ä½œç³»ç»Ÿæ‰§è¡Œå¤šä»»åŠ¡å®é™…ä¸Šå°±æ˜¯è®© CPU å¯¹å¤šä¸ªä»»åŠ¡è½®æµäº¤æ›¿æ‰§è¡Œã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰è¯­æ–‡ã€æ•°å­¦ã€è‹±è¯­ 3 é—¨ä½œä¸šè¦åšï¼Œæ¯ä¸ªä½œä¸šéœ€è¦ 30 åˆ†é’Ÿã€‚æˆ‘ä»¬æŠŠè¿™ 3 é—¨ä½œä¸šçœ‹æˆæ˜¯ 3 ä¸ªä»»åŠ¡ï¼Œå¯ä»¥åš 1 åˆ†é’Ÿè¯­æ–‡ä½œä¸šï¼Œå†åš 1 åˆ†é’Ÿæ•°å­¦ä½œä¸šï¼Œå†åš 1 åˆ†é’Ÿè‹±è¯­ä½œä¸šï¼šè¿™æ ·è½®æµåšä¸‹å»ï¼Œåœ¨æŸäº›äººçœ¼é‡Œçœ‹æ¥ï¼Œåšä½œä¸šçš„é€Ÿåº¦å°±éå¸¸å¿«ï¼Œçœ‹ä¸Šå»å°±åƒåŒæ—¶åœ¨åš 3 é—¨ä½œä¸šä¸€æ ·ã€‚</p><p>ç±»ä¼¼çš„ï¼Œæ“ä½œç³»ç»Ÿè½®æµè®©å¤šä¸ªä»»åŠ¡äº¤æ›¿æ‰§è¡Œï¼Œä¾‹å¦‚ï¼Œè®©æµè§ˆå™¨æ‰§è¡Œ 0.001 ç§’ï¼Œè®© QQ æ‰§è¡Œ 0.001 ç§’ï¼Œå†è®©éŸ³ä¹æ’­æ”¾å™¨æ‰§è¡Œ 0.001 ç§’ï¼Œåœ¨äººçœ‹æ¥ï¼ŒCPU å°±æ˜¯åœ¨åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚</p><p>å³ä½¿æ˜¯å¤šæ ¸ CPUï¼Œå› ä¸ºé€šå¸¸ä»»åŠ¡çš„æ•°é‡è¿œè¿œå¤šäº CPU çš„æ ¸æ•°ï¼Œæ‰€ä»¥ä»»åŠ¡ä¹Ÿæ˜¯äº¤æ›¿æ‰§è¡Œçš„ã€‚</p><h4 id="è¿›ç¨‹" tabindex="-1"><a class="header-anchor" href="#è¿›ç¨‹" aria-hidden="true">#</a> è¿›ç¨‹</h4><p>è®¡ç®—æœºä¸­ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªä»»åŠ¡ç§°ä¸ºä¸€ä¸ªè¿›ç¨‹ï¼Œæµè§ˆå™¨å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œè§†é¢‘æ’­æ”¾å™¨æ˜¯å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œç±»ä¼¼çš„ï¼ŒéŸ³ä¹æ’­æ”¾å™¨å’Œ Word éƒ½æ˜¯è¿›ç¨‹ã€‚</p><p>æŸäº›è¿›ç¨‹å†…éƒ¨è¿˜éœ€è¦åŒæ—¶æ‰§è¡Œå¤šä¸ªå­ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ Word æ—¶ï¼ŒWord å¯ä»¥è®©æˆ‘ä»¬ä¸€è¾¹æ‰“å­—ï¼Œä¸€è¾¹è¿›è¡Œæ‹¼å†™æ£€æŸ¥ï¼ŒåŒæ—¶è¿˜å¯ä»¥åœ¨åå°è¿›è¡Œæ‰“å°ï¼Œæˆ‘ä»¬æŠŠå­ä»»åŠ¡ç§°ä¸ºçº¿ç¨‹ã€‚</p><p>è¿›ç¨‹å’Œçº¿ç¨‹çš„å…³ç³»å°±æ˜¯ï¼šä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼Œä½†è‡³å°‘ä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚Process   â”‚
                        â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚ Thread â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚Process   â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚Process   â”‚
            â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚
â”‚Process   â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Operating System               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ“ä½œç³»ç»Ÿè°ƒåº¦çš„æœ€å°ä»»åŠ¡å•ä½å…¶å®ä¸æ˜¯è¿›ç¨‹ï¼Œè€Œæ˜¯çº¿ç¨‹ã€‚å¸¸ç”¨çš„ Windowsã€Linux ç­‰æ“ä½œç³»ç»Ÿéƒ½é‡‡ç”¨æŠ¢å å¼å¤šä»»åŠ¡ï¼Œå¦‚ä½•è°ƒåº¦çº¿ç¨‹å®Œå…¨ç”±æ“ä½œç³»ç»Ÿå†³å®šï¼Œç¨‹åºè‡ªå·±ä¸èƒ½å†³å®šä»€ä¹ˆæ—¶å€™æ‰§è¡Œï¼Œä»¥åŠæ‰§è¡Œå¤šé•¿æ—¶é—´ã€‚</p><p>å› ä¸ºåŒä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œæ—¢å¯ä»¥æœ‰å¤šä¸ªè¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå› æ­¤ï¼Œå®ç°å¤šä»»åŠ¡çš„æ–¹æ³•ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><p>å¤šè¿›ç¨‹æ¨¡å¼ï¼ˆæ¯ä¸ªè¿›ç¨‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼‰ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Process   â”‚ â”‚Process   â”‚ â”‚Process   â”‚
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚â”‚ Thread â”‚â”‚ â”‚â”‚ Thread â”‚â”‚ â”‚â”‚ Thread â”‚â”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤šçº¿ç¨‹æ¨¡å¼ï¼ˆä¸€ä¸ªè¿›ç¨‹æœ‰å¤šä¸ªçº¿ç¨‹ï¼‰ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Process             â”‚
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚â”‚ Thread â”‚â”‚ Thread â”‚â”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚â”‚ Thread â”‚â”‚ Thread â”‚â”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤šè¿›ç¨‹ï¼‹å¤šçº¿ç¨‹æ¨¡å¼ï¼ˆå¤æ‚åº¦æœ€é«˜ï¼‰ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Process   â”‚â”‚Process   â”‚â”‚Process   â”‚
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚â”‚â”‚ Thread â”‚â”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è¿›ç¨‹-vs-çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#è¿›ç¨‹-vs-çº¿ç¨‹" aria-hidden="true">#</a> è¿›ç¨‹ vs çº¿ç¨‹</h4><p>è¿›ç¨‹å’Œçº¿ç¨‹æ˜¯åŒ…å«å…³ç³»ï¼Œä½†æ˜¯å¤šä»»åŠ¡æ—¢å¯ä»¥ç”±å¤šè¿›ç¨‹å®ç°ï¼Œä¹Ÿå¯ä»¥ç”±å•è¿›ç¨‹å†…çš„å¤šçº¿ç¨‹å®ç°ï¼Œè¿˜å¯ä»¥æ··åˆå¤šè¿›ç¨‹ï¼‹å¤šçº¿ç¨‹ã€‚</p><p>å…·ä½“é‡‡ç”¨å“ªç§æ–¹å¼ï¼Œè¦è€ƒè™‘åˆ°è¿›ç¨‹å’Œçº¿ç¨‹çš„ç‰¹ç‚¹ã€‚</p><p>å’Œå¤šçº¿ç¨‹ç›¸æ¯”ï¼Œå¤šè¿›ç¨‹çš„ç¼ºç‚¹åœ¨äºï¼š</p><ul><li>åˆ›å»ºè¿›ç¨‹æ¯”åˆ›å»ºçº¿ç¨‹å¼€é”€å¤§ï¼Œå°¤å…¶æ˜¯åœ¨ Windows ç³»ç»Ÿä¸Šï¼›</li><li>è¿›ç¨‹é—´é€šä¿¡æ¯”çº¿ç¨‹é—´é€šä¿¡è¦æ…¢ï¼Œå› ä¸ºçº¿ç¨‹é—´é€šä¿¡å°±æ˜¯è¯»å†™åŒä¸€ä¸ªå˜é‡ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚</li></ul><p>è€Œå¤šè¿›ç¨‹çš„ä¼˜ç‚¹åœ¨äºï¼š</p><p>å¤šè¿›ç¨‹ç¨³å®šæ€§æ¯”å¤šçº¿ç¨‹é«˜ï¼Œå› ä¸ºåœ¨å¤šè¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹ï¼Œè€Œåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹å´©æºƒä¼šç›´æ¥å¯¼è‡´æ•´ä¸ªè¿›ç¨‹å´©æºƒã€‚</p><h4 id="å¤šçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#å¤šçº¿ç¨‹" aria-hidden="true">#</a> å¤šçº¿ç¨‹</h4><p>Java è¯­è¨€å†…ç½®äº†å¤šçº¿ç¨‹æ”¯æŒï¼šä¸€ä¸ª Java ç¨‹åºå®é™…ä¸Šæ˜¯ä¸€ä¸ª JVM è¿›ç¨‹ï¼ŒJVM è¿›ç¨‹ç”¨ä¸€ä¸ªä¸»çº¿ç¨‹æ¥æ‰§è¡Œ<code>main()</code>æ–¹æ³•ï¼Œåœ¨<code>main()</code>æ–¹æ³•å†…éƒ¨ï¼Œæˆ‘ä»¬åˆå¯ä»¥å¯åŠ¨å¤šä¸ªçº¿ç¨‹ã€‚æ­¤å¤–ï¼ŒJVM è¿˜æœ‰è´Ÿè´£åƒåœ¾å›æ”¶çš„å…¶ä»–å·¥ä½œçº¿ç¨‹ç­‰ã€‚</p><p>å› æ­¤ï¼Œå¯¹äºå¤§å¤šæ•° Java ç¨‹åºæ¥è¯´ï¼Œæˆ‘ä»¬è¯´å¤šä»»åŠ¡ï¼Œå®é™…ä¸Šæ˜¯è¯´å¦‚ä½•ä½¿ç”¨å¤šçº¿ç¨‹å®ç°å¤šä»»åŠ¡ã€‚</p><p>å’Œå•çº¿ç¨‹ç›¸æ¯”ï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹çš„ç‰¹ç‚¹åœ¨äºï¼šå¤šçº¿ç¨‹ç»å¸¸éœ€è¦è¯»å†™å…±äº«æ•°æ®ï¼Œå¹¶ä¸”éœ€è¦åŒæ­¥ã€‚ä¾‹å¦‚ï¼Œæ’­æ”¾ç”µå½±æ—¶ï¼Œå°±å¿…é¡»ç”±ä¸€ä¸ªçº¿ç¨‹æ’­æ”¾è§†é¢‘ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ’­æ”¾éŸ³é¢‘ï¼Œä¸¤ä¸ªçº¿ç¨‹éœ€è¦åè°ƒè¿è¡Œï¼Œå¦åˆ™ç”»é¢å’Œå£°éŸ³å°±ä¸åŒæ­¥ã€‚å› æ­¤ï¼Œå¤šçº¿ç¨‹ç¼–ç¨‹çš„å¤æ‚åº¦é«˜ï¼Œè°ƒè¯•æ›´å›°éš¾ã€‚</p><p>Java å¤šçº¿ç¨‹ç¼–ç¨‹çš„ç‰¹ç‚¹åˆåœ¨äºï¼š</p><ul><li>å¤šçº¿ç¨‹æ¨¡å‹æ˜¯ Java ç¨‹åºæœ€åŸºæœ¬çš„å¹¶å‘æ¨¡å‹ï¼›</li><li>åç»­è¯»å†™ç½‘ç»œã€æ•°æ®åº“ã€Web å¼€å‘ç­‰éƒ½ä¾èµ– Java å¤šçº¿ç¨‹æ¨¡å‹ã€‚</li></ul><h2 id="åˆ›å»ºå¤šçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºå¤šçº¿ç¨‹" aria-hidden="true">#</a> åˆ›å»ºå¤šçº¿ç¨‹</h2><p>Java è¯­è¨€å†…ç½®äº†å¤šçº¿ç¨‹æ”¯æŒã€‚å½“ Java ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯å¯åŠ¨äº†ä¸€ä¸ª JVM è¿›ç¨‹ï¼Œç„¶åï¼ŒJVM å¯åŠ¨ä¸»çº¿ç¨‹æ¥æ‰§è¡Œ<code>main()</code>æ–¹æ³•ã€‚åœ¨<code>main()</code>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆå¯ä»¥å¯åŠ¨å…¶ä»–çº¿ç¨‹ã€‚</p><h3 id="thread-ç±»åˆ›å»ºçº¿ç¨‹ç±»" tabindex="-1"><a class="header-anchor" href="#thread-ç±»åˆ›å»ºçº¿ç¨‹ç±»" aria-hidden="true">#</a> Thread ç±»åˆ›å»ºçº¿ç¨‹ç±»</h3><p>é€šè¿‡ç»§æ‰¿<code>Thread</code>ç±»æ¥åˆ›å»ºå¹¶å¯åŠ¨å¤šçº¿ç¨‹çš„æ­¥éª¤å¦‚ä¸‹ã€‚</p><ol><li>å®šä¹‰<code>Thread</code>ç±»çš„å­ç±»ï¼Œå¹¶é‡å†™è¯¥ç±»çš„<code>run()</code>æ–¹æ³•ï¼Œè¯¥<code>run()</code>æ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹éœ€è¦å®Œæˆçš„ä»»åŠ¡ã€‚å› æ­¤æŠŠ<code>run()</code>æ–¹æ³•ç§°ä¸ºçº¿ç¨‹æ‰§è¡Œä½“ã€‚</li><li>åˆ›å»º<code>Thread</code>å­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ã€‚</li><li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„<code>start()</code>æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FirstThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è°ƒç”¨Threadçš„currentThread()æ–¹æ³•è·å–å½“å‰çº¿ç¨‹</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºå¹¶å¯åŠ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹</span>
        <span class="token keyword">new</span> <span class="token class-name">FirstThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»ºå¹¶å¯åŠ¨ç¬¬äºŒä¸ªçº¿ç¨‹</span>
        <span class="token keyword">new</span> <span class="token class-name">FirstThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡å†™run()æ–¹æ³•ï¼Œrun()æ–¹æ³•çš„æ–¹æ³•ä½“å°±æ˜¯çº¿ç¨‹æ‰§è¡Œä½“</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å½“çº¿ç¨‹ç±»ç»§æ‰¿Threadç±»æ—¶ï¼Œç›´æ¥ä½¿ç”¨thiså³å¯è·å–å½“å‰çº¿ç¨‹</span>
      <span class="token comment">// Threadå¯¹è±¡çš„getName()è¿”å›å½“å‰çº¿ç¨‹çš„åå­—</span>
      <span class="token comment">// å› æ­¤å¯ä»¥ç›´æ¥è°ƒç”¨getName()æ–¹æ³•è¿”å›å½“å‰çº¿ç¨‹çš„åå­—</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¨‹åºæ˜¾å¼åˆ›å»ºäº† 2 ä¸ªå­çº¿ç¨‹å’Œä¸»çº¿ç¨‹ï¼Œ<code>main()</code>æ–¹æ³•çš„æ–¹æ³•ä½“ä»£è¡¨ä¸»çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208201138582.png" alt="image-20220820104824187"></p><p>ç¨‹åºç”¨åˆ°çš„çº¿ç¨‹ä¸¤ä¸ªæ–¹æ³•ã€‚</p><p><code>Thread.currentThread()</code>ï¼š<code>currentThread()</code>æ˜¯ Thread ç±»çš„é™æ€æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ€»æ˜¯è¿”å›å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ã€‚</p><p><code>getName()</code>ï¼šè¯¥æ–¹æ³•æ˜¯ Thread ç±»çš„å®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹åå­—ã€‚</p><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p>ç¨‹åºå¯ä»¥é€šè¿‡<code>setName(String name)</code>æ–¹æ³•ä¸ºçº¿ç¨‹è®¾ç½®åå­—ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>getName()</code>æ–¹æ³•è¿”å›æŒ‡å®šçº¿ç¨‹çš„åå­—ã€‚</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹çš„åå­—ä¸º<code>main</code>ï¼Œç”¨æˆ·å¯åŠ¨çš„å¤šä¸ªçº¿ç¨‹çš„åå­—ä¾æ¬¡ä¸º<code>Thread-0</code>ã€<code>Thread-1</code>ã€<code>Thread-2</code>ã€â€¦ã€<code>Thread-n</code>ç­‰ã€‚</p></div><p>é€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ª<code>Thread</code>å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ƒçš„<code>start()</code>æ–¹æ³•å¯åŠ¨å¤šçº¿ç¨‹ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯åŠ¨æ–°çº¿ç¨‹</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯è¿™ä¸ªçº¿ç¨‹å¯åŠ¨åå®é™…ä¸Šä»€ä¹ˆä¹Ÿä¸åšå°±ç«‹åˆ»ç»“æŸäº†ã€‚æˆ‘ä»¬å¸Œæœ›æ–°çº¿ç¨‹èƒ½æ‰§è¡ŒæŒ‡å®šçš„ä»£ç ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p><p>æ–¹æ³•ä¸€ï¼šä»<code>Thread</code>æ´¾ç”Ÿä¸€ä¸ªè‡ªå®šä¹‰ç±»ï¼Œç„¶åè¦†å†™<code>run()</code>æ–¹æ³•ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯åŠ¨æ–°çº¿ç¨‹</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start new thread!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šè¿°ä»£ç ï¼Œæ³¨æ„åˆ°<code>start()</code>æ–¹æ³•ä¼šåœ¨å†…éƒ¨è‡ªåŠ¨è°ƒç”¨å®ä¾‹çš„<code>run()</code>æ–¹æ³•ã€‚</p><p>æ–¹æ³•äºŒï¼šåˆ›å»º<code>Thread</code>å®ä¾‹æ—¶ï¼Œä¼ å…¥ä¸€ä¸ª<code>Runnable</code>å®ä¾‹ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯åŠ¨æ–°çº¿ç¨‹</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start new thread!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ç”¨ Java8 å¼•å…¥çš„ lambda è¯­æ³•è¿›ä¸€æ­¥ç®€å†™ä¸ºï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start new thread!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯åŠ¨æ–°çº¿ç¨‹</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨çº¿ç¨‹æ‰§è¡Œçš„æ‰“å°è¯­å¥ï¼Œå’Œç›´æ¥åœ¨<code>main()</code>æ–¹æ³•æ‰§è¡Œçš„åŒºåˆ«ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main start...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thread run...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thread end.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main end...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>main</code>çº¿ç¨‹æ‰§è¡Œçš„ä»£ç æœ‰ 4 è¡Œï¼Œé¦–å…ˆæ‰“å°<code>main start</code>ï¼Œç„¶ååˆ›å»º<code>Thread</code>å¯¹è±¡ï¼Œç´§æ¥ç€è°ƒç”¨<code>start()</code>å¯åŠ¨æ–°çº¿ç¨‹ã€‚å½“<code>start()</code>æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼ŒJVM å°±åˆ›å»ºäº†ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œé€šè¿‡å®ä¾‹å˜é‡<code>t</code>æ¥è¡¨ç¤ºè¿™ä¸ªæ–°çº¿ç¨‹å¯¹è±¡ï¼Œå¹¶å¼€å§‹æ‰§è¡Œã€‚</p><p>æ¥ç€ï¼Œ<code>main</code>çº¿ç¨‹ç»§ç»­æ‰§è¡Œæ‰“å°<code>main end</code>è¯­å¥ï¼Œè€Œ<code>t</code>çº¿ç¨‹åœ¨<code>main</code>çº¿ç¨‹æ‰§è¡Œçš„åŒæ—¶ä¼šå¹¶å‘æ‰§è¡Œï¼Œæ‰“å°<code>thread run</code>å’Œ<code>thread end</code>è¯­å¥ã€‚</p><p>å½“<code>run()</code>æ–¹æ³•ç»“æŸæ—¶ï¼Œæ–°çº¿ç¨‹å°±ç»“æŸäº†ã€‚è€Œ<code>main()</code>æ–¹æ³•ç»“æŸæ—¶ï¼Œä¸»çº¿ç¨‹ä¹Ÿç»“æŸäº†ã€‚</p><p>çº¿ç¨‹çš„æ‰§è¡Œé¡ºåºï¼š</p><ol><li><code>main</code>çº¿ç¨‹è‚¯å®šæ˜¯å…ˆæ‰“å°<code>main start</code>ï¼Œå†æ‰“å°<code>main end</code>ï¼›</li><li><code>t</code>çº¿ç¨‹è‚¯å®šæ˜¯å…ˆæ‰“å°<code>thread run</code>ï¼Œå†æ‰“å°<code>thread end</code>ã€‚</li></ol><p>ä½†æ˜¯ï¼Œé™¤äº†å¯ä»¥è‚¯å®šï¼Œ<code>main start</code>ä¼šå…ˆæ‰“å°å¤–ï¼Œ<code>main end</code>æ‰“å°åœ¨<code>thread run</code>ä¹‹å‰ã€<code>thread end</code>ä¹‹åæˆ–è€…ä¹‹é—´ï¼Œéƒ½æ— æ³•ç¡®å®šã€‚å› ä¸ºä»<code>t</code>çº¿ç¨‹å¼€å§‹è¿è¡Œä»¥åï¼Œä¸¤ä¸ªçº¿ç¨‹å°±å¼€å§‹åŒæ—¶è¿è¡Œäº†ï¼Œå¹¶ä¸”ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œç¨‹åºæœ¬èº«æ— æ³•ç¡®å®šçº¿ç¨‹çš„è°ƒåº¦é¡ºåºã€‚</p><p>å¯ä»¥åœ¨çº¿ç¨‹ä¸­è°ƒç”¨<code>Thread.sleep()</code>ï¼Œå¼ºè¿«å½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main start...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thread run...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;thread end.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;main end...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>sleep()</code>ä¼ å…¥çš„å‚æ•°æ˜¯æ¯«ç§’ã€‚è°ƒæ•´æš‚åœæ—¶é—´çš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>main</code>çº¿ç¨‹å’Œ<code>t</code>çº¿ç¨‹æ‰§è¡Œçš„å…ˆåé¡ºåºã€‚</p><p>è¦ç‰¹åˆ«æ³¨æ„ï¼šç›´æ¥è°ƒç”¨<code>Thread</code>å®ä¾‹çš„<code>run()</code>æ–¹æ³•æ˜¯æ— æ•ˆçš„ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›´æ¥è°ƒç”¨<code>run()</code>æ–¹æ³•ï¼Œç›¸å½“äºè°ƒç”¨äº†ä¸€ä¸ªæ™®é€šçš„ Java æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹å¹¶æ²¡æœ‰ä»»ä½•æ”¹å˜ï¼Œä¹Ÿä¸ä¼šå¯åŠ¨æ–°çº¿ç¨‹ã€‚ä¸Šè¿°ä»£ç å®é™…ä¸Šæ˜¯åœ¨<code>main()</code>æ–¹æ³•å†…éƒ¨åˆè°ƒç”¨äº†<code>run()</code>æ–¹æ³•ï¼Œæ‰“å°<code>hello</code>è¯­å¥æ˜¯åœ¨<code>main</code>çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œæ²¡æœ‰ä»»ä½•æ–°çº¿ç¨‹è¢«åˆ›å»ºã€‚</p><p>å¿…é¡»è°ƒç”¨<code>Thread</code>å®ä¾‹çš„<code>start()</code>æ–¹æ³•æ‰èƒ½å¯åŠ¨æ–°çº¿ç¨‹ï¼ŒæŸ¥çœ‹<code>Thread</code>ç±»çš„æºä»£ç ï¼Œä¼šçœ‹åˆ°<code>start()</code>æ–¹æ³•å†…éƒ¨è°ƒç”¨äº†ä¸€ä¸ª<code>private native void start0()</code>æ–¹æ³•ï¼Œ<code>native</code>ä¿®é¥°ç¬¦è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æ˜¯ç”± JVM è™šæ‹Ÿæœºå†…éƒ¨çš„ C ä»£ç å®ç°çš„ï¼Œä¸æ˜¯ç”± Java ä»£ç å®ç°çš„ã€‚</p><h3 id="å®ç°-runnable-æ¥å£åˆ›å»ºçº¿ç¨‹ç±»" tabindex="-1"><a class="header-anchor" href="#å®ç°-runnable-æ¥å£åˆ›å»ºçº¿ç¨‹ç±»" aria-hidden="true">#</a> å®ç° Runnable æ¥å£åˆ›å»ºçº¿ç¨‹ç±»</h3><p>å®ç°<code>Runnable</code>æ¥å£æ¥åˆ›å»ºå¹¶å¯åŠ¨å¤šçº¿ç¨‹çš„æ­¥éª¤å¦‚ä¸‹ã€‚</p><ol><li>å®šä¹‰<code>Runnable</code>æ¥å£çš„å®ç°ç±»ï¼Œå¹¶é‡å†™è¯¥æ¥å£çš„<code>run()</code>æ–¹æ³•ï¼Œè¯¥<code>run()</code>æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚</li><li>åˆ›å»º<code>Runnable</code>å®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä»¥æ­¤å®ä¾‹ä½œä¸º<code>Thread</code>çš„<code>target</code>æ¥åˆ›å»º<code>Thread</code>å¯¹è±¡ï¼Œè¯¥<code>Thread</code>å¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ã€‚</li><li>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„<code>start()</code>æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</li></ol><p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecondThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// åˆ›å»ºRunnableå®ç°ç±»å¯¹è±¡</span>
        <span class="token class-name">SecondThread</span> st <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecondThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// â‘ </span>
        <span class="token comment">// é€šè¿‡new Thread(target , name)æ–¹æ³•åˆ›å»ºæ–°çº¿ç¨‹</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯ä»¥ä¸ºè¯¥Threadå¯¹è±¡æŒ‡å®šåå­—</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> <span class="token string">&quot;æ–°çº¿ç¨‹1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>st<span class="token punctuation">,</span> <span class="token string">&quot;æ–°çº¿ç¨‹2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// run()æ–¹æ³•åŒæ ·æ˜¯çº¿ç¨‹æ‰§è¡Œä½“</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å½“çº¿ç¨‹ç±»å®ç°Runnableæ¥å£æ—¶</span>
      <span class="token comment">// å¦‚æœæƒ³è·å–å½“å‰çº¿ç¨‹ï¼Œåªèƒ½ç”¨Thread.currentThread()æ–¹æ³•</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p><code>Runnable</code>å¯¹è±¡ä»…ä»…ä½œä¸º<code>Thread</code>å¯¹è±¡çš„<code>target</code>ï¼Œ<code>Runnable</code>å®ç°ç±»é‡ŒåŒ…å«çš„<code>run()</code>æ–¹æ³•ä»…ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ã€‚</p><p>è€Œå®é™…çš„çº¿ç¨‹å¯¹è±¡ä¾ç„¶æ˜¯<code>Thread</code>å®ä¾‹ï¼Œåªæ˜¯è¯¥<code>Thread</code>çº¿ç¨‹è´Ÿè´£æ‰§è¡Œå…¶<code>target</code>çš„<code>run()</code>æ–¹æ³•ã€‚</p><p>é€šè¿‡å®ç°<code>Runnable</code>æ¥å£æ¥è·å¾—å½“å‰çº¿ç¨‹å¯¹è±¡ï¼Œåˆ™å¿…é¡»ä½¿ç”¨<code>Thread.currentThread()</code>æ–¹æ³•ã€‚</p></div><p>ç¨‹åºæ‰“å°å‡ºçš„ç»“æœä¸­ï¼Œä¸‰ä¸ªå­çº¿ç¨‹çš„<code>i</code>å˜é‡çš„å€¼æ˜¯è¿ç»­çš„ï¼ˆä½†æœ‰é‡å¤ï¼‰ï¼Œä¹Ÿå°±æ˜¯é‡‡ç”¨<code>Runnable</code>æ¥å£çš„æ–¹å¼åˆ›å»ºçš„å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«çº¿ç¨‹ç±»çš„å®ä¾‹å±æ€§ã€‚è¿™æ˜¯å› ä¸ºåœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œç¨‹åºæ‰€åˆ›å»ºçš„<code>Runnable</code>å¯¹è±¡åªæ˜¯çº¿ç¨‹çš„<code>target</code>ï¼Œè€Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ª<code>target</code>ï¼Œæ‰€ä»¥å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ªçº¿ç¨‹ç±»ï¼ˆå®é™…ä¸Šåº”è¯¥æ˜¯çº¿ç¨‹çš„<code>target</code>ç±»ï¼‰çš„å®ä¾‹å±æ€§ã€‚</p><h3 id="ä½¿ç”¨-callable-å’Œ-future-åˆ›å»ºçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-callable-å’Œ-future-åˆ›å»ºçº¿ç¨‹" aria-hidden="true">#</a> ä½¿ç”¨ Callable å’Œ Future åˆ›å»ºçº¿ç¨‹</h3><p>ä» Java 5 å¼€å§‹ï¼ŒJava æä¾›äº†<code>Callable</code>æ¥å£ï¼Œè¯¥æ¥å£æä¾›äº†ä¸€ä¸ª<code>call()</code>æ–¹æ³•å¯ä»¥ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œä½†<code>call()</code>æ–¹æ³•æ¯”<code>run()</code>æ–¹æ³•åŠŸèƒ½æ›´å¼ºå¤§ã€‚</p><ol><li><code>call()</code>æ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼ã€‚</li><li><code>call()</code>æ–¹æ³•å¯ä»¥å£°æ˜æŠ›å‡ºå¼‚å¸¸ã€‚</li></ol><p><code>Callable</code>æ¥å£æ˜¯ Java5 æ–°å¢çš„æ¥å£ï¼Œè€Œä¸”å®ƒä¸æ˜¯<code>Runnable</code>æ¥å£çš„å­æ¥å£ï¼Œæ‰€ä»¥<code>Callable</code>å¯¹è±¡ä¸èƒ½ç›´æ¥ä½œä¸º<code>Thread</code>çš„<code>target</code>ã€‚Java 5 æä¾›äº†<code>Future</code>æ¥å£æ¥ä»£è¡¨<code>Callable</code>æ¥å£é‡Œ<code>call()</code>æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¹¶ä¸º<code>Future</code>æ¥å£æä¾›äº†ä¸€ä¸ª<code>FutureTask</code>å®ç°ç±»ï¼Œè¯¥å®ç°ç±»å®ç°äº†<code>Future</code>æ¥å£ï¼Œå¹¶å®ç°äº†<code>Runnable</code>æ¥å£â€”â€”å¯ä»¥ä½œä¸º<code>Thread</code>ç±»çš„<code>target</code>ã€‚</p><p>åœ¨<code>Future</code>æ¥å£é‡Œå®šä¹‰äº†å¦‚ä¸‹å‡ ä¸ªå…¬å…±æ–¹æ³•æ¥æ§åˆ¶å®ƒå…³è”çš„<code>Callable</code>ä»»åŠ¡ã€‚</p><ol><li><code>boolean cancel(boolean mayInterruptIfRunning)</code>ï¼šè¯•å›¾å–æ¶ˆè¯¥<code>Future</code>é‡Œå…³è”çš„<code>Callable</code>ä»»åŠ¡ã€‚</li><li><code>V get()</code>ï¼šè¿”å›<code>Callable</code>ä»»åŠ¡é‡Œ<code>call()</code>æ–¹æ³•çš„è¿”å›å€¼ã€‚è°ƒç”¨è¯¥æ–¹æ³•å°†å¯¼è‡´ç¨‹åºé˜»å¡ï¼Œå¿…é¡»ç­‰åˆ°å­çº¿ç¨‹ç»“æŸåæ‰ä¼šå¾—åˆ°è¿”å›å€¼ã€‚</li><li><code>V get(long timeout, TimeUnit unit)</code>ï¼šè¿”å›<code>Callable</code>ä»»åŠ¡é‡Œ<code>call()</code>æ–¹æ³•çš„è¿”å›å€¼ã€‚è¯¥æ–¹æ³•è®©ç¨‹åºæœ€å¤šé˜»å¡<code>timeout</code>å’Œ<code>unit</code>æŒ‡å®šçš„æ—¶é—´ï¼Œå¦‚æœç»è¿‡æŒ‡å®šæ—¶é—´å<code>Callable</code>ä»»åŠ¡ä¾ç„¶æ²¡æœ‰è¿”å›å€¼ï¼Œå°†ä¼šæŠ›å‡º<code>TimeoutException</code>å¼‚å¸¸ã€‚</li><li><code>boolean isCancelled()</code>ï¼šå¦‚æœåœ¨<code>Callable</code>ä»»åŠ¡æ­£å¸¸å®Œæˆå‰è¢«å–æ¶ˆï¼Œåˆ™è¿”å›<code>true</code>ã€‚</li><li><code>boolean isDone()</code>ï¼šå¦‚æœ<code>Callable</code>ä»»åŠ¡å·²å®Œæˆï¼Œåˆ™è¿”å›<code>true</code>ã€‚</li></ol><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p><code>Callable</code>æ¥å£æœ‰æ³›å‹é™åˆ¶ï¼Œ<code>Callable</code>æ¥å£é‡Œçš„æ³›å‹å½¢å‚ç±»å‹ä¸<code>call()</code>æ–¹æ³•è¿”å›å€¼ç±»å‹ç›¸åŒã€‚</p></div><p>åˆ›å»ºå¹¶å¯åŠ¨æœ‰è¿”å›å€¼çš„çº¿ç¨‹çš„æ­¥éª¤å¦‚ä¸‹ã€‚</p><ol><li>åˆ›å»º<code>Callable</code>æ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç°<code>call()</code>æ–¹æ³•ï¼Œè¯¥<code>call()</code>æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œä¸”è¯¥<code>call()</code>æ–¹æ³•æœ‰è¿”å›å€¼ã€‚</li><li>åˆ›å»º<code>Callable</code>å®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨<code>FutureTask</code>ç±»æ¥åŒ…è£…<code>Callable</code>å¯¹è±¡ï¼Œè¯¥<code>FutureTask</code>å¯¹è±¡å°è£…äº†è¯¥<code>Callable</code>å¯¹è±¡çš„<code>call()</code>æ–¹æ³•çš„è¿”å›å€¼ã€‚</li><li>ä½¿ç”¨<code>FutureTask</code>å¯¹è±¡ä½œä¸º<code>Thread</code>å¯¹è±¡çš„<code>target</code>åˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚</li><li>è°ƒç”¨<code>FutureTask</code>å¯¹è±¡çš„<code>get()</code>æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ã€‚</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThirdThread</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºCallableå¯¹è±¡</span>
    <span class="token class-name">ThirdThread</span> rt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThirdThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä½¿ç”¨FutureTaskæ¥åŒ…è£…Callableå¯¹è±¡</span>
    <span class="token class-name">FutureTask</span> task <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token punctuation">(</span>rt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çš„å¾ªç¯å˜é‡içš„å€¼ï¼š&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å®è´¨è¿˜æ˜¯ä»¥Callableå¯¹è±¡æ¥åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token string">&quot;æœ‰è¿”å›å€¼çš„çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// è·å–çº¿ç¨‹è¿”å›å€¼</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å­çº¿ç¨‹çš„è¿”å›å€¼ï¼š&quot;</span> <span class="token operator">+</span> task<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å®ç°call()æ–¹æ³•ï¼Œä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“</span>
  <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çš„å¾ªç¯å˜é‡içš„å€¼ï¼š&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// call()æ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼</span>
    <span class="token keyword">return</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”" aria-hidden="true">#</a> åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”</h3><p>å®ç°<code>Runnable</code>æ¥å£ä¸å®ç°<code>Callable</code>æ¥å£çš„æ–¹å¼åŸºæœ¬ç›¸åŒï¼Œå› æ­¤å¯ä»¥å°†å®ç°<code>Runnable</code>æ¥å£å’Œå®ç°<code>Callable</code>æ¥å£å½’ä¸ºä¸€ç§æ–¹å¼ã€‚è¿™ç§æ–¹å¼ä¸ç»§æ‰¿<code>Thread</code>æ–¹å¼ä¹‹é—´çš„ä¸»è¦å·®åˆ«å¦‚ä¸‹ã€‚</p><p>é‡‡ç”¨å®ç°<code>Runnable</code>ã€<code>Callable</code>æ¥å£çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ï¼š</p><ul><li>çº¿ç¨‹ç±»åªæ˜¯å®ç°äº†<code>Runnable</code>æ¥å£æˆ–<code>Callable</code>æ¥å£ï¼Œè¿˜å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ã€‚</li><li>åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«åŒä¸€ä¸ª<code>target</code>å¯¹è±¡ï¼Œæ‰€ä»¥éå¸¸é€‚åˆå¤šä¸ªç›¸åŒçº¿ç¨‹æ¥å¤„ç†åŒä¸€ä»½èµ„æºçš„æƒ…å†µï¼Œä»è€Œå¯ä»¥å°† CPUã€ä»£ç å’Œæ•°æ®åˆ†å¼€ï¼Œå½¢æˆæ¸…æ™°çš„æ¨¡å‹ï¼Œè¾ƒå¥½åœ°ä½“ç°äº†é¢å‘å¯¹è±¡çš„æ€æƒ³ã€‚</li><li>åŠ£åŠ¿æ˜¯ï¼šç¼–ç¨‹ç¨ç¨å¤æ‚ï¼Œå¦‚æœéœ€è¦è®¿é—®å½“å‰çº¿ç¨‹ï¼Œåˆ™å¿…é¡»ä½¿ç”¨<code>Thread.currentThread()</code>æ–¹æ³•ã€‚</li></ul><p>é‡‡ç”¨ç»§æ‰¿<code>Thread</code>ç±»çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ï¼š</p><ul><li>åŠ£åŠ¿æ˜¯ï¼šå› ä¸ºçº¿ç¨‹ç±»å·²ç»ç»§æ‰¿äº†<code>Thread</code>ç±»ï¼Œæ‰€ä»¥ä¸èƒ½å†ç»§æ‰¿å…¶ä»–çˆ¶ç±»ã€‚</li><li>ä¼˜åŠ¿æ˜¯ï¼šç¼–å†™ç®€å•ï¼Œå¦‚æœéœ€è¦è®¿é—®å½“å‰çº¿ç¨‹ï¼Œåˆ™æ— é¡»ä½¿ç”¨<code>Thread.currentThread()</code>æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨<code>this</code>å³å¯è·å¾—å½“å‰çº¿ç¨‹ã€‚</li></ul><p>ä¸€èˆ¬æ¨èé‡‡ç”¨å®ç°<code>Runnable</code>æ¥å£ã€<code>Callable</code>æ¥å£çš„æ–¹å¼æ¥åˆ›å»ºå¤šçº¿ç¨‹ã€‚</p><h2 id="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>åœ¨çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå®ƒè¦ç»è¿‡æ–°å»ºï¼ˆ<code>New</code>ï¼‰ã€å°±ç»ªï¼ˆ<code>Runnable</code>ï¼‰ã€è¿è¡Œï¼ˆ<code>Running</code>ï¼‰ã€é˜»å¡ï¼ˆ<code>Blocked</code>ï¼‰å’Œæ­»äº¡ï¼ˆ<code>Dead</code>ï¼‰ 5 ç§çŠ¶æ€ã€‚</p><p>ç”¨ä¸€ä¸ªçŠ¶æ€è½¬ç§»å›¾è¡¨ç¤ºå¦‚ä¸‹ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚     New     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚â”‚  Running    â”‚ â”‚   Blocked   â”‚â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
 â”‚   Waiting   â”‚ â”‚Timed Waitingâ”‚
â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
 â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€
                â”‚
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Terminated  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“çº¿ç¨‹å¯åŠ¨åï¼Œå®ƒå¯ä»¥åœ¨ <code>Running</code>ã€<code>Blocked</code>ã€<code>Waiting</code> å’Œ <code>Timed Waiting</code> è¿™å‡ ä¸ªçŠ¶æ€ä¹‹é—´åˆ‡æ¢ï¼Œç›´åˆ°æœ€åå˜æˆ <code>Terminated</code> çŠ¶æ€ï¼Œçº¿ç¨‹ç»ˆæ­¢ã€‚</p><h3 id="æ–°å»ºå’Œå°±ç»ªçŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#æ–°å»ºå’Œå°±ç»ªçŠ¶æ€" aria-hidden="true">#</a> æ–°å»ºå’Œå°±ç»ªçŠ¶æ€</h3><p>å½“ç¨‹åºä½¿ç”¨<code>new</code>å…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ä¹‹åï¼Œè¯¥çº¿ç¨‹å°±å¤„äºæ–°å»ºçŠ¶æ€ï¼Œæ­¤æ—¶å®ƒå’Œå…¶ä»–çš„ Java å¯¹è±¡ä¸€æ ·ï¼Œä»…ä»…ç”± Java è™šæ‹Ÿæœºä¸ºå…¶åˆ†é…å†…å­˜ï¼Œå¹¶åˆå§‹åŒ–å…¶æˆå‘˜å˜é‡çš„å€¼ã€‚</p><p>å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº†<code>start()</code>æ–¹æ³•ä¹‹åï¼Œè¯¥çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ï¼ŒJava è™šæ‹Ÿæœºä¼šä¸ºå…¶åˆ›å»ºæ–¹æ³•è°ƒç”¨æ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼Œå¤„äºè¿™ä¸ªçŠ¶æ€ä¸­çš„çº¿ç¨‹å¹¶æ²¡æœ‰å¼€å§‹è¿è¡Œï¼Œåªæ˜¯è¡¨ç¤ºè¯¥çº¿ç¨‹å¯ä»¥è¿è¡Œäº†ã€‚å¯ä»¥é€šè¿‡å†æ¬¡è¿è¡Œ<code>FirstThread</code>æˆ–<code>SecondThread</code>æ¥è¯æ˜ã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208201713228.png" alt="image-20220820171342935"></p><div class="custom-container warning"><p class="custom-container-title">æ³¨æ„</p><p>åªèƒ½å¯¹å¤„äºæ–°å»ºçŠ¶æ€çš„çº¿ç¨‹è°ƒç”¨<code>start()</code>æ–¹æ³•ï¼Œå¦åˆ™å°†å¼•å‘<code>IllegalThreadStateException</code>å¼‚å¸¸ã€‚</p></div><h3 id="è¿è¡Œå’Œé˜»å¡çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#è¿è¡Œå’Œé˜»å¡çŠ¶æ€" aria-hidden="true">#</a> è¿è¡Œå’Œé˜»å¡çŠ¶æ€</h3><p>å½“å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å¾—äº† CPU å¼€å§‹æ‰§è¡Œ<code>run()</code>æ–¹æ³•çš„çº¿ç¨‹æ‰§è¡Œä½“æ—¶ï¼Œè¯¥çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœè®¡ç®—æœºåªæœ‰ä¸€ä¸ª CPUï¼Œé‚£ä¹ˆåœ¨ä»»ä½•æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å½“ç„¶ï¼Œåœ¨ä¸€ä¸ªå¤šå¤„ç†å™¨çš„æœºå™¨ä¸Šï¼Œå°†ä¼šæœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œï¼ˆæ³¨æ„æ˜¯å¹¶è¡Œï¼šparallelï¼‰æ‰§è¡Œï¼›å½“çº¿ç¨‹æ•°å¤§äºå¤„ç†å™¨æ•°æ—¶ï¼Œä¾ç„¶ä¼šå­˜åœ¨å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ä¸ª CPU ä¸Šè½®æ¢çš„ç°è±¡ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹å¼€å§‹è¿è¡Œåï¼Œå®ƒä¸å¯èƒ½ä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ï¼ˆé™¤éå®ƒçš„çº¿ç¨‹æ‰§è¡Œä½“è¶³å¤ŸçŸ­ï¼Œç¬é—´å°±æ‰§è¡Œç»“æŸäº†ï¼‰ï¼Œçº¿ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦è¢«ä¸­æ–­ï¼Œç›®çš„æ˜¯ä½¿å…¶ä»–çº¿ç¨‹è·å¾—æ‰§è¡Œçš„æœºä¼šï¼Œçº¿ç¨‹è°ƒåº¦çš„ç»†èŠ‚å–å†³äºåº•å±‚å¹³å°æ‰€é‡‡ç”¨çš„ç­–ç•¥ã€‚</p><p>å¯¹äºé‡‡ç”¨æŠ¢å å¼ç­–ç•¥çš„ç³»ç»Ÿè€Œè¨€ï¼Œç³»ç»Ÿä¼šç»™æ¯ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹ä¸€ä¸ªå°æ—¶é—´æ®µæ¥å¤„ç†ä»»åŠ¡ï¼›å½“è¯¥æ—¶é—´æ®µç”¨å®Œåï¼Œç³»ç»Ÿå°±ä¼šå‰¥å¤ºè¯¥çº¿ç¨‹æ‰€å ç”¨çš„èµ„æºï¼Œè®©å…¶ä»–çº¿ç¨‹è·å¾—æ‰§è¡Œçš„æœºä¼šã€‚åœ¨é€‰æ‹©ä¸‹ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œç³»ç»Ÿä¼šè€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</p><p>å½“å‘ç”Ÿå¦‚ä¸‹æƒ…å†µæ—¶ï¼Œçº¿ç¨‹å°†ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><ul><li>çº¿ç¨‹è°ƒç”¨<code>sleep()</code>æ–¹æ³•ä¸»åŠ¨æ”¾å¼ƒæ‰€å ç”¨çš„å¤„ç†å™¨èµ„æºã€‚</li><li>çº¿ç¨‹è°ƒç”¨äº†ä¸€ä¸ªé˜»å¡å¼<code>IO</code>æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•è¿”å›ä¹‹å‰ï¼Œè¯¥çº¿ç¨‹è¢«é˜»å¡ã€‚</li><li>çº¿ç¨‹è¯•å›¾è·å¾—ä¸€ä¸ªåŒæ­¥ç›‘è§†å™¨ï¼Œä½†è¯¥åŒæ­¥ç›‘è§†å™¨æ­£è¢«å…¶ä»–çº¿ç¨‹æ‰€æŒæœ‰ã€‚å…³äºåŒæ­¥ç›‘è§†å™¨çš„çŸ¥è¯†ã€åé¢å°†æœ‰æ›´æ·±å…¥çš„ä»‹ç»ã€‚</li><li>çº¿ç¨‹åœ¨ç­‰å¾…æŸä¸ªé€šçŸ¥ï¼ˆnotifyï¼‰ã€‚</li><li>ç¨‹åºè°ƒç”¨äº†çº¿ç¨‹çš„<code>suspend()</code>æ–¹æ³•å°†è¯¥çº¿ç¨‹æŒ‚èµ·ã€‚ä½†è¿™ä¸ªæ–¹æ³•å®¹æ˜“å¯¼è‡´æ­»é”ï¼Œæ‰€ä»¥åº”è¯¥å°½é‡é¿å…ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</li></ul><p>å½“å‘ç”Ÿå¦‚ä¸‹ç‰¹å®šçš„æƒ…å†µæ—¶å¯ä»¥è§£é™¤ä¸Šé¢çš„é˜»å¡ï¼Œè®©è¯¥çº¿ç¨‹é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</p><ul><li>è°ƒç”¨<code>sleep()</code>æ–¹æ³•çš„çº¿ç¨‹ç»è¿‡äº†æŒ‡å®šæ—¶é—´ã€‚</li><li>çº¿ç¨‹è°ƒç”¨çš„é˜»å¡å¼<code>IO</code>æ–¹æ³•å·²ç»è¿”å›ã€‚</li><li>çº¿ç¨‹æˆåŠŸåœ°è·å¾—äº†è¯•å›¾å–å¾—çš„åŒæ­¥ç›‘è§†å™¨ã€‚</li><li>çº¿ç¨‹æ­£åœ¨ç­‰å¾…æŸä¸ªé€šçŸ¥æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å‘å‡ºäº†ä¸€ä¸ªé€šçŸ¥ã€‚</li><li>å¤„äºæŒ‚èµ·çŠ¶æ€çš„çº¿ç¨‹è¢«è°ƒç”¨äº†<code>resume()</code>æ¢å¤æ–¹æ³•ã€‚</li></ul><p>çº¿ç¨‹çŠ¶æ€è½¬æ¢å›¾ã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208201853226.jpeg" alt="epub_681336_2144"></p><p>çº¿ç¨‹ä»é˜»å¡çŠ¶æ€åªèƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ— æ³•ç›´æ¥è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚è€Œå°±ç»ªå’Œè¿è¡ŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢é€šå¸¸ä¸å—ç¨‹åºæ§åˆ¶ï¼Œè€Œæ˜¯ç”±ç³»ç»Ÿçº¿ç¨‹è°ƒåº¦æ‰€å†³å®šï¼Œå½“å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å¾—å¤„ç†å™¨èµ„æºæ—¶ï¼Œè¯¥çº¿ç¨‹è¿›å…¥è¿è¡ŒçŠ¶æ€ï¼›å½“å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å¤±å»å¤„ç†å™¨èµ„æºæ—¶ï¼Œè¯¥çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</p><p>ç›´æ¥è°ƒç”¨<code>yield()</code>æ–¹æ³•ä¹Ÿå¯ä»¥è®©è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚</p><h3 id="çº¿ç¨‹æ­»äº¡" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹æ­»äº¡" aria-hidden="true">#</a> çº¿ç¨‹æ­»äº¡</h3><p>çº¿ç¨‹ä¼šä»¥å¦‚ä¸‹ 3 ç§æ–¹å¼ç»“æŸï¼Œç»“æŸåå°±å¤„äºæ­»äº¡çŠ¶æ€ã€‚</p><ul><li><code>run()</code>æˆ–<code>call()</code>æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œçº¿ç¨‹æ­£å¸¸ç»“æŸã€‚</li><li>çº¿ç¨‹æŠ›å‡ºä¸€ä¸ªæœªæ•è·çš„<code>Exception</code>æˆ–<code>Error</code>ã€‚</li><li>ç›´æ¥è°ƒç”¨è¯¥çº¿ç¨‹çš„<code>stop()</code>æ–¹æ³•æ¥ç»“æŸè¯¥çº¿ç¨‹â€”â€”è¯¥æ–¹æ³•å®¹æ˜“å¯¼è‡´æ­»é”ï¼Œé€šå¸¸ä¸æ¨èä½¿ç”¨ã€‚</li></ul><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p>å½“ä¸»çº¿ç¨‹ç»“æŸæ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¸å—ä»»ä½•å½±å“ï¼Œå¹¶ä¸ä¼šéšä¹‹ç»“æŸã€‚ä¸€æ—¦å­çº¿ç¨‹å¯åŠ¨èµ·æ¥åï¼Œå®ƒå°±æ‹¥æœ‰å’Œä¸»çº¿ç¨‹ç›¸åŒçš„åœ°ä½ï¼Œå®ƒä¸ä¼šå—ä¸»çº¿ç¨‹çš„å½±å“ã€‚</p></div><p>å½“çº¿ç¨‹å¤„äºå°±ç»ªã€è¿è¡Œã€é˜»å¡ 3 ç§çŠ¶æ€æ—¶ï¼Œå¯ä»¥è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„<code>isAlive()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†è¿”å› trueï¼›å½“çº¿ç¨‹å¤„äºæ–°å»ºã€æ­»äº¡ 2 ç§çŠ¶æ€æ—¶ï¼Œè¯¥æ–¹æ³•å°†è¿”å› falseã€‚</p><p>å°è¯•å¯¹å¤„äºæ­»äº¡çŠ¶æ€çš„çº¿ç¨‹å†æ¬¡è°ƒç”¨<code>start()</code>æ–¹æ³•ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StartDead</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºçº¿ç¨‹å¯¹è±¡</span>
    <span class="token class-name">StartDead</span> sd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StartDead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è°ƒç”¨Threadçš„currentThread()æ–¹æ³•è·å–å½“å‰çº¿ç¨‹</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯åŠ¨çº¿ç¨‹</span>
        sd<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ¤æ–­å¯åŠ¨åçº¿ç¨‹çš„isAlive()å€¼ï¼Œè¾“å‡ºtrue</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sd<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// å½“çº¿ç¨‹å¤„äºæ–°å»ºã€æ­»äº¡ä¸¤ç§çŠ¶æ€æ—¶ï¼ŒisAlive()æ–¹æ³•è¿”å›false</span>
      <span class="token comment">// å½“i &gt; 20æ—¶ï¼Œè¯¥çº¿ç¨‹è‚¯å®šå·²ç»å¯åŠ¨è¿‡äº†ï¼Œå¦‚æœsd.isAlive()ä¸ºå‡æ—¶ï¼Œ</span>
      <span class="token comment">// é‚£å°±æ˜¯æ­»äº¡çŠ¶æ€äº†</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>sd<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¯•å›¾å†æ¬¡å¯åŠ¨è¯¥çº¿ç¨‹</span>
        sd<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡å†™run()æ–¹æ³•ï¼Œrun()æ–¹æ³•çš„æ–¹æ³•ä½“å°±æ˜¯çº¿ç¨‹æ‰§è¡Œä½“</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œä¸Šé¢ç¨‹åºï¼Œå°†å¼•å‘<code>IllegalThreadStateException</code>å¼‚å¸¸ã€‚</p><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p>å¦‚æœå­çº¿ç¨‹åœ¨ä¸»çº¿ç¨‹ä¹‹åç»“æŸåˆ™ç¨‹åºä¼šæ­£å¸¸æ‰§è¡Œï¼Œå¯ä»¥å°†å­çº¿ç¨‹çš„å¾ªç¯æ‰“å°æ¬¡æ•°å¢åŠ è‡³å’Œä¸»çº¿ç¨‹ä¸€æ ·å¢åŠ è¿™ç§æ¦‚ç‡ã€‚</p></div><h2 id="æ§åˆ¶çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#æ§åˆ¶çº¿ç¨‹" aria-hidden="true">#</a> æ§åˆ¶çº¿ç¨‹</h2><p>Java çš„çº¿ç¨‹æ”¯æŒæä¾›äº†ä¸€äº›ä¾¿æ·çš„å·¥å…·æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›ä¾¿æ·çš„å·¥å…·æ–¹æ³•å¯ä»¥å¾ˆå¥½åœ°æ§åˆ¶çº¿ç¨‹çš„æ‰§è¡Œã€‚</p><h3 id="join-çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#join-çº¿ç¨‹" aria-hidden="true">#</a> join çº¿ç¨‹</h3><p>å½“åœ¨æŸä¸ªç¨‹åºæ‰§è¡Œæµä¸­è°ƒç”¨å…¶ä»–çº¿ç¨‹çš„<code>join()</code>æ–¹æ³•æ—¶ï¼Œè°ƒç”¨çº¿ç¨‹å°†è¢«é˜»å¡ï¼Œç›´åˆ°è¢«<code>join()</code>æ–¹æ³•åŠ å…¥çš„<code>join</code>çº¿ç¨‹æ‰§è¡Œå®Œä¸ºæ­¢ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JoinThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// æä¾›ä¸€ä¸ªæœ‰å‚æ•°çš„æ„é€ å™¨ï¼Œç”¨äºè®¾ç½®è¯¥çº¿ç¨‹çš„åå­—</span>
  <span class="token keyword">public</span> <span class="token class-name">JoinThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯åŠ¨å­çº¿ç¨‹</span>
    <span class="token keyword">new</span> <span class="token class-name">JoinThread</span><span class="token punctuation">(</span><span class="token string">&quot;æ–°çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">JoinThread</span> jt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JoinThread</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«Joinçš„çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jt<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// mainçº¿ç¨‹è°ƒç”¨äº†jtçº¿ç¨‹çš„join()æ–¹æ³•ï¼Œmainçº¿ç¨‹</span>
        <span class="token comment">// å¿…é¡»ç­‰jtæ‰§è¡Œç»“æŸæ‰ä¼šå‘ä¸‹æ‰§è¡Œ</span>
        jt<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡å†™run()æ–¹æ³•ï¼Œå®šä¹‰çº¿ç¨‹æ‰§è¡Œä½“</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€œè¢« Join çš„çº¿ç¨‹â€çš„çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ä¸ä¼šå’Œ<code>main</code>çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œ<code>main</code>çº¿ç¨‹å¿…é¡»ç­‰è¯¥çº¿ç¨‹æ‰§è¡Œç»“æŸåæ‰å¯ä»¥å‘ä¸‹æ‰§è¡Œã€‚â€œè¢« Join çš„çº¿ç¨‹â€çš„çº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå®é™…ä¸Šåªæœ‰ 2 ä¸ªå­çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œä¸»çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ã€‚</p><p><code>join()</code>æ–¹æ³•æœ‰å¦‚ä¸‹ 3 ç§é‡è½½å½¢å¼ã€‚</p><ul><li><code>join()</code>ï¼šç­‰å¾…è¢«<code>join</code>çš„çº¿ç¨‹æ‰§è¡Œå®Œæˆã€‚</li><li><code>join(long millis)</code>ï¼šç­‰å¾…è¢«<code>join</code>çš„çº¿ç¨‹çš„æ—¶é—´æœ€é•¿ä¸º<code>millis</code>æ¯«ç§’ã€‚å¦‚æœåœ¨<code>millis</code>æ¯«ç§’å†…è¢«<code>join</code>çš„çº¿ç¨‹è¿˜æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œåˆ™ä¸å†ç­‰å¾…ã€‚</li><li><code>join(long millis, int nanos)</code>ï¼šç­‰å¾…è¢«<code>join</code>çš„çº¿ç¨‹çš„æ—¶é—´æœ€é•¿ä¸º<code>millis</code>æ¯«ç§’ + <code>nanos</code>æ¯«å¾®ç§’ã€‚</li></ul><h3 id="åå°çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#åå°çº¿ç¨‹" aria-hidden="true">#</a> åå°çº¿ç¨‹</h3><p>æœ‰ä¸€ç§çº¿ç¨‹ï¼Œå®ƒæ˜¯åœ¨åå°è¿è¡Œçš„ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯ä¸ºå…¶ä»–çš„çº¿ç¨‹æä¾›æœåŠ¡ï¼Œè¿™ç§çº¿ç¨‹è¢«ç§°ä¸ºâ€œåå°çº¿ç¨‹ï¼ˆDaemon Threadï¼‰â€ï¼Œåˆç§°ä¸ºâ€œå®ˆæŠ¤çº¿ç¨‹â€æˆ–â€œç²¾çµçº¿ç¨‹â€ã€‚</p><p>åå°çº¿ç¨‹æœ‰ä¸ªç‰¹å¾ï¼šå¦‚æœæ‰€æœ‰çš„å‰å°çº¿ç¨‹éƒ½æ­»äº¡ï¼Œåå°çº¿ç¨‹ä¼šè‡ªåŠ¨æ­»äº¡ã€‚</p><p>è°ƒç”¨<code>Thread</code>å¯¹è±¡çš„<code>setDaemon(true)</code>æ–¹æ³•å¯å°†æŒ‡å®šçº¿ç¨‹è®¾ç½®æˆåå°çº¿ç¨‹ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DaemonThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">DaemonThread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DaemonThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å°†æ­¤çº¿ç¨‹è®¾ç½®æˆåå°çº¿ç¨‹</span>
    t<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¯åŠ¨åå°çº¿ç¨‹</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// -----ç¨‹åºæ‰§è¡Œåˆ°æ­¤å¤„ï¼Œå‰å°çº¿ç¨‹ï¼ˆmainçº¿ç¨‹ï¼‰ç»“æŸ------</span>
    <span class="token comment">// åå°çº¿ç¨‹ä¹Ÿåº”è¯¥éšä¹‹ç»“æŸ</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å®šä¹‰åå°çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ä¸æ™®é€šçº¿ç¨‹æ²¡æœ‰ä»»ä½•åŒºåˆ«</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thread ç±»è¿˜æä¾›äº†ä¸€ä¸ª<code>isDaemon()</code>æ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­æŒ‡å®šçº¿ç¨‹æ˜¯å¦ä¸ºåå°çº¿ç¨‹ã€‚</p><p>è¦å°†æŸä¸ªçº¿ç¨‹è®¾ç½®ä¸ºåå°çº¿ç¨‹ï¼Œå¿…é¡»åœ¨è¯¥çº¿ç¨‹å¯åŠ¨ä¹‹å‰è®¾ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>setDaemon(true)</code>å¿…é¡»åœ¨<code>start()</code>æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå¦åˆ™ä¼šå¼•å‘<code>IllegalThreadStateException</code>å¼‚å¸¸ã€‚</p><div class="custom-container warning"><p class="custom-container-title">æ³¨æ„</p><p>åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­ï¼Œç¼–å†™ä»£ç è¦æ³¨æ„ï¼šå®ˆæŠ¤çº¿ç¨‹ä¸èƒ½æŒæœ‰ä»»ä½•éœ€è¦å…³é—­çš„èµ„æºï¼Œä¾‹å¦‚æ‰“å¼€æ–‡ä»¶ç­‰ï¼Œå› ä¸ºè™šæ‹Ÿæœºé€€å‡ºæ—¶ï¼Œå®ˆæŠ¤çº¿ç¨‹æ²¡æœ‰ä»»ä½•æœºä¼šæ¥å…³é—­æ–‡ä»¶ï¼Œè¿™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p></div><h3 id="çº¿ç¨‹ç¡çœ -sleep" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹ç¡çœ -sleep" aria-hidden="true">#</a> çº¿ç¨‹ç¡çœ ï¼šsleep</h3><p>å¦‚æœéœ€è¦è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œåˆ™å¯ä»¥é€šè¿‡è°ƒç”¨<code>Thread</code>ç±»çš„é™æ€<code>sleep()</code>æ–¹æ³•æ¥å®ç°ã€‚<code>sleep()</code>æ–¹æ³•æœ‰ä¸¤ç§é‡è½½å½¢å¼ã€‚</p><ul><li><code>static void sleep(long millis)</code>ï¼šè®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœ<code>millis</code>æ¯«ç§’ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¯¥æ–¹æ³•å—åˆ°ç³»ç»Ÿè®¡æ—¶å™¨å’Œçº¿ç¨‹è°ƒåº¦å™¨çš„ç²¾åº¦ä¸å‡†ç¡®åº¦çš„å½±å“ã€‚</li><li><code>static void sleep(long millis, int nanos)</code>ï¼šè®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœ<code>millis</code>æ¯«ç§’ + <code>nanos</code>æ¯«å¾®ç§’ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè¯¥æ–¹æ³•å—åˆ°ç³»ç»Ÿè®¡æ—¶å™¨å’Œçº¿ç¨‹è°ƒåº¦å™¨çš„ç²¾åº¦ä¸å‡†ç¡®åº¦çš„å½±å“ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SleepTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰æ—¶é—´: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// è°ƒç”¨sleep()æ–¹æ³•è®©å½“å‰çº¿ç¨‹æš‚åœ1s</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="çº¿ç¨‹è®©æ­¥-yield" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹è®©æ­¥-yield" aria-hidden="true">#</a> çº¿ç¨‹è®©æ­¥ï¼šyield</h3><p><code>yield()</code>æ–¹æ³•æ˜¯ä¸€ä¸ªå’Œ<code>sleep()</code>æ–¹æ³•æœ‰ç‚¹ç›¸ä¼¼çš„æ–¹æ³•ï¼Œå®ƒä¹Ÿæ˜¯<code>Thread</code>ç±»æä¾›çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒä¹Ÿå¯ä»¥è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœï¼Œä½†å®ƒä¸ä¼šé˜»å¡è¯¥çº¿ç¨‹ï¼Œå®ƒåªæ˜¯å°†è¯¥çº¿ç¨‹è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YieldTest</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token class-name">YieldTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯åŠ¨ä¸¤ä¸ªå¹¶å‘çº¿ç¨‹</span>
    <span class="token class-name">YieldTest</span> yt1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YieldTest</span><span class="token punctuation">(</span><span class="token string">&quot;é«˜çº§&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å°†yt1çº¿ç¨‹è®¾ç½®æˆæœ€é«˜ä¼˜å…ˆçº§</span>
    <span class="token comment">// yt1.setPriority(Thread.MAX_PRIORITY);</span>
    yt1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">YieldTest</span> yt2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YieldTest</span><span class="token punctuation">(</span><span class="token string">&quot;ä½çº§&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å°†yt2çº¿ç¨‹è®¾ç½®æˆæœ€ä½ä¼˜å…ˆçº§</span>
    <span class="token comment">// yt2.setPriority(Thread.MIN_PRIORITY);</span>
    yt2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å®šä¹‰run()æ–¹æ³•ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;  &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å½“iç­‰äº20æ—¶ï¼Œä½¿ç”¨yield()æ–¹æ³•è®©å½“å‰çº¿ç¨‹è®©æ­¥</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>yield()</code>åªæ˜¯è®©å½“å‰çº¿ç¨‹æš‚åœä¸€ä¸‹ï¼Œè®©ç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦å™¨é‡æ–°è°ƒåº¦ä¸€æ¬¡ï¼Œå®Œå…¨å¯èƒ½çš„æƒ…å†µæ˜¯ï¼šå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†<code>yield()</code>æ–¹æ³•æš‚åœä¹‹åï¼Œçº¿ç¨‹è°ƒåº¦å™¨åˆå°†å…¶è°ƒåº¦å‡ºæ¥é‡æ–°æ‰§è¡Œã€‚</p><p>å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†<code>yield()</code>æ–¹æ³•æš‚åœä¹‹åï¼Œåªæœ‰ä¼˜å…ˆçº§ä¸å½“å‰çº¿ç¨‹ç›¸åŒï¼Œæˆ–è€…ä¼˜å…ˆçº§æ¯”å½“å‰çº¿ç¨‹æ›´é«˜çš„å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ‰ä¼šè·å¾—æ‰§è¡Œçš„æœºä¼šã€‚</p><p><code>sleep()</code>æ–¹æ³•å’Œ<code>yield()</code>æ–¹æ³•çš„åŒºåˆ«å¦‚ä¸‹ã€‚</p><ul><li><code>sleep()</code>æ–¹æ³•æš‚åœå½“å‰çº¿ç¨‹åï¼Œä¼šç»™å…¶ä»–çº¿ç¨‹æ‰§è¡Œæœºä¼šï¼Œä¸ä¼šç†ä¼šå…¶ä»–çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼›ä½†<code>yield()</code>æ–¹æ³•åªä¼šç»™ä¼˜å…ˆçº§ç›¸åŒï¼Œæˆ–ä¼˜å…ˆçº§æ›´é«˜çš„çº¿ç¨‹æ‰§è¡Œæœºä¼šã€‚</li><li><code>sleep()</code>æ–¹æ³•ä¼šå°†çº¿ç¨‹è½¬å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°ç»è¿‡é˜»å¡æ—¶é—´æ‰ä¼šè½¬å…¥å°±ç»ªçŠ¶æ€ï¼›è€Œ<code>yield()</code>ä¸ä¼šå°†çº¿ç¨‹è½¬å…¥é˜»å¡çŠ¶æ€ï¼Œå®ƒåªæ˜¯å¼ºåˆ¶å½“å‰çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚å› æ­¤å®Œå…¨æœ‰å¯èƒ½æŸä¸ªçº¿ç¨‹è°ƒç”¨<code>yield()</code>æ–¹æ³•æš‚åœä¹‹åï¼Œç«‹å³å†æ¬¡è·å¾—å¤„ç†å™¨èµ„æºè¢«æ‰§è¡Œã€‚</li><li><code>sleep()</code>æ–¹æ³•å£°æ˜æŠ›å‡ºäº†<code>InterruptedException</code>å¼‚å¸¸ï¼Œæ‰€ä»¥è°ƒç”¨<code>sleep()</code>æ–¹æ³•æ—¶è¦ä¹ˆæ•æ‰è¯¥å¼‚å¸¸ï¼Œè¦ä¹ˆæ˜¾å¼å£°æ˜æŠ›å‡ºè¯¥å¼‚å¸¸ï¼›è€Œ<code>yield()</code>æ–¹æ³•åˆ™æ²¡æœ‰å£°æ˜æŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚</li><li><code>sleep()</code>æ–¹æ³•æ¯”<code>yield()</code>æ–¹æ³•æœ‰æ›´å¥½çš„å¯ç§»æ¤æ€§ï¼Œé€šå¸¸ä¸å»ºè®®ä½¿ç”¨<code>yield()</code>æ–¹æ³•æ¥æ§åˆ¶å¹¶å‘çº¿ç¨‹çš„æ‰§è¡Œã€‚</li></ul><h3 id="æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§" tabindex="-1"><a class="header-anchor" href="#æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§" aria-hidden="true">#</a> æ”¹å˜çº¿ç¨‹ä¼˜å…ˆçº§</h3><p>æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶éƒ½å…·æœ‰ä¸€å®šçš„ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹è·å¾—è¾ƒå¤šçš„æ‰§è¡Œæœºä¼šï¼Œè€Œä¼˜å…ˆçº§ä½çš„çº¿ç¨‹åˆ™è·å¾—è¾ƒå°‘çš„æ‰§è¡Œæœºä¼šã€‚</p><p>æ¯ä¸ªçº¿ç¨‹é»˜è®¤çš„ä¼˜å…ˆçº§éƒ½ä¸åˆ›å»ºå®ƒçš„çˆ¶çº¿ç¨‹çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>main</code>çº¿ç¨‹å…·æœ‰æ™®é€šä¼˜å…ˆçº§ï¼Œç”±<code>main</code>çº¿ç¨‹åˆ›å»ºçš„å­çº¿ç¨‹ä¹Ÿå…·æœ‰æ™®é€šä¼˜å…ˆçº§ã€‚</p><p><code>Thread</code>ç±»æä¾›äº†<code>setPriority(int newPriority)</code>ã€<code>getPriority()</code>æ–¹æ³•æ¥è®¾ç½®å’Œè¿”å›æŒ‡å®šçº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå…¶ä¸­<code>setPriority()</code>æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒèŒƒå›´æ˜¯ 1 ï½ 10 ä¹‹é—´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>Thread</code>ç±»çš„å¦‚ä¸‹ 3 ä¸ªé™æ€å¸¸é‡ã€‚</p><ul><li>MAX_PRIORITYï¼šå…¶å€¼æ˜¯ 10ã€‚</li><li>MIN_PRIORITYï¼šå…¶å€¼æ˜¯ 1ã€‚</li><li>NORM_PRIORITYï¼šå…¶å€¼æ˜¯ 5ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PriorityTest</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// å®šä¹‰ä¸€ä¸ªæœ‰å‚æ•°çš„æ„é€ å™¨ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹æ—¶æŒ‡å®šname</span>
  <span class="token keyword">public</span> <span class="token class-name">PriorityTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ”¹å˜ä¸»çº¿ç¨‹çš„ä¼˜å…ˆçº§</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PriorityTest</span> low <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityTest</span><span class="token punctuation">(</span><span class="token string">&quot;ä½çº§&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        low<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ›å»ºä¹‹åˆçš„ä¼˜å…ˆçº§:&quot;</span> <span class="token operator">+</span> low<span class="token punctuation">.</span><span class="token function">getPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®è¯¥çº¿ç¨‹ä¸ºæœ€ä½ä¼˜å…ˆçº§</span>
        low<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token constant">MIN_PRIORITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PriorityTest</span> high <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityTest</span><span class="token punctuation">(</span><span class="token string">&quot;é«˜çº§&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        high<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ›å»ºä¹‹åˆçš„ä¼˜å…ˆçº§:&quot;</span>
            <span class="token operator">+</span> high<span class="token punctuation">.</span><span class="token function">getPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®è¯¥çº¿ç¨‹ä¸ºæœ€é«˜ä¼˜å…ˆçº§</span>
        high<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token constant">MAX_PRIORITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,å…¶ä¼˜å…ˆçº§æ˜¯ï¼š&quot;</span> <span class="token operator">+</span> <span class="token function">getPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,å¾ªç¯å˜é‡çš„å€¼ä¸º:&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">ç›¸å…³ä¿¡æ¯</p><p>è™½ç„¶ Java æä¾›äº† 10 ä¸ªä¼˜å…ˆçº§çº§åˆ«ï¼Œä½†è¿™äº›ä¼˜å…ˆçº§çº§åˆ«éœ€è¦æ“ä½œç³»ç»Ÿçš„æ”¯æŒã€‚é—æ†¾çš„æ˜¯ï¼Œä¸åŒæ“ä½œç³»ç»Ÿä¸Šçš„ä¼˜å…ˆçº§å¹¶ä¸ç›¸åŒï¼Œè€Œä¸”ä¹Ÿä¸èƒ½å¾ˆå¥½åœ°å’Œ Java çš„ 10 ä¸ªä¼˜å…ˆçº§å¯¹åº”ï¼Œä¾‹å¦‚ Windows 2000 ä»…æä¾›äº† 7 ä¸ªä¼˜å…ˆçº§ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é¿å…ç›´æ¥ä¸ºçº¿ç¨‹æŒ‡å®šä¼˜å…ˆçº§ï¼Œè€Œåº”è¯¥ä½¿ç”¨ MAX_PRIORITYã€MIN_PRIORITY å’Œ NORM_PRIORITY ä¸‰ä¸ªé™æ€å¸¸é‡æ¥è®¾ç½®ä¼˜å…ˆçº§ï¼Œè¿™æ ·æ‰å¯ä»¥ä¿è¯ç¨‹åºå…·æœ‰æœ€å¥½çš„å¯ç§»æ¤æ€§ã€‚</p></div><h2 id="çº¿ç¨‹åŒæ­¥" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹åŒæ­¥" aria-hidden="true">#</a> çº¿ç¨‹åŒæ­¥</h2><p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œæ—¶ï¼Œçº¿ç¨‹çš„è°ƒåº¦ç”±æ“ä½œç³»ç»Ÿå†³å®šï¼Œç¨‹åºæœ¬èº«æ— æ³•å†³å®šã€‚å› æ­¤ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å¯èƒ½åœ¨ä»»ä½•æŒ‡ä»¤å¤„è¢«æ“ä½œç³»ç»Ÿæš‚åœï¼Œç„¶ååœ¨æŸä¸ªæ—¶é—´æ®µåç»§ç»­æ‰§è¡Œã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæœ‰ä¸ªå•çº¿ç¨‹æ¨¡å‹ä¸‹ä¸å­˜åœ¨çš„é—®é¢˜å°±æ¥äº†ï¼šå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™å…±äº«å˜é‡ï¼Œä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><h3 id="çº¿ç¨‹å®‰å…¨é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹å®‰å…¨é—®é¢˜" aria-hidden="true">#</a> çº¿ç¨‹å®‰å…¨é—®é¢˜</h3><p>å…³äºçº¿ç¨‹å®‰å…¨çš„ä¸€ä¸ªç»å…¸é—®é¢˜â€”â€”é“¶è¡Œå–é’±ã€‚é“¶è¡Œå–é’±çš„åŸºæœ¬æµç¨‹åŸºæœ¬ä¸Šå¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚</p><ol><li>ç”¨æˆ·è¾“å…¥è´¦æˆ·ã€å¯†ç ï¼Œç³»ç»Ÿåˆ¤æ–­ç”¨æˆ·çš„è´¦æˆ·ã€å¯†ç æ˜¯å¦åŒ¹é…ã€‚</li><li>ç”¨æˆ·è¾“å…¥å–æ¬¾é‡‘é¢ã€‚</li><li>ç³»ç»Ÿåˆ¤æ–­è´¦æˆ·ä½™é¢æ˜¯å¦å¤§äºå–æ¬¾é‡‘é¢ã€‚</li><li>å¦‚æœä½™é¢å¤§äºå–æ¬¾é‡‘é¢ï¼Œåˆ™å–æ¬¾æˆåŠŸï¼›å¦‚æœä½™é¢å°äºå–æ¬¾é‡‘é¢ï¼Œåˆ™å–æ¬¾å¤±è´¥ã€‚</li></ol><p>ä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹æ¥æ¨¡æ‹Ÿå–é’±æ“ä½œï¼Œæ¨¡æ‹Ÿä¸¤ä¸ªäººä½¿ç”¨åŒä¸€ä¸ªè´¦æˆ·å¹¶å‘å–é’±çš„é—®é¢˜ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

  <span class="token comment">// å°è£…è´¦æˆ·ç¼–å·ã€è´¦æˆ·ä½™é¢ä¸¤ä¸ªField</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> accountNo<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> balance<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token class-name">String</span> accountNo<span class="token punctuation">,</span> <span class="token keyword">double</span> balance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>accountNo <span class="token operator">=</span> accountNo<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>balance <span class="token operator">=</span> balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ ¹æ®accountNoæ¥é‡å†™hashCode()å’Œequals()æ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> accountNo<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!=</span> <span class="token keyword">null</span>
        <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Account</span> target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">getAccountNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accountNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å–é’±çš„çº¿ç¨‹ç±»ï¼Œè¯¥çº¿ç¨‹ç±»æ ¹æ®æ‰§è¡Œè´¦æˆ·ã€å–é’±æ•°é‡è¿›è¡Œå–é’±æ“ä½œï¼Œå–é’±çš„é€»è¾‘æ˜¯å½“å…¶ä½™é¢ä¸è¶³æ—¶æ— æ³•æå–ç°é‡‘ï¼Œå½“ä½™é¢è¶³å¤Ÿæ—¶ç³»ç»Ÿåå‡ºé’ç¥¨ï¼Œä½™é¢å‡å°‘ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DrawThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ¨¡æ‹Ÿç”¨æˆ·è´¦æˆ·</span>
  <span class="token keyword">private</span> <span class="token class-name">Account</span> account<span class="token punctuation">;</span>
  <span class="token comment">// å½“å‰å–é’±çº¿ç¨‹æ‰€å¸Œæœ›å–çš„é’±æ•°</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> drawAmount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">DrawThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Account</span> account
      <span class="token punctuation">,</span> <span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> account<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>drawAmount <span class="token operator">=</span> drawAmount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å½“å¤šä¸ªçº¿ç¨‹ä¿®æ”¹åŒä¸€ä¸ªå…±äº«æ•°æ®æ—¶ï¼Œå°†æ¶‰åŠæ•°æ®å®‰å…¨é—®é¢˜</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è´¦æˆ·ä½™é¢å¤§äºå–é’±æ•°ç›®</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åå‡ºé’ç¥¨</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;å–é’±æˆåŠŸï¼åå‡ºé’ç¥¨:&quot;</span> <span class="token operator">+</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// ä¿®æ”¹ä½™é¢</span>
      account<span class="token punctuation">.</span><span class="token function">setBalance</span><span class="token punctuation">(</span>account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\tä½™é¢ä¸º: &quot;</span> <span class="token operator">+</span> account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;å–é’±å¤±è´¥ï¼ä½™é¢ä¸è¶³ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼Œå¹¶å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹ä»è¯¥è´¦æˆ·ä¸­å–é’±ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DrawTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºä¸€ä¸ªè´¦æˆ·</span>
    <span class="token class-name">Account</span> acct <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token string">&quot;1234567&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ¨¡æ‹Ÿä¸¤ä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªè´¦æˆ·å–é’±</span>
    <span class="token keyword">new</span> <span class="token class-name">DrawThread</span><span class="token punctuation">(</span><span class="token string">&quot;ç”²&quot;</span><span class="token punctuation">,</span> acct<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">DrawThread</span><span class="token punctuation">(</span><span class="token string">&quot;ä¹™&quot;</span><span class="token punctuation">,</span> acct<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤šæ¬¡è¿è¡Œä¸Šé¢ç¨‹åºï¼Œå¾ˆæœ‰å¯èƒ½éƒ½ä¼šçœ‹åˆ°å¦‚å›¾æ‰€ç¤ºçš„é”™è¯¯ç»“æœã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208201910336.png" alt="image-20220820191008047"></p><h3 id="åŒæ­¥ä»£ç å—" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥ä»£ç å—" aria-hidden="true">#</a> åŒæ­¥ä»£ç å—</h3><p>ä¸ºäº†è§£å†³åŒæ­¥é—®é¢˜ï¼ŒJava çš„å¤šçº¿ç¨‹æ”¯æŒå¼•å…¥äº†åŒæ­¥ç›‘è§†å™¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨åŒæ­¥ç›‘è§†å™¨çš„é€šç”¨æ–¹æ³•å°±æ˜¯åŒæ­¥ä»£ç å—ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">//æ­¤å¤„çš„ä»£ç å°±æ˜¯åŒæ­¥ä»£ç å—</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>synchronized</code>åæ‹¬å·é‡Œçš„<code>obj</code>å°±æ˜¯åŒæ­¥ç›‘è§†å™¨ï¼Œä¸Šé¢ä»£ç çš„å«ä¹‰æ˜¯ï¼šçº¿ç¨‹å¼€å§‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å¾—å¯¹åŒæ­¥ç›‘è§†å™¨çš„é”å®šã€‚</p><p>ä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å¾—å¯¹åŒæ­¥ç›‘è§†å™¨çš„é”å®šï¼Œå½“åŒæ­¥ä»£ç å—æ‰§è¡Œå®Œæˆåï¼Œè¯¥çº¿ç¨‹ä¼šé‡Šæ”¾å¯¹è¯¥åŒæ­¥ç›‘è§†å™¨çš„é”å®šã€‚</p><p>é€šå¸¸æ¨èä½¿ç”¨å¯èƒ½è¢«å¹¶å‘è®¿é—®çš„å…±äº«èµ„æºå……å½“åŒæ­¥ç›‘è§†å™¨ã€‚</p><p>å¯¹äºä¸Šé¢çš„å–é’±æ¨¡æ‹Ÿç¨‹åºï¼Œä½¿ç”¨è´¦æˆ·ï¼ˆ<code>account</code>ï¼‰ä½œä¸ºåŒæ­¥ç›‘è§†å™¨ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DrawThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ¨¡æ‹Ÿç”¨æˆ·è´¦æˆ·</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Account</span> account<span class="token punctuation">;</span>
  <span class="token comment">// å½“å‰å–é’±çº¿ç¨‹æ‰€å¸Œæœ›å–çš„é’±æ•°</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">double</span> drawAmount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">DrawThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Account</span> account
      <span class="token punctuation">,</span> <span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> account<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>drawAmount <span class="token operator">=</span> drawAmount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å½“å¤šä¸ªçº¿ç¨‹ä¿®æ”¹åŒä¸€ä¸ªå…±äº«æ•°æ®æ—¶ï¼Œå°†æ¶‰åŠæ•°æ®å®‰å…¨é—®é¢˜</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä½¿ç”¨accountä½œä¸ºåŒæ­¥ç›‘è§†å™¨ï¼Œä»»ä½•çº¿ç¨‹è¿›å…¥ä¸‹é¢åŒæ­¥ä»£ç å—ä¹‹å‰</span>
    <span class="token comment">// å¿…é¡»å…ˆè·å¾—å¯¹accountè´¦æˆ·çš„é”å®šâ€”â€”å…¶ä»–çº¿ç¨‹æ— æ³•è·å¾—é”ï¼Œä¹Ÿå°±æ— æ³•ä¿®æ”¹å®ƒ</span>
    <span class="token comment">// è¿™ç§åšæ³•ç¬¦åˆï¼šâ€œåŠ é” â†’ ä¿®æ”¹ â†’ é‡Šæ”¾é”â€çš„é€»è¾‘</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>account<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è´¦æˆ·ä½™é¢å¤§äºå–é’±æ•°ç›®</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åå‡ºé’ç¥¨</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> <span class="token string">&quot;å–é’±æˆåŠŸï¼åå‡ºé’ç¥¨:&quot;</span> <span class="token operator">+</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// ä¿®æ”¹ä½™é¢</span>
        account<span class="token punctuation">.</span><span class="token function">setBalance</span><span class="token punctuation">(</span>account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\tä½™é¢ä¸º: &quot;</span> <span class="token operator">+</span> account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;å–é’±å¤±è´¥ï¼ä½™é¢ä¸è¶³ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// åŒæ­¥ä»£ç å—ç»“æŸï¼Œè¯¥çº¿ç¨‹é‡Šæ”¾åŒæ­¥é”</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŒæ­¥æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥æ–¹æ³•" aria-hidden="true">#</a> åŒæ­¥æ–¹æ³•</h3><p>åŒæ­¥æ–¹æ³•å°±æ˜¯ä½¿ç”¨<code>synchronized</code>å…³é”®å­—æ¥ä¿®é¥°æŸä¸ªæ–¹æ³•ï¼Œåˆ™è¯¥æ–¹æ³•ç§°ä¸ºåŒæ­¥æ–¹æ³•ã€‚å¯¹äºåŒæ­¥æ–¹æ³•è€Œè¨€ï¼Œæ— é¡»æ˜¾å¼æŒ‡å®šåŒæ­¥ç›‘è§†å™¨ï¼ŒåŒæ­¥æ–¹æ³•çš„åŒæ­¥ç›‘è§†å™¨æ˜¯<code>this</code>ï¼Œä¹Ÿå°±æ˜¯è¯¥å¯¹è±¡æœ¬èº«ã€‚</p><p>é€šè¿‡ä½¿ç”¨åŒæ­¥æ–¹æ³•å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®ç°çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œçº¿ç¨‹å®‰å…¨çš„ç±»å…·æœ‰å¦‚ä¸‹ç‰¹å¾ã€‚</p><ul><li>è¯¥ç±»çš„å¯¹è±¡å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å®‰å…¨åœ°è®¿é—®ã€‚</li><li>æ¯ä¸ªçº¿ç¨‹è°ƒç”¨è¯¥å¯¹è±¡çš„ä»»æ„æ–¹æ³•ä¹‹åéƒ½å°†å¾—åˆ°æ­£ç¡®ç»“æœã€‚</li><li>æ¯ä¸ªçº¿ç¨‹è°ƒç”¨è¯¥å¯¹è±¡çš„ä»»æ„æ–¹æ³•ä¹‹åï¼Œè¯¥å¯¹è±¡çŠ¶æ€ä¾ç„¶ä¿æŒåˆç†çŠ¶æ€ã€‚</li></ul><p>å°†<code>Account</code>ç±»å¯¹<code>balance</code>çš„è®¿é—®è®¾ç½®æˆçº¿ç¨‹å®‰å…¨çš„ï¼ŒæŠŠ<code>balance</code>çš„æ–¹æ³•ä¿®æ”¹æˆåŒæ­¥æ–¹æ³•ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

  <span class="token comment">// å°è£…è´¦æˆ·ç¼–å·ã€è´¦æˆ·ä½™é¢ä¸¤ä¸ªField</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> accountNo<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> balance<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token class-name">String</span> accountNo<span class="token punctuation">,</span> <span class="token keyword">double</span> balance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>accountNo <span class="token operator">=</span> accountNo<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>balance <span class="token operator">=</span> balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å› ä¸ºè´¦æˆ·ä½™é¢ä¸å…è®¸éšä¾¿ä¿®æ”¹ï¼Œæ‰€ä»¥åªä¸ºbalanceæä¾›getteræ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æä¾›ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„draw()æ–¹æ³•æ¥å®Œæˆå–é’±æ“ä½œ</span>
  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è´¦æˆ·ä½™é¢å¤§äºå–é’±æ•°ç›®</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">&gt;=</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åå‡ºé’ç¥¨</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token operator">+</span> <span class="token string">&quot;å–é’±æˆåŠŸï¼åå‡ºé’ç¥¨:&quot;</span> <span class="token operator">+</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// ä¿®æ”¹ä½™é¢</span>
      balance <span class="token operator">-=</span> drawAmount<span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\tä½™é¢ä¸º: &quot;</span> <span class="token operator">+</span> balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token operator">+</span> <span class="token string">&quot;å–é’±å¤±è´¥ï¼ä½™é¢ä¸è¶³ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ ¹æ®accountNoæ¥é‡å†™hashCode()å’Œequals()æ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> accountNo<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!=</span> <span class="token keyword">null</span>
        <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Account</span> target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">getAccountNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accountNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹<code>DrawThread</code>çº¿ç¨‹ç±»ï¼Œè¯¥çº¿ç¨‹ç±»çš„<code>run()</code>æ–¹æ³•åªè¦è°ƒç”¨<code>Account</code>å¯¹è±¡çš„<code>draw()</code>æ–¹æ³•å³å¯æ‰§è¡Œå–é’±æ“ä½œã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç›´æ¥è°ƒç”¨accountå¯¹è±¡çš„draw()æ–¹æ³•æ¥æ‰§è¡Œå–é’±æ“ä½œ</span>
  <span class="token comment">// åŒæ­¥æ–¹æ³•çš„åŒæ­¥ç›‘è§†å™¨æ˜¯thisï¼Œthisä»£è¡¨è°ƒç”¨draw()æ–¹æ³•çš„å¯¹è±¡</span>
  <span class="token comment">// ä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹è¿›å…¥draw()æ–¹æ³•ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹accountå¯¹è±¡åŠ é”</span>
  account<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯å˜ç±»çš„çº¿ç¨‹å®‰å…¨æ˜¯ä»¥é™ä½ç¨‹åºçš„è¿è¡Œæ•ˆç‡ä½œä¸ºä»£ä»·çš„ï¼Œä¸ºäº†å‡å°‘çº¿ç¨‹å®‰å…¨æ‰€å¸¦æ¥çš„è´Ÿé¢å½±å“ï¼Œç¨‹åºå¯ä»¥é‡‡ç”¨å¦‚ä¸‹ç­–ç•¥ã€‚</p><ul><li>ä¸è¦å¯¹çº¿ç¨‹å®‰å…¨ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½è¿›è¡ŒåŒæ­¥ï¼Œåªå¯¹é‚£äº›ä¼šæ˜¯å…±äº«èµ„æºçš„æ–¹æ³•è¿›è¡ŒåŒæ­¥ã€‚ä¾‹å¦‚ä¸Šé¢<code>Account</code>ç±»ä¸­çš„<code>accountNo</code>å±æ€§å°±æ— é¡»åŒæ­¥ï¼Œæ‰€ä»¥ç¨‹åºåªå¯¹<code>draw()</code>æ–¹æ³•è¿›è¡Œäº†åŒæ­¥æ§åˆ¶ã€‚</li><li>å¦‚æœå¯å˜ç±»æœ‰ä¸¤ç§è¿è¡Œç¯å¢ƒï¼šå•çº¿ç¨‹ç¯å¢ƒå’Œå¤šçº¿ç¨‹ç¯å¢ƒï¼Œåˆ™åº”è¯¥ä¸ºè¯¥å¯å˜ç±»æä¾›ä¸¤ç§ç‰ˆæœ¬ï¼Œå³çº¿ç¨‹ä¸å®‰å…¨ç‰ˆæœ¬å’Œçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ã€‚åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨çº¿ç¨‹ä¸å®‰å…¨ç‰ˆæœ¬ä»¥ä¿è¯æ€§èƒ½ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ã€‚</li></ul><h3 id="é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š" tabindex="-1"><a class="header-anchor" href="#é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š" aria-hidden="true">#</a> é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨çš„é”å®š</h3><p>ç¨‹åºæ— æ³•æ˜¾å¼é‡Šæ”¾å¯¹åŒæ­¥ç›‘è§†å™¨çš„é”å®šï¼Œçº¿ç¨‹ä¼šåœ¨å¦‚ä¸‹å‡ ç§æƒ…å†µä¸‹é‡Šæ”¾å¯¹åŒæ­¥ç›‘è§†å™¨çš„é”å®šã€‚</p><ol><li>å½“å‰çº¿ç¨‹çš„åŒæ­¥æ–¹æ³•ã€åŒæ­¥ä»£ç å—æ‰§è¡Œç»“æŸï¼Œå½“å‰çº¿ç¨‹å³é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</li><li>å½“å‰çº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—ã€åŒæ­¥æ–¹æ³•ä¸­é‡åˆ°<code>break</code>ã€<code>return</code>ç»ˆæ­¢äº†è¯¥ä»£ç å—ã€è¯¥æ–¹æ³•çš„ç»§ç»­æ‰§è¡Œï¼Œå½“å‰çº¿ç¨‹å°†ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</li><li>å½“å‰çº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—ã€åŒæ­¥æ–¹æ³•ä¸­å‡ºç°äº†æœªå¤„ç†çš„<code>Error</code>æˆ–<code>Exception</code>ï¼Œå¯¼è‡´äº†è¯¥ä»£ç å—ã€è¯¥æ–¹æ³•å¼‚å¸¸ç»“æŸæ—¶ï¼Œå½“å‰çº¿ç¨‹å°†ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</li><li>å½“å‰çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•æ—¶ï¼Œç¨‹åºæ‰§è¡Œäº†åŒæ­¥ç›‘è§†å™¨å¯¹è±¡çš„<code>wait()</code>æ–¹æ³•ï¼Œåˆ™å½“å‰çº¿ç¨‹æš‚åœï¼Œå¹¶é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</li></ol><p>åœ¨å¦‚ä¸‹æ‰€ç¤ºçš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¸ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</p><ul><li>çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—æˆ–åŒæ­¥æ–¹æ³•æ—¶ï¼Œç¨‹åºè°ƒç”¨<code>Thread.sleep()</code>ã€<code>Thread.yield()</code>æ–¹æ³•æ¥æš‚åœå½“å‰çº¿ç¨‹çš„æ‰§è¡Œï¼Œå½“å‰çº¿ç¨‹ä¸ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</li><li>çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—æ—¶ï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨äº†è¯¥çº¿ç¨‹çš„<code>suspend()</code>æ–¹æ³•å°†è¯¥çº¿ç¨‹æŒ‚èµ·ï¼Œè¯¥çº¿ç¨‹ä¸ä¼šé‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚å°½é‡é¿å…ä½¿ç”¨<code>suspend()</code>å’Œ<code>resume()</code>æ–¹æ³•æ¥æ§åˆ¶çº¿ç¨‹ã€‚</li></ul><h3 id="åŒæ­¥é”-lock" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥é”-lock" aria-hidden="true">#</a> åŒæ­¥é”ï¼ˆLockï¼‰</h3><p>ä» Java 5 å¼€å§‹ï¼ŒJava æä¾›äº†ä¸€ç§åŠŸèƒ½æ›´å¼ºå¤§çš„çº¿ç¨‹åŒæ­¥æœºåˆ¶â€”â€”é€šè¿‡æ˜¾å¼å®šä¹‰åŒæ­¥é”å¯¹è±¡æ¥å®ç°åŒæ­¥ï¼Œåœ¨è¿™ç§æœºåˆ¶ä¸‹ï¼ŒåŒæ­¥é”ä½¿ç”¨<code>Lock</code>å¯¹è±¡å……å½“ã€‚</p><p><code>Lock</code>æä¾›äº†æ¯”<code>synchronized</code>æ–¹æ³•å’Œ<code>synchronized</code>ä»£ç å—æ›´å¹¿æ³›çš„é”å®šæ“ä½œï¼Œ<code>Lock</code>å®ç°å…è®¸æ›´çµæ´»çš„ç»“æ„ï¼Œå¯ä»¥å…·æœ‰å·®åˆ«å¾ˆå¤§çš„å±æ€§ï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªç›¸å…³çš„<code>Condition</code>å¯¹è±¡ã€‚<code>Lock</code>æ˜¯æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®çš„å·¥å…·ã€‚</p><p>é€šå¸¸ï¼Œé”æä¾›äº†å¯¹å…±äº«èµ„æºçš„ç‹¬å è®¿é—®ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹<code>Lock</code>å¯¹è±¡åŠ é”ï¼Œçº¿ç¨‹å¼€å§‹è®¿é—®å…±äº«èµ„æºä¹‹å‰åº”å…ˆè·å¾—<code>Lock</code>å¯¹è±¡ã€‚</p><p>æŸäº›é”å¯èƒ½å…è®¸å¯¹å…±äº«èµ„æºå¹¶å‘è®¿é—®ï¼Œå¦‚<code>ReadWriteLock</code>ï¼ˆè¯»å†™é”ï¼‰ï¼Œ<code>Lock</code>ã€<code>ReadWriteLock</code>æ˜¯ Java5 æ–°æä¾›çš„ä¸¤ä¸ªæ ¹æ¥å£ï¼Œå¹¶ä¸º<code>Lock</code>æä¾›äº†<code>ReentrantLock</code>ï¼ˆå¯é‡å…¥é”ï¼‰å®ç°ç±»ï¼›ä¸º<code>ReadWriteLock</code>æä¾›äº†<code>ReentrantReadWriteLock</code>å®ç°ç±»ã€‚</p><p>ä½¿ç”¨è¯¥<code>Lock</code>å¯¹è±¡å¯ä»¥æ˜¾å¼åœ°åŠ é”ã€é‡Šæ”¾é”ï¼Œé€šå¸¸ä½¿ç”¨<code>ReentrantLock</code>çš„ä»£ç æ ¼å¼å¦‚ä¸‹ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>

  <span class="token comment">// å®šä¹‰é”å¯¹è±¡</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
  <span class="token comment">// å®šä¹‰éœ€è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„æ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åŠ é”</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// éœ€è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä»£ç </span>
      <span class="token comment">// ... method body</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä½¿ç”¨finallyå—æ¥ä¿è¯é‡Šæ”¾é”</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>ReentrantLock</code>å¯¹è±¡æ¥è¿›è¡ŒåŒæ­¥ï¼ŒåŠ é”å’Œé‡Šæ”¾é”å‡ºç°åœ¨ä¸åŒçš„ä½œç”¨èŒƒå›´å†…æ—¶ï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨<code>finally</code>å—æ¥ç¡®ä¿åœ¨å¿…è¦æ—¶é‡Šæ”¾é”ã€‚</p><p>é€šè¿‡ä½¿ç”¨<code>ReentrantLock</code>å¯¹è±¡ä¿®æ”¹<code>Account</code>ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

  <span class="token comment">// å®šä¹‰é”å¯¹è±¡</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å°è£…è´¦æˆ·ç¼–å·ã€è´¦æˆ·ä½™é¢ä¸¤ä¸ªField</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> accountNo<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> balance<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token class-name">String</span> accountNo<span class="token punctuation">,</span> <span class="token keyword">double</span> balance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>accountNo <span class="token operator">=</span> accountNo<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>balance <span class="token operator">=</span> balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å› ä¸ºè´¦æˆ·ä½™é¢ä¸å…è®¸éšä¾¿ä¿®æ”¹ï¼Œæ‰€ä»¥åªä¸ºbalanceæä¾›getteræ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æä¾›ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„draw()æ–¹æ³•æ¥å®Œæˆå–é’±æ“ä½œ</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åŠ é”</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// è´¦æˆ·ä½™é¢å¤§äºå–é’±æ•°ç›®</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">&gt;=</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åå‡ºé’ç¥¨</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> <span class="token string">&quot;å–é’±æˆåŠŸï¼åå‡ºé’ç¥¨:&quot;</span> <span class="token operator">+</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// ä¿®æ”¹ä½™é¢</span>
        balance <span class="token operator">-=</span> drawAmount<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\tä½™é¢ä¸º: &quot;</span> <span class="token operator">+</span> balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> <span class="token string">&quot;å–é’±å¤±è´¥ï¼ä½™é¢ä¸è¶³ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token comment">// ä¿®æ”¹å®Œæˆï¼Œé‡Šæ”¾é”</span>
      lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ ¹æ®accountNoæ¥é‡å†™hashCode()å’Œequals()æ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> accountNo<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!=</span> <span class="token keyword">null</span>
        <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Account</span> target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">getAccountNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accountNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Lock</code>æä¾›äº†åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥ä»£ç å—æ‰€æ²¡æœ‰çš„å…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨äºéå—ç»“æ„çš„<code>tryLock()</code>æ–¹æ³•ï¼Œä»¥åŠè¯•å›¾è·å–å¯ä¸­æ–­é”çš„<code>lockInterruptibly()</code>æ–¹æ³•ï¼Œè¿˜æœ‰è·å–è¶…æ—¶å¤±æ•ˆé”çš„<code>tryLock(long, TimeUnit)</code>æ–¹æ³•ã€‚</p><p><code>ReentrantLock</code>é”å…·æœ‰å¯é‡å…¥æ€§ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯¹å·²è¢«åŠ é”çš„<code>ReentrantLock</code>é”å†æ¬¡åŠ é”ï¼Œ <code>ReentrantLock</code>å¯¹è±¡ä¼šç»´æŒä¸€ä¸ªè®¡æ•°å™¨æ¥è¿½è¸ª<code>lock()</code>æ–¹æ³•çš„åµŒå¥—è°ƒç”¨ï¼Œçº¿ç¨‹åœ¨æ¯æ¬¡è°ƒç”¨<code>lock()</code>åŠ é”åï¼Œå¿…é¡»æ˜¾å¼è°ƒç”¨<code>unlock()</code>æ¥é‡Šæ”¾é”ï¼Œæ‰€ä»¥ä¸€æ®µè¢«é”ä¿æŠ¤çš„ä»£ç å¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªè¢«ç›¸åŒé”ä¿æŠ¤çš„æ–¹æ³•ã€‚</p><h3 id="æ­»é”" tabindex="-1"><a class="header-anchor" href="#æ­»é”" aria-hidden="true">#</a> æ­»é”</h3><p>å½“ä¸¤ä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…å¯¹æ–¹é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨æ—¶å°±ä¼šå‘ç”Ÿæ­»é”ï¼Œä¸€æ—¦å‡ºç°æ­»é”ï¼Œæ•´ä¸ªç¨‹åºæ—¢ä¸ä¼šå‘ç”Ÿä»»ä½•å¼‚å¸¸ï¼Œä¹Ÿä¸ä¼šç»™å‡ºä»»ä½•æç¤ºï¼Œåªæ˜¯æ‰€æœ‰çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ— æ³•ç»§ç»­ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token class-name">B</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰çº¿ç¨‹å: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">+</span> <span class="token string">&quot; è¿›å…¥äº†Aå®ä¾‹çš„fooæ–¹æ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//â‘ </span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰çº¿ç¨‹å: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">+</span> <span class="token string">&quot; ä¼å›¾è°ƒç”¨Bå®ä¾‹çš„lastæ–¹æ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//â‘¢</span>
    b<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¿›å…¥äº†Aç±»çš„lastæ–¹æ³•å†…éƒ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token class-name">A</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰çº¿ç¨‹å: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">+</span> <span class="token string">&quot; è¿›å…¥äº†Bå®ä¾‹çš„baræ–¹æ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//â‘¡</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å½“å‰çº¿ç¨‹å: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">+</span> <span class="token string">&quot; ä¼å›¾è°ƒç”¨Aå®ä¾‹çš„lastæ–¹æ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//â‘£</span>
    a<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¿›å…¥äº†Bç±»çš„lastæ–¹æ³•å†…éƒ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeadLock</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

  <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">B</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">DeadLock</span> dl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeadLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä»¥dlä¸ºtargetå¯åŠ¨æ–°çº¿ç¨‹</span>
    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>dl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è°ƒç”¨init()æ–¹æ³•</span>
    dl<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è°ƒç”¨aå¯¹è±¡çš„foo()æ–¹æ³•</span>
    a<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¿›å…¥äº†ä¸»çº¿ç¨‹ä¹‹å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;å‰¯çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è°ƒç”¨bå¯¹è±¡çš„bar()æ–¹æ³•</span>
    b<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¿›å…¥äº†å‰¯çº¿ç¨‹ä¹‹å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¨‹åºæ—¢æ— æ³•å‘ä¸‹æ‰§è¡Œï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚</p><p>ç¨‹åºä¸­<code>A</code>å¯¹è±¡å’Œ<code>B</code>å¯¹è±¡éƒ½æ˜¯åŒæ­¥é”ã€‚ç¨‹åºä¸­ä¸¤ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“æ˜¯<code>DeadLock</code>ç±»çš„<code>run()</code>æ–¹æ³•ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“æ˜¯<code>DeadLock</code>çš„<code>init()</code>æ–¹æ³•ï¼ˆä¸»çº¿ç¨‹è°ƒç”¨äº†<code>init()</code>æ–¹æ³•ï¼‰ã€‚</p><p>å…¶ä¸­<code>run()</code>æ–¹æ³•ä¸­è®©<code>B</code>å¯¹è±¡è°ƒç”¨<code>bar()</code>æ–¹æ³•ï¼Œè€Œ<code>init()</code>æ–¹æ³•è®©<code>A</code>å¯¹è±¡è°ƒç”¨<code>foo()</code>æ–¹æ³•ã€‚</p><ul><li><code>init()</code>æ–¹æ³•å…ˆæ‰§è¡Œï¼Œè°ƒç”¨äº†<code>A</code>å¯¹è±¡çš„<code>foo()</code>æ–¹æ³•ï¼Œè¿›å…¥<code>foo()</code>æ–¹æ³•ä¹‹å‰ï¼Œè¯¥çº¿ç¨‹å¯¹<code>A</code>å¯¹è±¡åŠ é”â€”â€”å½“ç¨‹åºæ‰§è¡Œåˆ° â‘  å·ä»£ç æ—¶ï¼Œä¸»çº¿ç¨‹æš‚åœ 200msï¼›</li><li>CPU åˆ‡æ¢åˆ°æ‰§è¡Œå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œè®©<code>B</code>å¯¹è±¡æ‰§è¡Œ<code>bar()</code>æ–¹æ³•ï¼Œè¿›å…¥<code>bar()</code>æ–¹æ³•ä¹‹å‰ï¼Œè¯¥çº¿ç¨‹å¯¹<code>B</code>å¯¹è±¡åŠ é”â€”â€”å½“ç¨‹åºæ‰§è¡Œåˆ° â‘¡ å·ä»£ç æ—¶ï¼Œå‰¯çº¿ç¨‹ä¹Ÿæš‚åœ 200msï¼›</li><li>æ¥ä¸‹æ¥ä¸»çº¿ç¨‹ä¼šå…ˆé†’è¿‡æ¥ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ° â‘¢ å·ä»£ç å¤„å¸Œæœ›è°ƒç”¨<code>B</code>å¯¹è±¡çš„<code>last()</code>æ–¹æ³•â€”â€”æ‰§è¡Œè¯¥æ–¹æ³•ä¹‹å‰å¿…é¡»å…ˆå¯¹<code>B</code>å¯¹è±¡åŠ é”ï¼Œä½†æ­¤æ—¶å‰¯çº¿ç¨‹æ­£ä¿æŒç€<code>B</code>å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹é˜»å¡ï¼›</li><li>æ¥ä¸‹æ¥å‰¯çº¿ç¨‹åº”è¯¥ä¹Ÿé†’è¿‡æ¥äº†ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ° â‘£ å·ä»£ç å¤„å¸Œæœ›è°ƒç”¨<code>A</code>å¯¹è±¡çš„<code>last()</code>æ–¹æ³•â€”â€”æ‰§è¡Œè¯¥æ–¹æ³•ä¹‹å‰å¿…é¡»å…ˆå¯¹<code>A</code>å¯¹è±¡åŠ é”ï¼Œä½†æ­¤æ—¶ä¸»çº¿ç¨‹æ²¡æœ‰é‡Šæ”¾å¯¹<code>A</code>å¯¹è±¡çš„é”â€”â€”è‡³æ­¤ï¼Œå°±å‡ºç°äº†ä¸»çº¿ç¨‹ä¿æŒç€<code>A</code>å¯¹è±¡çš„é”ï¼Œç­‰å¾…å¯¹<code>B</code>å¯¹è±¡åŠ é”ï¼Œè€Œå‰¯çº¿ç¨‹ä¿æŒç€<code>B</code>å¯¹è±¡çš„é”ï¼Œç­‰å¾…å¯¹<code>A</code>å¯¹è±¡åŠ é”ï¼Œä¸¤ä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹å…ˆé‡Šæ”¾ï¼Œæ‰€ä»¥å°±å‡ºç°äº†æ­»é”ã€‚</li></ul><h2 id="çº¿ç¨‹é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹é€šä¿¡" aria-hidden="true">#</a> çº¿ç¨‹é€šä¿¡</h2><p>å½“çº¿ç¨‹åœ¨ç³»ç»Ÿå†…è¿è¡Œæ—¶ï¼Œçº¿ç¨‹çš„è°ƒåº¦å…·æœ‰ä¸€å®šçš„é€æ˜æ€§ï¼Œç¨‹åºé€šå¸¸æ— æ³•å‡†ç¡®æ§åˆ¶çº¿ç¨‹çš„è½®æ¢æ‰§è¡Œï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æœºåˆ¶æ¥ä¿è¯çº¿ç¨‹åè°ƒè¿è¡Œã€‚</p><h3 id="ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡" aria-hidden="true">#</a> ä¼ ç»Ÿçš„çº¿ç¨‹é€šä¿¡</h3><p>å‡è®¾ç°åœ¨ç³»ç»Ÿä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«ä»£è¡¨å­˜æ¬¾è€…å’Œå–é’±è€…â€”â€”ç°åœ¨å‡è®¾ç³»ç»Ÿæœ‰ä¸€ç§ç‰¹æ®Šçš„è¦æ±‚ï¼Œç³»ç»Ÿè¦æ±‚å­˜æ¬¾è€…å’Œå–é’±è€…ä¸æ–­åœ°é‡å¤å­˜æ¬¾ã€å–é’±çš„åŠ¨ä½œï¼Œè€Œä¸”è¦æ±‚æ¯å½“å­˜æ¬¾è€…å°†é’±å­˜å…¥æŒ‡å®šè´¦æˆ·åï¼Œå–é’±è€…å°±ç«‹å³å–å‡ºè¯¥ç¬”é’±ã€‚ä¸å…è®¸å­˜æ¬¾è€…è¿ç»­ä¸¤æ¬¡å­˜é’±ï¼Œä¹Ÿä¸å…è®¸å–é’±è€…è¿ç»­ä¸¤æ¬¡å–é’±ã€‚</p><p><code>Object</code>ç±»çš„ 3 ä¸ªæ–¹æ³•ï¼š</p><p><code>wait()</code>ï¼šå¯¼è‡´å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨è¯¥åŒæ­¥ç›‘è§†å™¨çš„<code>notify()</code>æ–¹æ³•æˆ–<code>notifyAll()</code>æ–¹æ³•æ¥å”¤é†’è¯¥çº¿ç¨‹ã€‚è¯¥<code>wait()</code>æ–¹æ³•æœ‰ 3 ç§å½¢å¼â€”â€”æ— æ—¶é—´å‚æ•°çš„<code>wait</code>ï¼ˆä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹é€šçŸ¥ï¼‰ï¼Œå¸¦æ¯«ç§’å‚æ•°çš„<code>wait</code>å’Œå¸¦æ¯«ç§’ã€æ¯«å¾®ç§’å‚æ•°çš„<code>wait</code>ï¼ˆè¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯ç­‰å¾…æŒ‡å®šæ—¶é—´åè‡ªåŠ¨è‹é†’ï¼‰ã€‚è°ƒç”¨<code>wait()</code>æ–¹æ³•çš„å½“å‰çº¿ç¨‹ä¼šé‡Šæ”¾å¯¹è¯¥åŒæ­¥ç›‘è§†å™¨çš„é”å®šã€‚</p><p><code>notify()</code>ï¼šå”¤é†’åœ¨æ­¤åŒæ­¥ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨æ­¤åŒæ­¥ç›‘è§†å™¨ä¸Šç­‰å¾…ï¼Œåˆ™ä¼šé€‰æ‹©å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ã€‚é€‰æ‹©æ˜¯ä»»æ„æ€§çš„ã€‚åªæœ‰å½“å‰çº¿ç¨‹æ”¾å¼ƒå¯¹è¯¥åŒæ­¥ç›‘è§†å™¨çš„é”å®šåï¼ˆä½¿ç”¨<code>wait()</code>æ–¹æ³•ï¼‰ï¼Œæ‰å¯ä»¥æ‰§è¡Œè¢«å”¤é†’çš„çº¿ç¨‹ã€‚</p><p><code>notifyAll()</code>ï¼šå”¤é†’åœ¨æ­¤åŒæ­¥ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚åªæœ‰å½“å‰çº¿ç¨‹æ”¾å¼ƒå¯¹è¯¥åŒæ­¥ç›‘è§†å™¨çš„é”å®šåï¼Œæ‰å¯ä»¥æ‰§è¡Œè¢«å”¤é†’çš„çº¿ç¨‹ã€‚</p><p>ä½†è¿™ 3 ä¸ªæ–¹æ³•å¿…é¡»ç”±åŒæ­¥ç›‘è§†å™¨å¯¹è±¡æ¥è°ƒç”¨ï¼Œè¿™å¯åˆ†æˆä»¥ä¸‹ä¸¤ç§æƒ…å†µã€‚</p><ul><li>å¯¹äºä½¿ç”¨<code>synchronized</code>ä¿®é¥°çš„åŒæ­¥æ–¹æ³•ï¼Œå› ä¸ºè¯¥ç±»çš„é»˜è®¤å®ä¾‹ï¼ˆ<code>this</code>ï¼‰å°±æ˜¯åŒæ­¥ç›‘è§†å™¨ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŒæ­¥æ–¹æ³•ä¸­ç›´æ¥è°ƒç”¨è¿™ 3 ä¸ªæ–¹æ³•ã€‚</li><li>å¯¹äºä½¿ç”¨<code>synchronized</code>ä¿®é¥°çš„åŒæ­¥ä»£ç å—ï¼ŒåŒæ­¥ç›‘è§†å™¨æ˜¯<code>synchronized</code>åæ‹¬å·é‡Œçš„å¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨è¯¥å¯¹è±¡è°ƒç”¨è¿™ 3 ä¸ªæ–¹æ³•ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

  <span class="token comment">// å°è£…è´¦æˆ·ç¼–å·ã€è´¦æˆ·ä½™é¢ä¸¤ä¸ªField</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> accountNo<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> balance<span class="token punctuation">;</span>
  <span class="token comment">// æ ‡è¯†è´¦æˆ·ä¸­æ˜¯å¦å·²æœ‰å­˜æ¬¾çš„æ——æ ‡</span>
  <span class="token keyword">private</span> <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token class-name">String</span> accountNo<span class="token punctuation">,</span> <span class="token keyword">double</span> balance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>accountNo <span class="token operator">=</span> accountNo<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>balance <span class="token operator">=</span> balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å› ä¸ºè´¦æˆ·ä½™é¢ä¸å…è®¸éšä¾¿ä¿®æ”¹ï¼Œæ‰€ä»¥åªä¸ºbalanceæä¾›getteræ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœflagä¸ºå‡ï¼Œè¡¨æ˜è´¦æˆ·ä¸­è¿˜æ²¡æœ‰äººå­˜é’±è¿›å»ï¼Œå–é’±æ–¹æ³•é˜»å¡</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œå–é’±æ“ä½œ</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; å–é’±:&quot;</span> <span class="token operator">+</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balance <span class="token operator">-=</span> drawAmount<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è´¦æˆ·ä½™é¢ä¸ºï¼š&quot;</span> <span class="token operator">+</span> balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†æ ‡è¯†è´¦æˆ·æ˜¯å¦å·²æœ‰å­˜æ¬¾çš„æ——æ ‡è®¾ä¸ºfalse</span>
        flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token comment">// å”¤é†’å…¶ä»–çº¿ç¨‹</span>
        <span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token keyword">double</span> depositAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœflagä¸ºçœŸï¼Œè¡¨æ˜è´¦æˆ·ä¸­å·²æœ‰äººå­˜é’±è¿›å»ï¼Œå­˜é’±æ–¹æ³•é˜»å¡</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>           <span class="token comment">//â‘ </span>
      <span class="token punctuation">{</span>
        <span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œå­˜æ¬¾æ“ä½œ</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; å­˜æ¬¾:&quot;</span> <span class="token operator">+</span> depositAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balance <span class="token operator">+=</span> depositAmount<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è´¦æˆ·ä½™é¢ä¸ºï¼š&quot;</span> <span class="token operator">+</span> balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†è¡¨ç¤ºè´¦æˆ·æ˜¯å¦å·²æœ‰å­˜æ¬¾çš„æ——æ ‡è®¾ä¸ºtrue</span>
        flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">// å”¤é†’å…¶ä»–çº¿ç¨‹</span>
        <span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ ¹æ®accountNoæ¥é‡å†™hashCode()å’Œequals()æ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> accountNo<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Account</span> target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">getAccountNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accountNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¨‹åºä¸­çš„å­˜æ¬¾è€…çº¿ç¨‹å¾ªç¯ 100 æ¬¡é‡å¤å­˜æ¬¾ï¼Œè€Œå–é’±è€…çº¿ç¨‹åˆ™å¾ªç¯ 100 æ¬¡é‡å¤å–é’±ï¼Œå­˜æ¬¾è€…çº¿ç¨‹å’Œå–é’±è€…çº¿ç¨‹åˆ†åˆ«è°ƒç”¨<code>Account</code>å¯¹è±¡çš„<code>deposit()</code>ã€<code>draw()</code>æ–¹æ³•æ¥å®ç°ã€‚</p><p>å–é’±è´¦æˆ·ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DrawThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ¨¡æ‹Ÿç”¨æˆ·è´¦æˆ·</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Account</span> account<span class="token punctuation">;</span>
  <span class="token comment">// å½“å‰å–é’±çº¿ç¨‹æ‰€å¸Œæœ›å–çš„é’±æ•°</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">double</span> drawAmount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">DrawThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Account</span> account<span class="token punctuation">,</span> <span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> account<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>drawAmount <span class="token operator">=</span> drawAmount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡å¤100æ¬¡æ‰§è¡Œå–é’±æ“ä½œ</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      account<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­˜é’±è´¦æˆ·ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DepositThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ¨¡æ‹Ÿç”¨æˆ·è´¦æˆ·</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Account</span> account<span class="token punctuation">;</span>
  <span class="token comment">// å½“å‰å­˜æ¬¾çº¿ç¨‹æ‰€å¸Œæœ›å­˜çš„é’±æ•°</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">double</span> depositAmount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">DepositThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Account</span> account<span class="token punctuation">,</span> <span class="token keyword">double</span> depositAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> account<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>depositAmount <span class="token operator">=</span> depositAmount<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡å¤100æ¬¡æ‰§è¡Œå­˜æ¬¾æ“ä½œ</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      account<span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span>depositAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸»ç¨‹åºã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DrawTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºä¸€ä¸ªè´¦æˆ·</span>
    <span class="token class-name">Account</span> acct <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token string">&quot;1234567&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">DrawThread</span><span class="token punctuation">(</span><span class="token string">&quot;å–é’±è€…&quot;</span><span class="token punctuation">,</span> acct<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">DepositThread</span><span class="token punctuation">(</span><span class="token string">&quot;å­˜æ¬¾è€…ç”²&quot;</span><span class="token punctuation">,</span> acct<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">DepositThread</span><span class="token punctuation">(</span><span class="token string">&quot;å­˜æ¬¾è€…ä¹™&quot;</span><span class="token punctuation">,</span> acct<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">DepositThread</span><span class="token punctuation">(</span><span class="token string">&quot;å­˜æ¬¾è€…ä¸™&quot;</span><span class="token punctuation">,</span> acct<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¯¥ç¨‹åºï¼Œä¼šçœ‹åˆ°å¦‚å›¾æ‰€ç¤ºçš„ç»“æœã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208202048023.png" alt="image-20220820204844705"></p><div class="custom-container warning"><p class="custom-container-title">æ³¨æ„</p><p>é˜»å¡å¹¶ä¸æ˜¯æ­»é”ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œå–é’±è€…çº¿ç¨‹å·²ç»æ‰§è¡Œç»“æŸï¼Œè€Œå­˜æ¬¾è€…çº¿ç¨‹åªæ˜¯åœ¨ç­‰å¾…å…¶ä»–çº¿ç¨‹æ¥å–é’±è€Œå·²ï¼Œå¹¶ä¸æ˜¯ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡Šæ”¾åŒæ­¥ç›‘è§†å™¨ã€‚</p></div><h3 id="ä½¿ç”¨-condition-æ§åˆ¶çº¿ç¨‹é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-condition-æ§åˆ¶çº¿ç¨‹é€šä¿¡" aria-hidden="true">#</a> ä½¿ç”¨ Condition æ§åˆ¶çº¿ç¨‹é€šä¿¡</h3><p>å½“ä½¿ç”¨<code>Lock</code>å¯¹è±¡æ¥ä¿è¯åŒæ­¥æ—¶ï¼ŒJava æä¾›äº†ä¸€ä¸ª<code>Condition</code>ç±»æ¥ä¿æŒåè°ƒï¼Œä½¿ç”¨<code>Condition</code>å¯ä»¥è®©é‚£äº›å·²ç»å¾—åˆ° Lock å¯¹è±¡å´æ— æ³•ç»§ç»­æ‰§è¡Œçš„çº¿ç¨‹é‡Šæ”¾<code>Lock</code>å¯¹è±¡ï¼Œ<code>Condition</code>å¯¹è±¡ä¹Ÿå¯ä»¥å”¤é†’å…¶ä»–å¤„äºç­‰å¾…çš„çº¿ç¨‹ã€‚</p><p><code>Condition</code>å®ä¾‹è¢«ç»‘å®šåœ¨ä¸€ä¸ª<code>Lock</code>å¯¹è±¡ä¸Šã€‚è¦è·å¾—ç‰¹å®š<code>Lock</code>å®ä¾‹çš„<code>Condition</code>å®ä¾‹ï¼Œè°ƒç”¨<code>Lock</code>å¯¹è±¡çš„<code>newCondition()</code>æ–¹æ³•å³å¯ã€‚<code>Condition</code>ç±»æä¾›äº†å¦‚ä¸‹ 3 ä¸ªæ–¹æ³•ã€‚</p><ul><li><code>await()</code>ï¼šç±»ä¼¼äºéšå¼åŒæ­¥ç›‘è§†å™¨ä¸Šçš„<code>wait()</code>æ–¹æ³•ï¼Œå¯¼è‡´å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨è¯¥<code>Conditionçš„signal()</code>æ–¹æ³•æˆ–<code>signalAll()</code>æ–¹æ³•æ¥å”¤é†’è¯¥çº¿ç¨‹ã€‚è¯¥<code>await()</code>æ–¹æ³•æœ‰æ›´å¤šå˜ä½“ï¼Œå¦‚<code>long awaitNanos(long nanosTimeout)</code>ã€<code>void awaitUninterruptibly()</code>ã€<code>awaitUntil(Date deadline)</code>ç­‰ï¼Œå¯ä»¥å®Œæˆæ›´ä¸°å¯Œçš„ç­‰å¾…æ“ä½œã€‚</li><li><code>signal()</code>ï¼šå”¤é†’åœ¨æ­¤ Lock å¯¹è±¡ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨è¯¥<code>Lock</code>å¯¹è±¡ä¸Šç­‰å¾…ï¼Œåˆ™ä¼šé€‰æ‹©å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ã€‚é€‰æ‹©æ˜¯ä»»æ„æ€§çš„ã€‚åªæœ‰å½“å‰çº¿ç¨‹æ”¾å¼ƒå¯¹è¯¥<code>Lock</code>å¯¹è±¡çš„é”å®šåï¼ˆä½¿ç”¨<code>await()</code>æ–¹æ³•ï¼‰ï¼Œæ‰å¯ä»¥æ‰§è¡Œè¢«å”¤é†’çš„çº¿ç¨‹ã€‚</li><li><code>signalAll()</code>ï¼šå”¤é†’åœ¨æ­¤ Lock å¯¹è±¡ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚åªæœ‰å½“å‰çº¿ç¨‹æ”¾å¼ƒå¯¹è¯¥<code>Lock</code>å¯¹è±¡çš„é”å®šåï¼Œæ‰å¯ä»¥æ‰§è¡Œè¢«å”¤é†’çš„çº¿ç¨‹ã€‚</li></ul><p>ä¿®æ”¹<code>Account</code>ç±»ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ˜¾å¼å®šä¹‰Lockå¯¹è±¡</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å¾—æŒ‡å®šLockå¯¹è±¡å¯¹åº”çš„Condition</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Condition</span> cond <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å°è£…è´¦æˆ·ç¼–å·ã€è´¦æˆ·ä½™é¢ä¸¤ä¸ªField</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> accountNo<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">double</span> balance<span class="token punctuation">;</span>
  <span class="token comment">// æ ‡è¯†è´¦æˆ·ä¸­æ˜¯å¦å·²æœ‰å­˜æ¬¾çš„æ——æ ‡</span>
  <span class="token keyword">private</span> <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token class-name">String</span> accountNo<span class="token punctuation">,</span> <span class="token keyword">double</span> balance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>accountNo <span class="token operator">=</span> accountNo<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>balance <span class="token operator">=</span> balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å› ä¸ºè´¦æˆ·ä½™é¢ä¸å…è®¸éšä¾¿ä¿®æ”¹ï¼Œæ‰€ä»¥åªä¸ºbalanceæä¾›getteræ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>balance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">double</span> drawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åŠ é”</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœflagä¸ºå‡ï¼Œè¡¨æ˜è´¦æˆ·ä¸­è¿˜æ²¡æœ‰äººå­˜é’±è¿›å»ï¼Œå–é’±æ–¹æ³•é˜»å¡</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cond<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œå–é’±æ“ä½œ</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; å–é’±:&quot;</span> <span class="token operator">+</span> drawAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balance <span class="token operator">-=</span> drawAmount<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è´¦æˆ·ä½™é¢ä¸ºï¼š&quot;</span> <span class="token operator">+</span> balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†æ ‡è¯†è´¦æˆ·æ˜¯å¦å·²æœ‰å­˜æ¬¾çš„æ——æ ‡è®¾ä¸ºfalse</span>
        flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token comment">// å”¤é†’å…¶ä»–çº¿ç¨‹</span>
        cond<span class="token punctuation">.</span><span class="token function">signalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä½¿ç”¨finallyå—æ¥é‡Šæ”¾é”</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token keyword">double</span> depositAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœflagä¸ºçœŸï¼Œè¡¨æ˜è´¦æˆ·ä¸­å·²æœ‰äººå­˜é’±è¿›å»ï¼Œå­˜é’±æ–¹æ³•é˜»å¡</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>           <span class="token comment">//â‘ </span>
      <span class="token punctuation">{</span>
        cond<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œå­˜æ¬¾æ“ä½œ</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; å­˜æ¬¾:&quot;</span> <span class="token operator">+</span> depositAmount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balance <span class="token operator">+=</span> depositAmount<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è´¦æˆ·ä½™é¢ä¸ºï¼š&quot;</span> <span class="token operator">+</span> balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†è¡¨ç¤ºè´¦æˆ·æ˜¯å¦å·²æœ‰å­˜æ¬¾çš„æ——æ ‡è®¾ä¸ºtrue</span>
        flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">// å”¤é†’å…¶ä»–çº¿ç¨‹</span>
        cond<span class="token punctuation">.</span><span class="token function">signalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä½¿ç”¨finallyå—æ¥é‡Šæ”¾é”</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


  <span class="token comment">// ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ ¹æ®accountNoæ¥é‡å†™hashCode()å’Œequals()æ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> accountNo<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">Account</span> target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Account</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">getAccountNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>accountNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¯¥ç¨‹åºçš„æ•ˆæœä¸å‰ä¸€ä¸ªç¤ºä¾‹ç¨‹åºçš„è¿è¡Œæ•ˆæœå®Œå…¨ä¸€æ ·ã€‚</p><p><code>Condition</code>å°†åŒæ­¥ç›‘è§†å™¨æ–¹æ³•ï¼ˆ<code>wait()</code>ã€<code>notify()</code>å’Œ<code>notifyAll()</code>ï¼‰åˆ†è§£æˆæˆªç„¶ä¸åŒçš„å¯¹è±¡ï¼Œä»¥ä¾¿é€šè¿‡å°†è¿™äº›å¯¹è±¡ä¸<code>Lock</code>å¯¹è±¡ç»„åˆä½¿ç”¨ï¼Œä¸ºæ¯ä¸ªå¯¹è±¡æä¾›å¤šä¸ªç­‰å¾…é›†ï¼ˆ<code>wait-set</code>ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>Lock</code>æ›¿ä»£äº†åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—ï¼Œ<code>Condition</code>æ›¿ä»£äº†åŒæ­¥ç›‘è§†å™¨çš„åŠŸèƒ½ã€‚</p><h3 id="ä½¿ç”¨é˜»å¡é˜Ÿåˆ—-blockingqueue-æ§åˆ¶çº¿ç¨‹é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨é˜»å¡é˜Ÿåˆ—-blockingqueue-æ§åˆ¶çº¿ç¨‹é€šä¿¡" aria-hidden="true">#</a> ä½¿ç”¨é˜»å¡é˜Ÿåˆ—ï¼ˆ<code>BlockingQueue</code>ï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡</h3><p>Java 5 æä¾›äº†ä¸€ä¸ª<code>BlockingQueue</code>æ¥å£ï¼Œè™½ç„¶<code>BlockingQueue</code>ä¹Ÿæ˜¯<code>Queue</code>çš„å­æ¥å£ï¼Œä½†å®ƒçš„ä¸»è¦ç”¨é€”å¹¶ä¸æ˜¯ä½œä¸ºå®¹å™¨ï¼Œè€Œæ˜¯ä½œä¸ºçº¿ç¨‹åŒæ­¥çš„å·¥å…·ã€‚</p><p><code>BlockingQueue</code>å…·æœ‰ä¸€ä¸ªç‰¹å¾ï¼šå½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘<code>BlockingQueue</code>ä¸­æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™è¯¥çº¿ç¨‹è¢«é˜»å¡ï¼›å½“æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»<code>BlockingQueue</code>ä¸­å–å‡ºå…ƒç´ æ—¶ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—å·²ç©ºï¼Œåˆ™è¯¥çº¿ç¨‹è¢«é˜»å¡ã€‚</p><p><code>BlockingQueue</code>æä¾›å¦‚ä¸‹ä¸¤ä¸ªæ”¯æŒé˜»å¡çš„æ–¹æ³•ã€‚</p><ul><li><code>put(E e)</code>ï¼šå°è¯•æŠŠ<code>E</code>å…ƒç´ æ”¾å…¥<code>BlockingQueue</code>ä¸­ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—çš„å…ƒç´ å·²æ»¡ï¼Œåˆ™é˜»å¡è¯¥çº¿ç¨‹ã€‚</li><li><code>take()</code>ï¼šå°è¯•ä»<code>BlockingQueue</code>çš„å¤´éƒ¨å–å‡ºå…ƒç´ ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—çš„å…ƒç´ å·²ç©ºï¼Œåˆ™é˜»å¡è¯¥çº¿ç¨‹ã€‚</li></ul><p><code>BlockingQueue</code>ç»§æ‰¿äº†<code>Queue</code>æ¥å£ï¼Œå¯ä½¿ç”¨<code>Queue</code>æ¥å£ä¸­çš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•å½’çº³èµ·æ¥å¯åˆ†ä¸ºå¦‚ä¸‹ 3 ç»„ã€‚</p><ul><li>åœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥å…ƒç´ ã€‚åŒ…æ‹¬<code>add(E e)</code>ã€<code>offer(E e)</code>å’Œ<code>put(E e)</code>æ–¹æ³•ï¼Œå½“è¯¥é˜Ÿåˆ—å·²æ»¡æ—¶ï¼Œè¿™ 3 ä¸ªæ–¹æ³•åˆ†åˆ«ä¼šæŠ›å‡ºå¼‚å¸¸ã€è¿”å›<code>false</code>ã€é˜»å¡é˜Ÿåˆ—ã€‚</li><li>åœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤å¹¶è¿”å›åˆ é™¤çš„å…ƒç´ ã€‚åŒ…æ‹¬<code>remove()</code>ã€<code>poll()</code>å’Œ<code>take()</code>æ–¹æ³•ã€‚å½“è¯¥é˜Ÿåˆ—å·²ç©ºæ—¶ï¼Œè¿™ 3 ä¸ªæ–¹æ³•åˆ†åˆ«ä¼šæŠ›å‡ºå¼‚å¸¸ã€è¿”å›<code>false</code>ã€é˜»å¡é˜Ÿåˆ—ã€‚</li><li>åœ¨é˜Ÿåˆ—å¤´éƒ¨å–å‡ºä½†ä¸åˆ é™¤å…ƒç´ ã€‚åŒ…æ‹¬<code>element()</code>å’Œ<code>peek()</code>æ–¹æ³•ï¼Œå½“é˜Ÿåˆ—å·²ç©ºæ—¶ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«æŠ›å‡ºå¼‚å¸¸ã€è¿”å›<code>false</code>ã€‚</li></ul><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208202104417.jpeg" alt="epub_681336_2209"></p><p><code>BlockingQueue</code>ä¸å…¶å®ç°ç±»ï¼š</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208202102081.jpeg" alt="epub_681336_2207"></p><p>ä»¥é»‘è‰²æ–¹æ¡†æ¡†å‡ºçš„éƒ½æ˜¯ Java 7 æ–°å¢çš„é˜»å¡é˜Ÿåˆ—ã€‚</p><p><code>BlockingQueue</code>åŒ…å«çš„ 5 ä¸ªå®ç°ç±»ã€‚</p><ul><li><p><code>ArrayBlockingQueue</code>ï¼šåŸºäºæ•°ç»„å®ç°çš„<code>BlockingQueue</code>é˜Ÿåˆ—ã€‚</p></li><li><p><code>LinkedBlockingQueue</code>ï¼šåŸºäºé“¾è¡¨å®ç°çš„<code>BlockingQueue</code>é˜Ÿåˆ—ã€‚</p></li><li><p><code>PriorityBlockingQueue</code>ï¼šå®ƒå¹¶ä¸æ˜¯æ ‡å‡†çš„é˜»å¡é˜Ÿåˆ—ã€‚</p><p>ä¸<code>PriorityQueue</code>ç±»ä¼¼ï¼Œè¯¥é˜Ÿåˆ—è°ƒç”¨<code>remove()</code>ã€<code>poll()</code>ã€<code>take()</code>ç­‰æ–¹æ³•å–å‡ºå…ƒç´ æ—¶ï¼Œå¹¶ä¸æ˜¯å–å‡ºé˜Ÿåˆ—ä¸­å­˜åœ¨æ—¶é—´æœ€é•¿çš„å…ƒç´ ï¼Œè€Œæ˜¯é˜Ÿåˆ—ä¸­æœ€å°çš„å…ƒç´ ã€‚</p><p><code>PriorityBlockingQueue</code>åˆ¤æ–­å…ƒç´ çš„å¤§å°å³å¯æ ¹æ®å…ƒç´ ï¼ˆå®ç°<code>Comparable</code>æ¥å£ï¼‰çš„æœ¬èº«å¤§å°æ¥è‡ªç„¶æ’åºï¼Œä¹Ÿå¯ä½¿ç”¨<code>Comparator</code>è¿›è¡Œå®šåˆ¶æ’åºã€‚</p></li><li><p><code>SynchronousQueue</code>ï¼šåŒæ­¥é˜Ÿåˆ—ã€‚å¯¹è¯¥é˜Ÿåˆ—çš„å­˜ã€å–æ“ä½œå¿…é¡»äº¤æ›¿è¿›è¡Œã€‚</p></li><li><p><code>DelayQueue</code>ï¼šå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„<code>BlockingQueue</code>ï¼Œåº•å±‚åŸºäº<code>PriorityBlockingQueue</code>å®ç°ã€‚</p><p>ä¸è¿‡ï¼Œ <code>DelayQueue</code>è¦æ±‚é›†åˆå…ƒç´ éƒ½å®ç°<code>Delay</code>æ¥å£ï¼ˆè¯¥æ¥å£é‡Œåªæœ‰ä¸€ä¸ª<code>long getDelay()</code>æ–¹æ³•ï¼‰ï¼Œ <code>DelayQueue</code>æ ¹æ®é›†åˆå…ƒç´ çš„<code>getDalay()</code>æ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œæ’åºã€‚</p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockingQueueTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// å®šä¹‰ä¸€ä¸ªé•¿åº¦ä¸º2çš„é˜»å¡é˜Ÿåˆ—</span>
    <span class="token class-name">BlockingQueue</span> bq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bq<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸bq.add(&quot;Java&quot;ã€bq.offer(&quot;Java&quot;)ç›¸åŒ</span>
    bq<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸bq.add(&quot;Java&quot;ã€bq.offer(&quot;Java&quot;)ç›¸åŒ</span>
    bq<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//â‘  é˜»å¡çº¿ç¨‹</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ©ç”¨<code>BlockingQueue</code>æ¥å®ç°çº¿ç¨‹é€šä¿¡ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bq<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Producer</span><span class="token punctuation">(</span><span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bq<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bq <span class="token operator">=</span> bq<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> strArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Struts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Spring&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">999999999</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ç”Ÿäº§è€…å‡†å¤‡ç”Ÿäº§é›†åˆå…ƒç´ ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°è¯•æ”¾å…¥å…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡</span>
        bq<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>strArr<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ç”Ÿäº§å®Œæˆï¼š&quot;</span> <span class="token operator">+</span> bq<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bq<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Consumer</span><span class="token punctuation">(</span><span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bq<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bq <span class="token operator">=</span> bq<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;æ¶ˆè´¹è€…å‡†å¤‡æ¶ˆè´¹é›†åˆå…ƒç´ ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°è¯•å–å‡ºå…ƒç´ ï¼Œå¦‚æœé˜Ÿåˆ—å·²ç©ºï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡</span>
        bq<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ex<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;æ¶ˆè´¹å®Œæˆï¼š&quot;</span> <span class="token operator">+</span> bq<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockingQueueTest2</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºä¸€ä¸ªå®¹é‡ä¸º1çš„BlockingQueue</span>
    <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¯åŠ¨3ä¸ªç”Ÿäº§è€…çº¿ç¨‹</span>
    <span class="token keyword">new</span> <span class="token class-name">Producer</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Producer</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Producer</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹</span>
    <span class="token keyword">new</span> <span class="token class-name">Consumer</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸" aria-hidden="true">#</a> çº¿ç¨‹ç»„å’Œæœªå¤„ç†çš„å¼‚å¸¸</h2><p>Java ä½¿ç”¨<code>ThreadGroup</code>æ¥è¡¨ç¤ºçº¿ç¨‹ç»„ï¼Œå®ƒå¯ä»¥å¯¹ä¸€æ‰¹çº¿ç¨‹è¿›è¡Œåˆ†ç±»ç®¡ç†ï¼ŒJava å…è®¸ç¨‹åºç›´æ¥å¯¹çº¿ç¨‹ç»„è¿›è¡Œæ§åˆ¶ã€‚</p><p>å¯¹çº¿ç¨‹ç»„çš„æ§åˆ¶ç›¸å½“äºåŒæ—¶æ§åˆ¶è¿™æ‰¹çº¿ç¨‹ã€‚ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰çº¿ç¨‹éƒ½å±äºæŒ‡å®šçº¿ç¨‹ç»„ï¼Œå¦‚æœç¨‹åºæ²¡æœ‰æ˜¾å¼æŒ‡å®šçº¿ç¨‹å±äºå“ªä¸ªçº¿ç¨‹ç»„ï¼Œåˆ™è¯¥çº¿ç¨‹å±äºé»˜è®¤çº¿ç¨‹ç»„ã€‚</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå­çº¿ç¨‹å’Œåˆ›å»ºå®ƒçš„çˆ¶çº¿ç¨‹å¤„äºåŒä¸€ä¸ªçº¿ç¨‹ç»„å†…ï¼Œä¾‹å¦‚ A çº¿ç¨‹åˆ›å»ºäº† B çº¿ç¨‹ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®š B çº¿ç¨‹çš„çº¿ç¨‹ç»„ï¼Œåˆ™ B çº¿ç¨‹å±äº A çº¿ç¨‹æ‰€åœ¨çš„çº¿ç¨‹ç»„ã€‚</p><p>ä¸€æ—¦æŸä¸ªçº¿ç¨‹åŠ å…¥äº†æŒ‡å®šçº¿ç¨‹ç»„ä¹‹åï¼Œè¯¥çº¿ç¨‹å°†ä¸€ç›´å±äºè¯¥çº¿ç¨‹ç»„ï¼Œç›´åˆ°è¯¥çº¿ç¨‹æ­»äº¡ï¼Œçº¿ç¨‹è¿è¡Œä¸­é€”ä¸èƒ½æ”¹å˜å®ƒæ‰€å±çš„çº¿ç¨‹ç»„ã€‚</p><p><code>Thread</code>ç±»æä¾›äº†å¦‚ä¸‹å‡ ä¸ªæ„é€ å™¨æ¥è®¾ç½®æ–°åˆ›å»ºçš„çº¿ç¨‹å±äºå“ªä¸ªçº¿ç¨‹ç»„ã€‚</p><ul><li><code>Thread(ThreadGroup group, Runnable target)</code>ï¼šä»¥<code>target</code>çš„<code>run()</code>æ–¹æ³•ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“åˆ›å»ºæ–°çº¿ç¨‹ï¼Œå±äº<code>group</code>çº¿ç¨‹ç»„ã€‚</li><li><code>Thread(ThreadGroup group, Runnable target, String name)</code>ï¼šä»¥<code>target</code>çš„<code>run()</code>æ–¹æ³•ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“åˆ›å»ºæ–°çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹å±äº<code>group</code>çº¿ç¨‹ç»„ï¼Œä¸”çº¿ç¨‹åä¸º<code>name</code>ã€‚</li><li><code>Thread(ThreadGroup group, String name)</code>ï¼šåˆ›å»ºæ–°çº¿ç¨‹ï¼Œæ–°çº¿ç¨‹åä¸º<code>name</code>ï¼Œå±äº<code>group</code>çº¿ç¨‹ç»„ã€‚</li></ul><p><code>Thread</code>ç±»æ²¡æœ‰æä¾›äº†ä¸€ä¸ª<code>getThreadGroup()</code>æ–¹æ³•æ¥è¿”å›è¯¥çº¿ç¨‹æ‰€å±çš„çº¿ç¨‹ç»„ï¼Œ<code>getThreadGroup()</code>æ–¹æ³•çš„è¿”å›å€¼æ˜¯<code>ThreadGroup</code>å¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ç»„ã€‚<code>ThreadGroup</code>ç±»æä¾›äº†å¦‚ä¸‹ä¸¤ä¸ªç®€å•çš„æ„é€ å™¨æ¥åˆ›å»ºå®ä¾‹ã€‚</p><ul><li><code>ThreadGroup(String name)</code>ï¼šä»¥æŒ‡å®šçš„çº¿ç¨‹ç»„åå­—æ¥åˆ›å»ºæ–°çš„çº¿ç¨‹ç»„ã€‚</li><li><code>ThreadGroup(ThreadGroup parent, String name)</code>ï¼šä»¥æŒ‡å®šçš„åå­—ã€æŒ‡å®šçš„çˆ¶çº¿ç¨‹ç»„åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ç»„ã€‚</li></ul><p>çº¿ç¨‹ç»„é€šè¿‡è°ƒç”¨<code>ThreadGroup</code>çš„<code>getName()</code>æ–¹æ³•æ¥è·å–åå­—ï¼Œä½†ä¸å…è®¸æ”¹å˜çº¿ç¨‹ç»„çš„åå­—ã€‚</p><p><code>ThreadGroup</code>ç±»æä¾›äº†å¦‚ä¸‹å‡ ä¸ªå¸¸ç”¨çš„æ–¹æ³•æ¥æ“ä½œæ•´ä¸ªçº¿ç¨‹ç»„é‡Œçš„æ‰€æœ‰çº¿ç¨‹ã€‚</p><ul><li><p><code>int activeCount()</code>ï¼šè¿”å›æ­¤çº¿ç¨‹ç»„ä¸­æ´»åŠ¨çº¿ç¨‹çš„æ•°ç›®ã€‚</p></li><li><p><code>interrupt()</code>ï¼šä¸­æ–­æ­¤çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰çº¿ç¨‹ã€‚</p></li><li><p><code>isDaemon()</code>ï¼šåˆ¤æ–­è¯¥çº¿ç¨‹ç»„æ˜¯å¦æ˜¯åå°çº¿ç¨‹ç»„ã€‚</p></li><li><p><code>setDaemon(boolean daemon)</code>ï¼šæŠŠè¯¥çº¿ç¨‹ç»„è®¾ç½®æˆåå°çº¿ç¨‹ç»„ã€‚</p><p>åå°çº¿ç¨‹ç»„å…·æœ‰ä¸€ä¸ªç‰¹å¾â€”â€”å½“åå°çº¿ç¨‹ç»„çš„æœ€åä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸæˆ–æœ€åä¸€ä¸ªçº¿ç¨‹è¢«é”€æ¯åï¼Œåå°çº¿ç¨‹ç»„å°†è‡ªåŠ¨é”€æ¯ã€‚</p></li><li><p><code>setMaxPriority(int pri)</code>ï¼šè®¾ç½®çº¿ç¨‹ç»„çš„æœ€é«˜ä¼˜å…ˆçº§ã€‚</p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// æä¾›æŒ‡å®šçº¿ç¨‹åçš„æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æä¾›æŒ‡å®šçº¿ç¨‹åã€çº¿ç¨‹ç»„çš„æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token class-name">ThreadGroup</span> group<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>group<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; çº¿ç¨‹çš„iå˜é‡&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadGroupTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–ä¸»çº¿ç¨‹æ‰€åœ¨çš„çº¿ç¨‹ç»„ï¼Œè¿™æ˜¯æ‰€æœ‰çº¿ç¨‹é»˜è®¤çš„çº¿ç¨‹ç»„</span>
    <span class="token class-name">ThreadGroup</span> mainGroup <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getThreadGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»çº¿ç¨‹ç»„çš„åå­—ï¼š&quot;</span>
        <span class="token operator">+</span> mainGroup<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»çº¿ç¨‹ç»„æ˜¯å¦æ˜¯åå°çº¿ç¨‹ç»„ï¼š&quot;</span>
        <span class="token operator">+</span> mainGroup<span class="token punctuation">.</span><span class="token function">isDaemon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸»çº¿ç¨‹ç»„çš„çº¿ç¨‹&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ThreadGroup</span> tg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadGroup</span><span class="token punctuation">(</span><span class="token string">&quot;æ–°çº¿ç¨‹ç»„&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tg<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;tgçº¿ç¨‹ç»„æ˜¯å¦æ˜¯åå°çº¿ç¨‹ç»„ï¼š&quot;</span>
        <span class="token operator">+</span> tg<span class="token punctuation">.</span><span class="token function">isDaemon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">MyThread</span> tt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span>tg<span class="token punctuation">,</span> <span class="token string">&quot;tgç»„çš„çº¿ç¨‹ç”²&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tt<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span>tg<span class="token punctuation">,</span> <span class="token string">&quot;tgç»„çš„çº¿ç¨‹ä¹™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä» Java 5 å¼€å§‹ï¼ŒJava åŠ å¼ºäº†çº¿ç¨‹çš„å¼‚å¸¸å¤„ç†ï¼Œå¦‚æœçº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†ä¸€ä¸ªæœªå¤„ç†å¼‚å¸¸ï¼ŒJVM åœ¨ç»“æŸè¯¥çº¿ç¨‹ä¹‹å‰ä¼šè‡ªåŠ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å¯¹åº”çš„<code>Thread.UncaughtExceptionHandler</code>å¯¹è±¡ï¼Œå¦‚æœæ‰¾åˆ°è¯¥å¤„ç†å™¨å¯¹è±¡ï¼Œåˆ™ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„<code>uncaughtException(Thread t, Throwable e)</code>æ–¹æ³•æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</p><p><code>Thread.UncaughtExceptionHandler</code>æ˜¯<code>Thread</code>ç±»çš„ä¸€ä¸ªé™æ€å†…éƒ¨æ¥å£ï¼Œè¯¥æ¥å£å†…åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼š<code>void uncaughtException(Thread t, Throwable e)</code>ï¼Œè¯¥æ–¹æ³•ä¸­çš„<code>t</code>ä»£è¡¨å‡ºç°å¼‚å¸¸çš„çº¿ç¨‹ï¼Œè€Œ<code>e</code>ä»£è¡¨è¯¥çº¿ç¨‹æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p><p><code>Thread</code>ç±»æä¾›äº†å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•æ¥è®¾ç½®å¼‚å¸¸å¤„ç†å™¨ã€‚</p><ul><li><code>static setDefaultUncaughtExceptionHandler(Thread.UncaughtExceptionHandler eh)</code>ï¼šä¸ºè¯¥çº¿ç¨‹ç±»çš„æ‰€æœ‰çº¿ç¨‹å®ä¾‹è®¾ç½®é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ã€‚</li><li><code>setUncaughtExceptionHandler(Thread.UncaughtExceptionHandler eh)</code>ï¼šä¸ºæŒ‡å®šçš„çº¿ç¨‹å®ä¾‹è®¾ç½®å¼‚å¸¸å¤„ç†å™¨ã€‚</li></ul><p><code>ThreadGroup</code>ç±»å®ç°äº†<code>Thread.UncaughtExceptionHandler</code>æ¥å£ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹æ‰€å±çš„çº¿ç¨‹ç»„å°†ä¼šä½œä¸ºé»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹æŠ›å‡ºæœªå¤„ç†å¼‚å¸¸æ—¶ï¼ŒJVM ä¼šé¦–å…ˆæŸ¥æ‰¾è¯¥å¼‚å¸¸å¯¹åº”çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆ<code>setUncaughtExceptionHandler()</code>æ–¹æ³•è®¾ç½®çš„å¼‚å¸¸å¤„ç†å™¨ï¼‰ï¼Œå¦‚æœæ‰¾åˆ°è¯¥å¼‚å¸¸å¤„ç†å™¨ï¼Œåˆ™å°†è°ƒç”¨è¯¥å¼‚å¸¸å¤„ç†å™¨å¤„ç†è¯¥å¼‚å¸¸ï¼›å¦åˆ™ï¼ŒJVM å°†ä¼šè°ƒç”¨è¯¥çº¿ç¨‹æ‰€å±çš„çº¿ç¨‹ç»„å¯¹è±¡çš„<code>uncaughtException()</code>æ–¹æ³•æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</p><p>çº¿ç¨‹ç»„å¤„ç†å¼‚å¸¸çš„é»˜è®¤æµç¨‹å¦‚ä¸‹ã€‚</p><ol><li>å¦‚æœè¯¥çº¿ç¨‹ç»„æœ‰çˆ¶çº¿ç¨‹ç»„ï¼Œåˆ™è°ƒç”¨çˆ¶çº¿ç¨‹ç»„çš„<code>uncaughtException()</code>æ–¹æ³•æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</li><li>å¦‚æœè¯¥çº¿ç¨‹å®ä¾‹æ‰€å±çš„çº¿ç¨‹ç±»æœ‰é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆç”±<code>setDefaultUncaughtExceptionHandler()</code>æ–¹æ³•è®¾ç½®çš„å¼‚å¸¸å¤„ç†å™¨ï¼‰ï¼Œé‚£ä¹ˆå°±è°ƒç”¨è¯¥å¼‚å¸¸å¤„ç†å™¨æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</li><li>å¦‚æœè¯¥å¼‚å¸¸å¯¹è±¡æ˜¯<code>ThreadDeath</code>çš„å¯¹è±¡ï¼Œåˆ™ä¸åšä»»ä½•å¤„ç†ï¼›å¦åˆ™ï¼Œå°†å¼‚å¸¸è·Ÿè¸ªæ ˆçš„ä¿¡æ¯æ‰“å°åˆ°<code>System.err</code>é”™è¯¯è¾“å‡ºæµï¼Œå¹¶ç»“æŸè¯¥çº¿ç¨‹ã€‚</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">MyExHandler</span> <span class="token keyword">implements</span> <span class="token class-name">Thread<span class="token punctuation">.</span>UncaughtExceptionHandler</span> <span class="token punctuation">{</span>

  <span class="token comment">// å®ç°uncaughtException()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†å¤„ç†çº¿ç¨‹çš„æœªå¤„ç†å¼‚å¸¸</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uncaughtException</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>t <span class="token operator">+</span> <span class="token string">&quot; çº¿ç¨‹å‡ºç°äº†å¼‚å¸¸ï¼š&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExHandler</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¾ç½®ä¸»çº¿ç¨‹çš„å¼‚å¸¸å¤„ç†å™¨</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setUncaughtExceptionHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyExHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token comment">//â‘ </span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç¨‹åºæ­£å¸¸ç»“æŸï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¯¥ç¨‹åºï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208221323663.png" alt="image-20220822132326025"></p><p>è™½ç„¶ç¨‹åºä¸­æŒ‡å®šäº†å¼‚å¸¸å¤„ç†å™¨å¯¹æœªæ•è·çš„å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œè€Œä¸”è¯¥å¼‚å¸¸å¤„ç†å™¨ä¹Ÿç¡®å®èµ·ä½œç”¨äº†ï¼Œä½†ç¨‹åºä¾ç„¶ä¸ä¼šæ­£å¸¸ç»“æŸã€‚è¿™è¯´æ˜å¼‚å¸¸å¤„ç†å™¨ä¸é€šè¿‡ catch æ•è·å¼‚å¸¸æ˜¯ä¸åŒçš„â€”â€”å½“ä½¿ç”¨ catch æ•è·å¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸ä¸ä¼šå‘ä¸Šä¼ æ’­ç»™ä¸Šä¸€çº§è°ƒç”¨è€…ï¼›ä½†ä½¿ç”¨å¼‚å¸¸å¤„ç†å™¨å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ä¹‹åï¼Œå¼‚å¸¸ä¾ç„¶ä¼šä¼ æ’­ç»™ä¸Šä¸€çº§è°ƒç”¨è€…ã€‚</p><h2 id="çº¿ç¨‹æ± " tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹æ± " aria-hidden="true">#</a> çº¿ç¨‹æ± </h2><p>Java è¯­è¨€è™½ç„¶å†…ç½®äº†å¤šçº¿ç¨‹æ”¯æŒï¼Œå¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯ï¼Œåˆ›å»ºçº¿ç¨‹éœ€è¦æ“ä½œç³»ç»Ÿèµ„æºï¼ˆçº¿ç¨‹èµ„æºï¼Œæ ˆç©ºé—´ç­‰ï¼‰ï¼Œé¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¤§é‡çº¿ç¨‹éœ€è¦æ¶ˆè€—å¤§é‡æ—¶é—´ã€‚</p><p>å¦‚æœå¯ä»¥å¤ç”¨ä¸€ç»„çº¿ç¨‹ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>â”Œâ”€â”€â”€â”€â”€â” execute  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Task1â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="token operator">&gt;</span>â”‚ThreadPool        â”‚
â”œâ”€â”€â”€â”€â”€â”¤          â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚Task2â”‚          â”‚â”‚Thread1â”‚â”‚Thread2â”‚â”‚
â”œâ”€â”€â”€â”€â”€â”¤          â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚Task3â”‚          â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚
â”œâ”€â”€â”€â”€â”€â”¤          â”‚â”‚Thread3â”‚â”‚Thread4â”‚â”‚
â”‚Task4â”‚          â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”¤          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚Task5â”‚
â”œâ”€â”€â”€â”€â”€â”¤
â”‚Task6â”‚
â””â”€â”€â”€â”€â”€â”˜
  <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠå¾ˆå¤šå°ä»»åŠ¡è®©ä¸€ç»„çº¿ç¨‹æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä»»åŠ¡å¯¹åº”ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚è¿™ç§èƒ½æ¥æ”¶å¤§é‡å°ä»»åŠ¡å¹¶è¿›è¡Œåˆ†å‘å¤„ç†çš„å°±æ˜¯çº¿ç¨‹æ± ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œçº¿ç¨‹æ± å†…éƒ¨ç»´æŠ¤äº†è‹¥å¹²ä¸ªçº¿ç¨‹ï¼Œæ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™ï¼Œè¿™äº›çº¿ç¨‹éƒ½å¤„äºç­‰å¾…çŠ¶æ€ã€‚å¦‚æœæœ‰æ–°ä»»åŠ¡ï¼Œå°±åˆ†é…ä¸€ä¸ªç©ºé—²çº¿ç¨‹æ‰§è¡Œã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½å¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œæ–°ä»»åŠ¡è¦ä¹ˆæ”¾å…¥é˜Ÿåˆ—ç­‰å¾…ï¼Œè¦ä¹ˆå¢åŠ ä¸€ä¸ªæ–°çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚</p><h3 id="å®ç°çš„çº¿ç¨‹æ± " tabindex="-1"><a class="header-anchor" href="#å®ç°çš„çº¿ç¨‹æ± " aria-hidden="true">#</a> å®ç°çš„çº¿ç¨‹æ± </h3><p>Java 5 æ–°å¢äº†ä¸€ä¸ª<code>Executors</code>å·¥å‚ç±»æ¥äº§ç”Ÿçº¿ç¨‹æ± ï¼Œè¯¥å·¥å‚ç±»åŒ…å«å¦‚ä¸‹å‡ ä¸ªé™æ€å·¥å‚æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚</p><ul><li><p><code>newCachedThreadPool()</code>ï¼šåˆ›å»ºä¸€ä¸ªå…·æœ‰ç¼“å­˜åŠŸèƒ½çš„çº¿ç¨‹æ± ï¼Œç³»ç»Ÿæ ¹æ®éœ€è¦åˆ›å»ºçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹å°†ä¼šè¢«ç¼“å­˜åœ¨çº¿ç¨‹æ± ä¸­ã€‚</p></li><li><p><code>newFixedThreadPool(int nThreads)</code>ï¼šåˆ›å»ºä¸€ä¸ªå¯é‡ç”¨çš„ã€å…·æœ‰å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ã€‚</p></li><li><p><code>newSingleThreadExecutor()</code>ï¼šåˆ›å»ºä¸€ä¸ªåªæœ‰å•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œå®ƒç›¸å½“äºè°ƒç”¨<code>newFixedThread Pool()</code>æ–¹æ³•æ—¶ä¼ å…¥å‚æ•°ä¸º 1ã€‚</p></li><li><p><code>newScheduledThreadPool(int corePoolSize)</code>ï¼šåˆ›å»ºå…·æœ‰æŒ‡å®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼Œå®ƒå¯ä»¥åœ¨æŒ‡å®šå»¶è¿Ÿåæ‰§è¡Œçº¿ç¨‹ä»»åŠ¡ã€‚</p><p><code>corePoolSize</code>æŒ‡æ± ä¸­æ‰€ä¿å­˜çš„çº¿ç¨‹æ•°ï¼Œå³ä½¿çº¿ç¨‹æ˜¯ç©ºé—²çš„ä¹Ÿè¢«ä¿å­˜åœ¨çº¿ç¨‹æ± å†…ã€‚</p></li><li><p><code>newSingleThreadScheduledExecutor()</code>ï¼šåˆ›å»ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œå®ƒå¯ä»¥åœ¨æŒ‡å®šå»¶è¿Ÿåæ‰§è¡Œçº¿ç¨‹ä»»åŠ¡ã€‚</p></li></ul><blockquote><p>å‰ 3 ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<code>ExecutorService</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå®ƒå¯ä»¥æ‰§è¡Œ<code>Runnable</code>å¯¹è±¡æˆ–<code>Callable</code>å¯¹è±¡æ‰€ä»£è¡¨çš„çº¿ç¨‹ï¼›</p><p>è€Œå 2 ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª<code>ScheduledExecutorService</code>çº¿ç¨‹æ± ï¼Œå®ƒæ˜¯<code>ExecutorService</code>çš„å­ç±»ï¼Œå®ƒå¯ä»¥åœ¨æŒ‡å®šå»¶è¿Ÿåæ‰§è¡Œçº¿ç¨‹ä»»åŠ¡ã€‚</p></blockquote><p><code>ExecutorService</code>ä»£è¡¨å°½å¿«æ‰§è¡Œçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼ˆåªè¦çº¿ç¨‹æ± ä¸­æœ‰ç©ºé—²çº¿ç¨‹ï¼Œå°±ç«‹å³æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡ï¼‰ï¼Œç¨‹åºåªè¦å°†ä¸€ä¸ª<code>Runnable</code>å¯¹è±¡æˆ–<code>Callable</code>å¯¹è±¡ï¼ˆä»£è¡¨çº¿ç¨‹ä»»åŠ¡ï¼‰æäº¤ç»™è¯¥çº¿ç¨‹æ± ï¼Œè¯¥çº¿ç¨‹æ± å°±ä¼šå°½å¿«æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚<code>ExecutorService</code>é‡Œæä¾›äº†å¦‚ä¸‹ 3 ä¸ªæ–¹æ³•ã€‚</p><ul><li><p><code>Future&lt;?&gt; submit(Runnable task)</code>ï¼šå°†ä¸€ä¸ª<code>Runnable</code>å¯¹è±¡æäº¤ç»™æŒ‡å®šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å°†åœ¨æœ‰ç©ºé—²çº¿ç¨‹æ—¶æ‰§è¡Œ<code>Runnable</code>å¯¹è±¡ä»£è¡¨çš„ä»»åŠ¡ã€‚</p><p>å…¶ä¸­<code>Future</code>å¯¹è±¡ä»£è¡¨<code>Runnable</code>ä»»åŠ¡çš„è¿”å›å€¼â€”â€”ä½†<code>run()</code>æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥<code>Future</code>å¯¹è±¡å°†åœ¨<code>run()</code>æ–¹æ³•æ‰§è¡Œç»“æŸåè¿”å›<code>null</code>ã€‚</p><p>ä½†å¯ä»¥è°ƒç”¨<code>Future</code>çš„<code>isDone()</code>ã€<code>isCancelled()</code>æ–¹æ³•æ¥è·å¾—<code>Runnable</code>å¯¹è±¡çš„æ‰§è¡ŒçŠ¶æ€ã€‚</p></li><li><p><code>&lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result)</code>ï¼šå°†ä¸€ä¸ª<code>Runnable</code>å¯¹è±¡æäº¤ç»™æŒ‡å®šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å°†åœ¨æœ‰ç©ºé—²çº¿ç¨‹æ—¶æ‰§è¡Œ<code>Runnable</code>å¯¹è±¡ä»£è¡¨çš„ä»»åŠ¡ã€‚</p><p>å…¶ä¸­<code>result</code>æ˜¾å¼æŒ‡å®šçº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ï¼Œæ‰€ä»¥<code>Future</code>å¯¹è±¡å°†åœ¨<code>run()</code>æ–¹æ³•æ‰§è¡Œç»“æŸåè¿”å›<code>result</code>ã€‚</p></li><li><p><code>&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task)</code>ï¼šå°†ä¸€ä¸ª<code>Callable</code>å¯¹è±¡æäº¤ç»™æŒ‡å®šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å°†åœ¨æœ‰ç©ºé—²çº¿ç¨‹æ—¶æ‰§è¡Œ<code>Callable</code>å¯¹è±¡ä»£è¡¨çš„ä»»åŠ¡ã€‚</p><p>å…¶ä¸­<code>Future</code>ä»£è¡¨<code>Callable</code>å¯¹è±¡é‡Œ<code>call()</code>æ–¹æ³•çš„è¿”å›å€¼ã€‚</p></li></ul><p><code>ScheduledExecutorService</code>ä»£è¡¨å¯åœ¨æŒ‡å®šå»¶è¿Ÿåæˆ–å‘¨æœŸæ€§åœ°æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡çš„çº¿ç¨‹æ± ï¼Œå®ƒæä¾›äº†å¦‚ä¸‹ 4 ä¸ªæ–¹æ³•ã€‚</p><ul><li><p><code>ScheduledFuture&lt;?&gt; schedule(Runnable command, long delay,TimeUnit unit)</code>ï¼šæŒ‡å®š<code>command</code>ä»»åŠ¡å°†åœ¨<code>delay</code>å»¶è¿Ÿåæ‰§è¡Œã€‚</p></li><li><p><code>ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command, long initialDelay, long period, TimeUnit unit)</code>ï¼šæŒ‡å®š<code>command</code>ä»»åŠ¡å°†åœ¨<code>delay</code>å»¶è¿Ÿåæ‰§è¡Œï¼Œè€Œä¸”ä»¥è®¾å®šé¢‘ç‡é‡å¤æ‰§è¡Œã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨<code>initialDelay</code>åå¼€å§‹æ‰§è¡Œï¼Œä¾æ¬¡åœ¨<code>initialDelay+period</code>ã€<code>initialDelay+2 * periodâ€¦</code>å¤„é‡å¤æ‰§è¡Œï¼Œä¾æ­¤ç±»æ¨ã€‚</p></li><li><p><code>ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,long initialDelay, long delay,TimeUnit unit)</code>ï¼šåˆ›å»ºå¹¶æ‰§è¡Œä¸€ä¸ªåœ¨ç»™å®šåˆå§‹å»¶è¿Ÿåé¦–æ¬¡å¯ç”¨çš„å®šæœŸæ“ä½œï¼Œéšååœ¨æ¯ä¸€æ¬¡æ‰§è¡Œç»ˆæ­¢å’Œä¸‹ä¸€æ¬¡æ‰§è¡Œå¼€å§‹ä¹‹é—´éƒ½å­˜åœ¨ç»™å®šçš„å»¶è¿Ÿã€‚</p><p>å¦‚æœä»»åŠ¡åœ¨ä»»ä¸€æ¬¡æ‰§è¡Œæ—¶é‡åˆ°å¼‚å¸¸ï¼Œå°±ä¼šå–æ¶ˆåç»­æ‰§è¡Œï¼›å¦åˆ™ï¼Œåªèƒ½é€šè¿‡ç¨‹åºæ¥æ˜¾å¼å–æ¶ˆæˆ–ç»ˆæ­¢è¯¥ä»»åŠ¡ã€‚</p></li></ul><p>å½“ç”¨å®Œä¸€ä¸ªçº¿ç¨‹æ± åï¼Œåº”è¯¥è°ƒç”¨è¯¥çº¿ç¨‹æ± çš„<code>shutdown()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†å¯åŠ¨çº¿ç¨‹æ± çš„å…³é—­åºåˆ—ï¼Œè°ƒç”¨<code>shutdown()</code>æ–¹æ³•åçš„çº¿ç¨‹æ± ä¸å†æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä½†ä¼šå°†ä»¥å‰æ‰€æœ‰å·²æäº¤ä»»åŠ¡æ‰§è¡Œå®Œæˆã€‚</p><p>å½“çº¿ç¨‹æ± ä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåï¼Œæ± ä¸­çš„æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šæ­»äº¡ï¼›å¦å¤–ä¹Ÿå¯ä»¥è°ƒç”¨çº¿ç¨‹æ± çš„<code>shutdownNow()</code>æ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± ï¼Œè¯¥æ–¹æ³•è¯•å›¾åœæ­¢æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„æ´»åŠ¨ä»»åŠ¡ï¼Œæš‚åœå¤„ç†æ­£åœ¨ç­‰å¾…çš„ä»»åŠ¡ï¼Œå¹¶è¿”å›ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ã€‚</p><p>ä½¿ç”¨çº¿ç¨‹æ± æ¥æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡çš„æ­¥éª¤å¦‚ä¸‹ã€‚</p><ol><li>è°ƒç”¨<code>Executors</code>ç±»çš„é™æ€å·¥å‚æ–¹æ³•åˆ›å»ºä¸€ä¸ª<code>ExecutorService</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹æ± ã€‚</li><li>åˆ›å»º<code>Runnable</code>å®ç°ç±»æˆ–<code>Callable</code>å®ç°ç±»çš„å®ä¾‹ï¼Œä½œä¸ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚</li><li>è°ƒç”¨<code>ExecutorService</code>å¯¹è±¡çš„<code>submit()</code>æ–¹æ³•æ¥æäº¤<code>Runnable</code>å®ä¾‹æˆ–<code>Callable</code>å®ä¾‹ã€‚</li><li>å½“ä¸æƒ³æäº¤ä»»ä½•ä»»åŠ¡æ—¶ï¼Œè°ƒç”¨<code>ExecutorService</code>å¯¹è±¡çš„<code>shutdown()</code>æ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± ã€‚</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± :</span>
    <span class="token class-name">ExecutorService</span> es <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      es<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å…³é—­çº¿ç¨‹æ± :</span>
    es<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Task</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start task &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end task &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è§‚å¯Ÿæ‰§è¡Œç»“æœï¼Œä¸€æ¬¡æ€§æ”¾å…¥ 6 ä¸ªä»»åŠ¡ï¼Œç”±äºçº¿ç¨‹æ± åªæœ‰å›ºå®šçš„ 4 ä¸ªçº¿ç¨‹ï¼Œå› æ­¤ï¼Œå‰ 4 ä¸ªä»»åŠ¡ä¼šåŒæ—¶æ‰§è¡Œï¼Œç­‰åˆ°æœ‰çº¿ç¨‹ç©ºé—²åï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„ä¸¤ä¸ªä»»åŠ¡ã€‚</p><p>çº¿ç¨‹æ± åœ¨ç¨‹åºç»“æŸçš„æ—¶å€™è¦å…³é—­ã€‚ä½¿ç”¨<code>shutdown()</code>æ–¹æ³•å…³é—­çº¿ç¨‹æ± çš„æ—¶å€™ï¼Œå®ƒä¼šç­‰å¾…æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡å…ˆå®Œæˆï¼Œç„¶åå†å…³é—­ã€‚<code>shutdownNow()</code>ä¼šç«‹åˆ»åœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œ<code>awaitTermination()</code>åˆ™ä¼šç­‰å¾…æŒ‡å®šçš„æ—¶é—´è®©çº¿ç¨‹æ± å…³é—­ã€‚</p><p>å¦‚æœæŠŠçº¿ç¨‹æ± æ”¹ä¸º<code>CachedThreadPool</code>ï¼Œç”±äºè¿™ä¸ªçº¿ç¨‹æ± çš„å®ç°ä¼šæ ¹æ®ä»»åŠ¡æ•°é‡åŠ¨æ€è°ƒæ•´çº¿ç¨‹æ± çš„å¤§å°ï¼Œæ‰€ä»¥ 6 ä¸ªä»»åŠ¡å¯ä¸€æ¬¡æ€§å…¨éƒ¨åŒæ—¶æ‰§è¡Œã€‚</p><p>å¦‚æœæƒ³æŠŠçº¿ç¨‹æ± çš„å¤§å°é™åˆ¶åœ¨ 4 ï½ 10 ä¸ªä¹‹é—´åŠ¨æ€è°ƒæ•´æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬æŸ¥çœ‹<code>Executors.newCachedThreadPool()</code>æ–¹æ³•çš„æºç ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">,</span>
                                    <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ï¼Œæƒ³åˆ›å»ºæŒ‡å®šåŠ¨æ€èŒƒå›´çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span> min <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token class-name">ExecutorService</span> es <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> max<span class="token punctuation">,</span>
        <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="forkjoinpool" tabindex="-1"><a class="header-anchor" href="#forkjoinpool" aria-hidden="true">#</a> ForkJoinPool</h3><p>Java7 æä¾›äº†<code>ForkJoinPool</code>æ¥æ”¯æŒå°†ä¸€ä¸ªä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªâ€œå°ä»»åŠ¡â€å¹¶è¡Œè®¡ç®—ï¼Œå†æŠŠå¤šä¸ªâ€œå°ä»»åŠ¡â€çš„ç»“æœåˆå¹¶æˆæ€»çš„è®¡ç®—ç»“æœã€‚<code>ForkJoinPool</code>æ˜¯<code>ExecutorService</code>çš„å®ç°ç±»ï¼Œå› æ­¤æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹æ± ã€‚<code>ForkJoinPool</code>æä¾›äº†å¦‚ä¸‹ä¸¤ä¸ªå¸¸ç”¨çš„æ„é€ å™¨ã€‚</p><ul><li><code>ForkJoinPool(int parallelism)</code>ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«<code>parallelism</code>ä¸ªå¹¶è¡Œçº¿ç¨‹çš„<code>ForkJoinPool</code>ã€‚</li><li><code>ForkJoinPool()</code>ï¼šä»¥<code>Runtime.availableProcessors()</code>æ–¹æ³•çš„è¿”å›å€¼ä½œä¸º<code>parallelism</code>å‚æ•°æ¥åˆ›å»º<code>ForkJoinPool</code>ã€‚</li></ul><p>åˆ›å»ºäº†<code>ForkJoinPool</code>å®ä¾‹ä¹‹åï¼Œå°±å¯è°ƒç”¨<code>ForkJoinPool</code>çš„<code>submit(ForkJoinTask task)</code>æˆ–<code>invoke (ForkJoinTask task)</code>æ–¹æ³•æ¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡äº†ã€‚</p><p>å…¶ä¸­<code>ForkJoinTask</code>ä»£è¡¨ä¸€ä¸ªå¯ä»¥å¹¶è¡Œã€åˆå¹¶çš„ä»»åŠ¡ã€‚</p><p><code>ForkJoinTask</code>æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒè¿˜æœ‰ä¸¤ä¸ªæŠ½è±¡å­ç±»ï¼š<code>RecursiveAction</code>å’Œ<code>RecursiveTask</code>ã€‚</p><p>å…¶ä¸­<code>RecursiveTask</code>ä»£è¡¨æœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œè€Œ<code>RecursiveAction</code>ä»£è¡¨æ²¡æœ‰è¿”å›å€¼çš„ä»»åŠ¡ã€‚</p><p><code>ForkJoinPool</code>ã€<code>ForkJoinTask</code>ç­‰ç±»çš„ç±»å›¾ã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208221441392.jpeg" alt="epub_681336_2244"></p><p>ä¸‹é¢ä»¥æ‰§è¡Œæ²¡æœ‰è¿”å›å€¼çš„â€œå¤§ä»»åŠ¡â€ï¼ˆç®€å•åœ°æ‰“å° 0~300 çš„æ•°å€¼ï¼‰ä¸ºä¾‹ï¼Œç¨‹åºå°†ä¸€ä¸ªâ€œå¤§ä»»åŠ¡â€æ‹†åˆ†æˆå¤šä¸ªâ€œå°ä»»åŠ¡â€ï¼Œå¹¶å°†ä»»åŠ¡äº¤ç»™<code>ForkJoinPool</code>æ¥æ‰§è¡Œã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">PrintTask</span> <span class="token keyword">extends</span> <span class="token class-name">RecursiveAction</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ¯ä¸ªâ€œå°ä»»åŠ¡â€æœ€å¤šåªæ‰“å°50ä¸ªæ•°</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">THRESHOLD</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> start<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> end<span class="token punctuation">;</span>

  <span class="token comment">// æ‰“å°ä»startåˆ°endçš„ä»»åŠ¡</span>
  <span class="token keyword">public</span> <span class="token class-name">PrintTask</span><span class="token punctuation">(</span><span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> start<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> end<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å½“endä¸startä¹‹é—´çš„å·®å°äºTHRESHOLDæ—¶ï¼Œå¼€å§‹æ‰“å°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start <span class="token operator">&lt;</span> <span class="token constant">THRESHOLD</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> <span class="token string">&quot;çš„iå€¼ï¼š&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// å½“endä¸startä¹‹é—´çš„å·®å¤§äºTHRESHOLDï¼Œå³è¦æ‰“å°çš„æ•°è¶…è¿‡50ä¸ªæ—¶</span>
      <span class="token comment">// å°†å¤§ä»»åŠ¡åˆ†è§£æˆä¸¤ä¸ªâ€œå°ä»»åŠ¡â€</span>
      <span class="token keyword">int</span> middle <span class="token operator">=</span> <span class="token punctuation">(</span>start <span class="token operator">+</span> end<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token class-name">PrintTask</span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintTask</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">PrintTask</span> right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintTask</span><span class="token punctuation">(</span>middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¹¶è¡Œæ‰§è¡Œä¸¤ä¸ªâ€œå°ä»»åŠ¡â€</span>
      left<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      right<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ForkJoinPoolTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">ForkJoinPool</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æäº¤å¯åˆ†è§£çš„PrintTaskä»»åŠ¡</span>
    pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrintTask</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pool<span class="token punctuation">.</span><span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å…³é—­çº¿ç¨‹æ± </span>
    pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¨‹åºè™½ç„¶æ‰“å°äº† 0 ï½ 299 è¿™ 300 ä¸ªæ•°å­—ï¼Œä½†å¹¶ä¸æ˜¯è¿ç»­æ‰“å°çš„ï¼Œè¿™æ˜¯å› ä¸ºç¨‹åºå°†è¿™ä¸ªæ‰“å°ä»»åŠ¡è¿›è¡Œäº†åˆ†è§£ï¼Œåˆ†è§£åçš„ä»»åŠ¡ä¼šå¹¶è¡Œæ‰§è¡Œï¼Œæ‰€ä»¥ä¸ä¼šæŒ‰é¡ºåºä» 0 æ‰“å°åˆ° 299ã€‚</p><p>ä¸Šé¢å®šä¹‰çš„ä»»åŠ¡æ˜¯ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„æ‰“å°ä»»åŠ¡ï¼Œå¦‚æœä»»åŠ¡æ˜¯æœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œåˆ™å¯ä»¥è®©ä»»åŠ¡ç»§æ‰¿<code>RecursiveTask&lt;T&gt;</code>ï¼Œå…¶ä¸­æ³›å‹å‚æ•°<code>T</code>å°±ä»£è¡¨äº†è¯¥ä»»åŠ¡çš„è¿”å›å€¼ç±»å‹ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">CalTask</span> <span class="token keyword">extends</span> <span class="token class-name">RecursiveTask</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ¯ä¸ªâ€œå°ä»»åŠ¡â€æœ€å¤šåªç´¯åŠ 20ä¸ªæ•°</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">THRESHOLD</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> start<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> end<span class="token punctuation">;</span>

  <span class="token comment">// ç´¯åŠ ä»startåˆ°endçš„æ•°ç»„å…ƒç´ </span>
  <span class="token keyword">public</span> <span class="token class-name">CalTask</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>arr <span class="token operator">=</span> arr<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> start<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> end<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">protected</span> <span class="token class-name">Integer</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// å½“endä¸startä¹‹é—´çš„å·®å°äºTHRESHOLDæ—¶ï¼Œå¼€å§‹è¿›è¡Œå®é™…ç´¯åŠ </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start <span class="token operator">&lt;</span> <span class="token constant">THRESHOLD</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// å½“endä¸startä¹‹é—´çš„å·®å¤§äºTHRESHOLDï¼Œå³è¦æ‰“å°çš„æ•°è¶…è¿‡20ä¸ªæ—¶</span>
      <span class="token comment">// å°†å¤§ä»»åŠ¡åˆ†è§£æˆä¸¤ä¸ªâ€œå°ä»»åŠ¡â€</span>
      <span class="token keyword">int</span> middle <span class="token operator">=</span> <span class="token punctuation">(</span>start <span class="token operator">+</span> end<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token class-name">CalTask</span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CalTask</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> start<span class="token punctuation">,</span> middle<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">CalTask</span> right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CalTask</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¹¶è¡Œæ‰§è¡Œä¸¤ä¸ªâ€œå°ä»»åŠ¡â€</span>
      left<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      right<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// æŠŠä¸¤ä¸ªâ€œå°ä»»åŠ¡â€ç´¯åŠ çš„ç»“æœåˆå¹¶èµ·æ¥</span>
      <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>left<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>
          right<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//â‘ </span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sum</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">Random</span> rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆå§‹åŒ–100ä¸ªæ•°å­—å…ƒç´ </span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">int</span> tmp <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¯¹æ•°ç»„å…ƒç´ èµ‹å€¼ï¼Œå¹¶å°†æ•°ç»„å…ƒç´ çš„å€¼æ·»åŠ åˆ°totalæ€»å’Œä¸­</span>
      total <span class="token operator">+=</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ForkJoinPool</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ForkJoinPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æäº¤å¯åˆ†è§£çš„CalTaskä»»åŠ¡</span>
    <span class="token class-name">Future</span> future <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CalTask</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å…³é—­çº¿ç¨‹æ± </span>
    pool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="çº¿ç¨‹ç›¸å…³ç±»" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹ç›¸å…³ç±»" aria-hidden="true">#</a> çº¿ç¨‹ç›¸å…³ç±»</h2><p>Java è¿˜ä¸ºçº¿ç¨‹å®‰å…¨æä¾›äº†ä¸€äº›å·¥å…·ç±»ï¼Œå¦‚<code>ThreadLocal</code>ç±»ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡ï¼Œé€šè¿‡æŠŠæ•°æ®æ”¾åœ¨<code>ThreadLocal</code>ä¸­å°±å¯ä»¥è®©æ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªè¯¥å˜é‡çš„å‰¯æœ¬ï¼Œä»è€Œé¿å…å¹¶å‘è®¿é—®çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒJava 5 è¿˜æ–°å¢äº†å¤§é‡çš„çº¿ç¨‹å®‰å…¨ç±»ã€‚</p><h3 id="threadlocal" tabindex="-1"><a class="header-anchor" href="#threadlocal" aria-hidden="true">#</a> ThreadLocal</h3><p><code>ThreadLocal</code>ï¼Œæ˜¯ Thread Local Variableï¼ˆçº¿ç¨‹å±€éƒ¨å˜é‡ï¼‰çš„æ„æ€ã€‚çº¿ç¨‹å±€éƒ¨å˜é‡ï¼ˆ<code>ThreadLocal</code>ï¼‰çš„åŠŸç”¨å…¶å®éå¸¸ç®€å•ï¼Œå°±æ˜¯ä¸ºæ¯ä¸€ä¸ªä½¿ç”¨è¯¥å˜é‡çš„çº¿ç¨‹éƒ½æä¾›ä¸€ä¸ªå˜é‡å€¼çš„å‰¯æœ¬ï¼Œä½¿æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜è‡ªå·±çš„å‰¯æœ¬ï¼Œè€Œä¸ä¼šå’Œå…¶ä»–çº¿ç¨‹çš„å‰¯æœ¬å†²çªã€‚</p><p>ä»çº¿ç¨‹çš„è§’åº¦çœ‹ï¼Œå°±å¥½åƒæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å®Œå…¨æ‹¥æœ‰è¯¥å˜é‡ä¸€æ ·ã€‚</p><p><code>ThreadLocal</code>ç±»çš„ç”¨æ³•éå¸¸ç®€å•ï¼Œå®ƒåªæä¾›äº†å¦‚ä¸‹ 3 ä¸ª<code>public</code>æ–¹æ³•ã€‚</p><ul><li><code>T get()</code>ï¼šè¿”å›æ­¤çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­å½“å‰çº¿ç¨‹å‰¯æœ¬ä¸­çš„å€¼ã€‚</li><li><code>void remove()</code>ï¼šåˆ é™¤æ­¤çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­å½“å‰çº¿ç¨‹çš„å€¼ã€‚</li><li><code>void set(T value)</code>ï¼šè®¾ç½®æ­¤çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­å½“å‰çº¿ç¨‹å‰¯æœ¬ä¸­çš„å€¼ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Account2</span> <span class="token punctuation">{</span>

  <span class="token comment">/* å®šä¹‰ä¸€ä¸ªThreadLocalç±»å‹çš„å˜é‡ï¼Œè¯¥å˜é‡å°†æ˜¯ä¸€ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡
  æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šä¿ç•™è¯¥å˜é‡çš„ä¸€ä¸ªå‰¯æœ¬ */</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// å®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–nameå±æ€§çš„æ„é€ å™¨</span>
  <span class="token keyword">public</span> <span class="token class-name">Account2</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä¸‹é¢ä»£ç ç”¨äºè®¿é—®å½“å‰çº¿ç¨‹çš„nameå‰¯æœ¬çš„å€¼</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// nameçš„setterå’Œgetteræ–¹æ³•</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyTest</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

  <span class="token comment">// å®šä¹‰ä¸€ä¸ªAccountå±æ€§</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Account2</span> account2<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">MyTest</span><span class="token punctuation">(</span><span class="token class-name">Account2</span> account2<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>account2 <span class="token operator">=</span> account2<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¾ªç¯10æ¬¡</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å½“i==6æ—¶è¾“å‡ºå°†è´¦æˆ·åæ›¿æ¢æˆå½“å‰çº¿ç¨‹å</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        account2<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// è¾“å‡ºåŒä¸€ä¸ªè´¦æˆ·çš„è´¦æˆ·åå’Œå¾ªç¯å˜é‡</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>account2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token operator">+</span> <span class="token string">&quot; è´¦æˆ·çš„iå€¼ï¼š&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadLocalTest</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸¤ä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªAccount</span>
    <span class="token class-name">Account2</span> at <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account2</span><span class="token punctuation">(</span><span class="token string">&quot;åˆå§‹å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token comment">/*
                  è™½ç„¶ä¸¤ä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªè´¦æˆ·ï¼Œå³åªæœ‰ä¸€ä¸ªè´¦æˆ·å
                  ä½†ç”±äºè´¦æˆ·åæ˜¯ThreadLocalç±»å‹çš„ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹
                  éƒ½å®Œå…¨æ‹¥æœ‰å„è‡ªçš„è´¦æˆ·åå‰¯æœ¬ï¼Œå› æ­¤åœ¨i==6ä¹‹åï¼Œå°†çœ‹åˆ°ä¸¤ä¸ª
                  çº¿ç¨‹è®¿é—®åŒä¸€ä¸ªè´¦æˆ·æ—¶å‡ºç°ä¸åŒçš„è´¦æˆ·å
                  */</span>
    <span class="token keyword">new</span> <span class="token class-name">MyTest</span><span class="token punctuation">(</span>at<span class="token punctuation">,</span> <span class="token string">&quot;çº¿ç¨‹ç”²&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">MyTest</span><span class="token punctuation">(</span>at<span class="token punctuation">,</span> <span class="token string">&quot;çº¿ç¨‹ä¹™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢<code>Account</code>ç±»ä¸­çš„ä»£ç åˆ†åˆ«å®Œæˆäº†åˆ›å»º<code>ThreadLocal</code>å¯¹è±¡ã€ä»<code>ThreadLocal</code>ä¸­å–å‡ºçº¿ç¨‹å±€éƒ¨å˜é‡ã€ä¿®æ”¹çº¿ç¨‹å±€éƒ¨å˜é‡çš„æ“ä½œã€‚</p><p>ç”±äºç¨‹åºä¸­çš„è´¦æˆ·åæ˜¯ä¸€ä¸ª<code>ThreadLocal</code>å˜é‡ï¼Œæ‰€ä»¥è™½ç„¶ç¨‹åºä¸­åªæœ‰ä¸€ä¸ª<code>Account</code>å¯¹è±¡ï¼Œä½†ä¸¤ä¸ªå­çº¿ç¨‹å°†ä¼šäº§ç”Ÿä¸¤ä¸ªè´¦æˆ·åï¼ˆä¸»çº¿ç¨‹ä¹ŸæŒæœ‰ä¸€ä¸ªè´¦æˆ·åçš„å‰¯æœ¬ï¼‰ã€‚</p><p>ä¸¤ä¸ªçº¿ç¨‹è¿›è¡Œå¾ªç¯æ—¶éƒ½ä¼šåœ¨<code>i == 6</code>æ—¶å°†è´¦æˆ·åæ”¹ä¸ºä¸çº¿ç¨‹åç›¸åŒï¼Œè¿™æ ·å°±å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªçº¿ç¨‹æ‹¥æœ‰ä¸¤ä¸ªè´¦æˆ·åçš„æƒ…å½¢ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208221513112.png" alt="image-20220822151334474"></p><p>å¦‚æœå¤šä¸ªçº¿ç¨‹ä¹‹é—´éœ€è¦å…±äº«èµ„æºï¼Œä»¥è¾¾åˆ°çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡åŠŸèƒ½ï¼Œå°±ä½¿ç”¨åŒæ­¥æœºåˆ¶ï¼›å¦‚æœä»…ä»…éœ€è¦éš”ç¦»å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å…±äº«å†²çªï¼Œåˆ™å¯ä»¥ä½¿ç”¨<code>ThreadLocal</code>ã€‚</p><h3 id="åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ" tabindex="-1"><a class="header-anchor" href="#åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ" aria-hidden="true">#</a> åŒ…è£…çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ</h3><p><code>ArrayList</code>ã€<code>LinkedList</code>ã€<code>HashSet</code>ã€<code>TreeSet</code>ã€<code>HashMap</code>ã€<code>TreeMap</code>ç­‰éƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå½“å¤šä¸ªå¹¶å‘çº¿ç¨‹å‘è¿™äº›é›†åˆä¸­å­˜ã€å–å…ƒç´ æ—¶ï¼Œå°±å¯èƒ½ä¼šç ´åè¿™äº›é›†åˆçš„æ•°æ®å®Œæ•´æ€§ã€‚</p><p>ä½¿ç”¨<code>Collections</code>æä¾›çš„é™æ€æ–¹æ³•æŠŠè¿™äº›é›†åˆåŒ…è£…æˆçº¿ç¨‹å®‰å…¨çš„é›†åˆã€‚<code>Collections</code>æä¾›äº†å¦‚ä¸‹å‡ ä¸ªé™æ€æ–¹æ³•ã€‚</p><ul><li><code>&lt;T&gt; Collection&lt;T&gt; synchronizedCollection(Collection&lt;T&gt; c)</code>ï¼šè¿”å›æŒ‡å®š<code>collection</code>å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„<code>collection</code>ã€‚</li><li><code>static &lt;T&gt; List&lt;T&gt; synchronizedList(List&lt;T&gt; list)</code>ï¼šè¿”å›æŒ‡å®š<code>List</code>å¯¹è±¡å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„<code>List</code>å¯¹è±¡ã€‚</li><li><code>static &lt;K,V&gt; Map&lt;K,V&gt; synchronizedMap(Map&lt;K,V&gt; m)</code>ï¼šè¿”å›æŒ‡å®š<code>Map</code>å¯¹è±¡å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„<code>Map</code>å¯¹è±¡ã€‚</li><li><code>static &lt;T&gt; Set&lt;T&gt; synchronizedSet(Set&lt;T&gt; s)</code>ï¼šè¿”å›æŒ‡å®š<code>Set</code>å¯¹è±¡å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„ Set<code>å¯¹è±¡</code>ã€‚</li><li><code>static &lt;K,V&gt; SortedMap&lt;K,V&gt;synchronizedSortedMap(SortedMap&lt;K,V&gt; m)</code>ï¼šè¿”å›æŒ‡å®š<code>SortedMap</code>å¯¹è±¡å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„<code>SortedMap</code>å¯¹è±¡ã€‚</li><li><code>static &lt;T&gt; SortedSet&lt;T&gt; synchronizedSortedSet(SortedSet&lt;T&gt; s)</code>ï¼šè¿”å›æŒ‡å®š<code>SortedSet</code>å¯¹è±¡å¯¹åº”çš„çº¿ç¨‹å®‰å…¨çš„<code>SortedSet</code>å¯¹è±¡ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// ä½¿ç”¨Collectionsçš„synchronizedMapæ–¹æ³•å°†ä¸€ä¸ªæ™®é€šçš„HashMapåŒ…è£…æˆçº¿ç¨‹å®‰å…¨çš„ç±»</span>
<span class="token class-name">HashMap</span> m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HashMap</span><span class="token punctuation">)</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»" aria-hidden="true">#</a> çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»</h3><p>Java 5 å¼€å§‹ï¼Œåœ¨<code>java.util.concurrent</code>åŒ…ä¸‹æä¾›äº†å¤§é‡æ”¯æŒé«˜æ•ˆå¹¶å‘è®¿é—®çš„é›†åˆæ¥å£å’Œå®ç°ç±»ã€‚</p><p><img src="https://gcore.jsdelivr.net/gh/SurplusFate/guide_img@main/img/202208221529804.jpeg" alt="epub_681336_2259"></p><p>è¿™äº›çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»å¯åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç±»ã€‚</p><ul><li>ä»¥<code>Concurrent</code>å¼€å¤´çš„é›†åˆç±»ï¼Œå¦‚<code>ConcurrentHashMap</code>ã€<code>ConcurrentSkipListMap</code>ã€<code>ConcurrentSkipListSet</code>ã€<code>ConcurrentLinkedQueue</code>å’Œ<code>ConcurrentLinkedDeque</code>ã€‚</li><li>ä»¥<code>CopyOnWrite</code>å¼€å¤´çš„é›†åˆç±»ï¼Œå¦‚<code>CopyOnWriteArrayList</code>ã€<code>CopyOnWriteArraySet</code>ã€‚</li></ul><p>ä»¥<code>Concurrent</code>å¼€å¤´çš„é›†åˆç±»ä»£è¡¨äº†æ”¯æŒå¹¶å‘è®¿é—®çš„é›†åˆï¼Œå®ƒä»¬å¯ä»¥æ”¯æŒå¤šä¸ªçº¿ç¨‹å¹¶å‘å†™å…¥è®¿é—®ï¼Œè¿™äº›å†™å…¥çº¿ç¨‹çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†è¯»å–æ“ä½œä¸å¿…é”å®šã€‚</p><p>ä»¥<code>Concurrent</code>å¼€å¤´çš„é›†åˆç±»é‡‡ç”¨äº†æ›´å¤æ‚çš„ç®—æ³•æ¥ä¿è¯æ°¸è¿œä¸ä¼šé”ä½æ•´ä¸ªé›†åˆï¼Œå› æ­¤åœ¨å¹¶å‘å†™å…¥æ—¶æœ‰è¾ƒå¥½çš„æ€§èƒ½ã€‚</p><p>å½“å¤šä¸ªçº¿ç¨‹å…±äº«è®¿é—®ä¸€ä¸ªå…¬å…±é›†åˆæ—¶ï¼Œ<code>ConcurrentLinkedQueue</code>æ˜¯ä¸€ä¸ªæ°å½“çš„é€‰æ‹©ã€‚<code>ConcurrentLinkedQueue</code>ä¸å…è®¸ä½¿ç”¨ null å…ƒç´ ã€‚</p><p><code>ConcurrentLinkedQueue</code>å®ç°äº†å¤šçº¿ç¨‹çš„é«˜æ•ˆè®¿é—®ï¼Œå¤šä¸ªçº¿ç¨‹è®¿é—®<code>ConcurrentLinkedQueue</code>é›†åˆæ—¶æ— é¡»ç­‰å¾…ã€‚</p><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ConcurrentHashMap</code>æ”¯æŒ 16 ä¸ªçº¿ç¨‹å¹¶å‘å†™å…¥ï¼Œå½“æœ‰è¶…è¿‡ 16 ä¸ªçº¿ç¨‹å¹¶å‘å‘è¯¥<code>Map</code>ä¸­å†™å…¥æ•°æ®æ—¶ï¼Œå¯èƒ½æœ‰ä¸€äº›çº¿ç¨‹éœ€è¦ç­‰å¾…ã€‚</p><p>å®é™…ä¸Šï¼Œç¨‹åºé€šè¿‡è®¾ç½®<code>concurrencyLevel</code>æ„é€ å‚æ•°ï¼ˆé»˜è®¤å€¼ä¸º 16ï¼‰æ¥æ”¯æŒæ›´å¤šçš„å¹¶å‘å†™å…¥çº¿ç¨‹ã€‚</p><p>ä¸<code>HashMap</code>å’Œæ™®é€šé›†åˆä¸åŒçš„æ˜¯ï¼Œå› ä¸º<code>ConcurrentLinkedQueue</code>å’Œ<code>ConcurrentHashMap</code>æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œæ‰€ä»¥å½“ä½¿ç”¨è¿­ä»£å™¨æ¥éå†é›†åˆå…ƒç´ æ—¶ï¼Œè¯¥è¿­ä»£å™¨å¯èƒ½ä¸èƒ½åæ˜ å‡ºåˆ›å»ºè¿­ä»£å™¨ä¹‹åæ‰€åšçš„ä¿®æ”¹ï¼Œä½†ç¨‹åºä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚</p><div class="custom-container tip"><p class="custom-container-title">æç¤º</p><p>ä½¿ç”¨<code>java.util</code>åŒ…ä¸‹çš„<code>Collection</code>ä½œä¸ºé›†åˆå¯¹è±¡æ—¶ï¼Œå¦‚æœè¯¥é›†åˆå¯¹è±¡åˆ›å»ºè¿­ä»£å™¨åé›†åˆå…ƒç´ å‘ç”Ÿæ”¹å˜ï¼Œåˆ™ä¼šå¼•å‘<code>ConcurrentModificationException</code>å¼‚å¸¸ã€‚</p></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/SurplusFate/SurplusFate.github.io/edit/main/docs/docs/docs/Java/18. å¤šçº¿ç¨‹.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></footer><nav class="page-nav"><a href="/docs/Java/17.%20IO%E6%B5%81.html" class="nav-link prev" aria-label="17. IO æµ"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="icon iconfont icon-note"></span>17. IO æµ</div></a><a href="/docs/Java/19.%20%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%8F%8D%E5%B0%84.html" class="nav-link next" aria-label="19. ç±»åŠ è½½æœºåˆ¶ä¸åå°„"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">19. ç±»åŠ è½½æœºåˆ¶ä¸åå°„<span class="icon iconfont icon-note"></span></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.2001591e.js" defer></script>
  </body>
</html>
